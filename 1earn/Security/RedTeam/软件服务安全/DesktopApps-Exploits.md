# DesktopApps - Exploits

---

## 免责声明

`本文档仅供学习和研究使用,请勿使用文中的技术源码用于非法用途,任何人造成的任何负面影响,与本人无关.`

---

# 大纲

* **[在线客户端参考案例](#在线客户端参考案例)**
    * [RCE](#rce)

* **[Linux](#linux)**
    * [Exim](#exim)
    * [Logwatch](#logwatch)
    * [KDE](#kde)
    * [screen](#screen)
    * [vim](#vim)

* **[Windows](#windows)**
    * [IE](#ie)
    * [Office](#office)
    * [WinRAR](#winrar)
    * [WPS](#wps)

* **[浏览器](#浏览器)**
    * [Edge](#edge)
    * [Firefox](#firefox)

* **[多媒体](#多媒体)**
    * [FFmpeg](#ffmpeg)

---

# 在线客户端参考案例

`这部分内容无任何实际利用价值,可以用来学习参考`

## RCE

- [Evernote 7.9 Code execution](https://securityaffairs.co/wordpress/84037/hacking/local-file-path-traversal-evernote.html)
- [有道云笔记/印象笔记windows客户端代码执行&本地文件读取](https://www.t00ls.net/articles-54303.html)
- [印象笔记 Windows 客户端 6.15 本地文件读取和远程命令执行漏洞(CVE-2018-18524)](https://paper.seebug.org/736/)

**zoom CVE-2019-13450 RCE**
- 简介

    Zoom Client 4.4.4 和 RingCentral 7.0.136380.0312版本（macos平台）中存在安全漏洞。远程攻击者可利用该漏洞强制用户加入视频通话并激活摄像头。

- POC | Payload | exp
    - [JLLeitschuh/zoom_vulnerability_poc](https://github.com/JLLeitschuh/zoom_vulnerability_poc)

---

# Linux
## Exim

**CVE-2019-10149 Exim 4.87 - 4.91 - Local Privilege Escalation**
- 简介

    在 Exim 版本 4.87 至 4.91（含）中发现了一个漏洞 `/src/deliver.c` 中`deliver_messag（）`函数中收件人地址验证不正确可能导致远程命令执行。

- POC | Payload | exp
    - [Exim 4.87 - 4.91 - Local Privilege Escalation - Linux local Exploit](https://www.exploit-db.com/exploits/46996)

---

## Logwatch

Logwatch 是一款免费开放源代码监视日志文件程序，运行在 Linux 和 Unix 操作系统平台下。

**CVE-2011-1018 Logwatch logwatch.pl 任意命令执行漏洞**
- 简介

    Logwatch 7.3.6 版本中的 logwatch.pl 中存在漏洞。远程攻击者可以借助日志文件名称中的 shell 元字符执行任意命令。

- POC | Payload | exp
    - [Logwatch Log File - Special Characters Privilege Escalation](https://www.exploit-db.com/exploits/35386)

---

## KDE

**KDE 4/5 KDesktopFile Command Injection**
- POC | Payload | exp
    - [KDE 4/5 KDesktopFile Command Injection](https://gist.githubusercontent.com/zeropwn/630832df151029cb8f22d5b6b9efaefb/raw/64aa3d30279acb207f787ce9c135eefd5e52643b/kde-kdesktopfile-command-injection.txt)

---

## screen

**GNU Screen 4.5.0 - Local Privilege Escalation**
- POC | Payload | exp
    - [GNU Screen 4.5.0 - Local Privilege Escalation - Linux local Exploit](https://www.exploit-db.com/exploits/41154)

---

## vim

**CVE-2019-12735 Vim/Neovim Arbitrary Code Execution via Modelines**
- 简介

    Vim 8.1.1365 之前版本和 Neovim 0.3.6 之前版本中的 getchar.c 文件存在操作系统命令注入漏洞。该漏洞源于外部输入数据构造操作系统可执行命令过程中，网络系统或产品未正确过滤其中的特殊字符、命令等。攻击者可利用该漏洞执行非法操作系统命令。

- 影响版本
    - Vim:5.6:::
    - Vim:6.1:::
    - Vim:6.3:::
    - Vim:6.4:::
    - Vim:7:::

- POC | Payload | exp
    - [2019-06-04_ace-vim-neovim.md](https://github.com/numirias/security/blob/master/doc/2019-06-04_ace-vim-neovim.md)

---

# Windows
## IE

**XML External Entity Injection**
- POC | Payload | exp
    - http://hyp3rlinx.altervista.org/advisories/MICROSOFT-INTERNET-EXPLORER-v11-XML-EXTERNAL-ENTITY-INJECTION-0DAY.txt

**CVE-2018-8174**
- 简介

    Microsoft Windows VBScript 引擎中存在远程代码执行漏洞。远程攻击者可利用该漏洞在当前用户的上下文中执行任意代码，造成内存损坏。

- 影响版本

    Microsoft Windows 7，Windows Server 2012 R2，Windows RT 8.1，Windows Server 2008，Windows Server 2012，Windows 8.1，Windows Server 2016，Windows Server 2008 R2，Windows 10，Windows 10版本1607，Windows 10版本1703，Windows 10版本1709，Windows 10版本1803，Windows Server版本1709，Windows Server版本1803。

- POC | Payload | exp
    - [Yt1g3r/CVE-2018-8174_EXP: CVE-2018-8174_python](https://github.com/Yt1g3r/CVE-2018-8174_EXP)
    - [0x09AL/CVE-2018-8174-msf: CVE-2018-8174 - VBScript memory corruption exploit.](https://github.com/0x09AL/CVE-2018-8174-msf)

---

## Office

**CVE-2017-0199**
- 简介

    多款Microsoft产品中存在远程代码执行漏洞。远程攻击者可借助特制的文本文件利用该漏洞执行任意代码。

- 影响版本
    - Microsoft Office 2007 SP3
    - Microsoft Office 2010 SP2
    - Microsoft Office 2013 SP1
    - Microsoft Office 2016
    - Microsoft Windows Vista SP2
    - Windows Server 2008 SP2
    - Windows 7 SP1
    - Windows 8.1

- POC | Payload | exp
    - [bhdresh/CVE-2017-0199](https://github.com/bhdresh/CVE-2017-0199)

**CVE-2017-8759**
- 简介

    Microsoft .NET Framework 中存在远程代码执行漏洞。远程攻击者可借助恶意的文档或引用程序利用该漏洞执行代码。

- 影响版本
    - Microsoft .NET Framework 2.0版本
    - 3.5版本
    - 3.5.1版本
    - 4.5.2版本
    - 4.6版本
    - 4.6.1版本
    - 4.6.2版本
    - 4.7版本

- POC | Payload | exp
    - [Lz1y/CVE-2017-8759](https://github.com/Lz1y/CVE-2017-8759)

**CVE-2017-11882**
- 简介

    Microsoft Office 中存在远程代码执行漏洞，该漏洞源于程序没有正确的处理内存中的对象。远程攻击者可借助特制的文件利用该漏洞在当前用户的上下文中执行任意代码。

- 影响版本
    - Microsoft Office 2007 SP3
    - Microsoft Office 2010 SP2
    - Microsoft Office 2013 SP1
    - Microsoft Office 2016

- POC | Payload | exp
    - [Ridter/CVE-2017-11882](https://github.com/Ridter/CVE-2017-11882)
    - [embedi/CVE-2017-11882](https://github.com/embedi/CVE-2017-11882)

**CVE-2021-40444**
- 相关文章
    - [CVE-2021-40444复现](https://mp.weixin.qq.com/s/F6GIe-bjEv2Ns1iEXo4vJw)
    - [CVE-2021-40444 漏洞深入分析](https://paper.seebug.org/1718/)

- POC | Payload | exp
    - [lockedbyte/CVE-2021-40444](https://github.com/lockedbyte/CVE-2021-40444)

---

## WinRAR

WinRAR 是一款文件压缩器。该产品支持 RAR、ZIP 等格式文件的压缩和解压等。

**CVE-2018-20250**
- 简介

    WinRar 中存在目录遍历漏洞。该漏洞源于 WinRAR 在解压处理 ACE 格式的文件过程中，未对 ACE 文件头结构中的“filename”字段进行充分过滤。攻击者可利用该漏洞以提升的权限执行任意代码。

- 相关文章
    - [Extracting a 19 Year Old Code Execution from WinRAR - Check Point Research](https://research.checkpoint.com/extracting-code-execution-from-winrar/)

- POC | Payload | exp
    - [WyAtu/CVE-2018-20250](https://github.com/WyAtu/CVE-2018-20250)
    - [Ridter/acefile](https://github.com/Ridter/acefile)

**WinRAR 5.80 XML 注入漏洞和拒绝服务攻击漏洞**
- POC | Payload | exp
    - https://mrxn.net/Infiltration/641.html

---

## WPS

**Kingsoft WPS Office Remote Heap Corruption Vulnerability**
- 相关文章
    - [Kingsoft WPS Office Remote Heap Corruption Vulnerability](http://zeifan.my/security/rce/heap/2020/09/03/wps-rce-heap.html)

---

## Cisco_AnyConnect

**CVE-2020-3153 privilege escalation through path traversal**
- POC | Payload | exp
    - [goichot/CVE-2020-3153](https://github.com/goichot/CVE-2020-3153)

---

## minimouse

**Mini Mouse 9.2.0 - Path Traversal**
- POC | Payload | exp
    ```
    /file=C:%5CWindows%5Cwin.ini
    ```

**Mini Mouse 9.2.0 - Remote Code Execution**
- POC | Payload | exp
    - https://www.exploit-db.com/exploits/49743

---

# 浏览器

**资源**
- [vngkv123/aSiagaming](https://github.com/vngkv123/aSiagaming)

## Edge

**CVE-2018-8495 Microsoft Edge Hazardous URI Insufficient UI Warning Remote Code Execution Vulnerability**
- 简介

    Microsoft Windows Shell 中存在远程代码执行漏洞，该漏洞源于程序没有正确地处理 URLs。远程攻击者可借助特制的网站利用该漏洞在当前用户的上下文中执行任意代码。

- 相关文章
    - [Microsoft Edge Remote Code Execution](https://leucosite.com/Microsoft-Edge-RCE/)

---

## Firefox

**CVE-2019-9810**
- 简介

    Mozilla Firefox 66.0.1 之前版本中存在缓冲区溢出漏洞，该漏洞源于程序缺少边界检查。攻击者可利用该漏洞执行代码或造成拒绝服务。

- POC | Payload | exp
    - [0vercl0k/CVE-2019-9810](https://github.com/0vercl0k/CVE-2019-9810)

---

# 多媒体
## FFmpeg

FFmpeg 是 FFmpeg 团队的一套可录制、转换以及流化音视频的完整解决方案。

**任意文件读取**
- 相关文章
    - [FFmpeg任意文件读取漏洞分析](https://www.anquanke.com/post/id/86337)

- POC | Payload | exp
    - [ffmpeg 任意文件读取漏洞环境](https://vulhub.org/#/environments/ffmpeg/phdays/)
    - [neex/ffmpeg-avi-m3u-xbin](https://github.com/neex/ffmpeg-avi-m3u-xbin)

**CVE-2016-1897/CVE-2016-1898**
- 简介

    - CVE-2016-1897

        FFmpeg 2.x 版本中存在安全漏洞。远程攻击者可通过使用 HTTP Live Streaming(HLS)M3U8 文件中的 concat 协议，导致外部 HTTP 请求的 URL 字符串中包含本地文件的第一行利用该漏洞实施跨源攻击，读取任意文件。

    - CVE-2016-1898

         FFmpeg 2.x 版本中存在安全漏洞。远程攻击者可通过使用 HTTP Live Streaming(HLS)M3U8 文件中的 subfile 协议，导致外部 HTTP 请求的 URL 字符串中包含本地文件的任意行利用该漏洞实施跨源攻击，读取任意文件。

- 相关文章
    - [ffmpeg SSRF漏洞分析](http://xdxd.love/2016/01/18/ffmpeg-SSRF%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/)
