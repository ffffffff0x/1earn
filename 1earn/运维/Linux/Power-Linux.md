```
 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                                           â–ˆâ–ˆ       â–ˆâ–ˆ
â–‘â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–ˆâ–ˆ                                         â–‘â–ˆâ–ˆ      â–‘â–‘
â–‘â–ˆâ–ˆ   â–‘â–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ     â–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ      â–‘â–ˆâ–ˆ       â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆ   â–ˆâ–ˆ â–ˆâ–ˆ   â–ˆâ–ˆ
â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆ  â–ˆ â–‘â–ˆâ–ˆ â–ˆâ–ˆâ–‘â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–‘â–‘â–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–ˆâ–ˆ      â–‘â–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–‘â–‘â–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆ  â–‘â–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆ â–ˆâ–ˆ
â–‘â–ˆâ–ˆâ–‘â–‘â–‘â–‘  â–‘â–ˆâ–ˆ   â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘ â–‘â–‘â–‘â–‘â–‘ â–‘â–ˆâ–ˆ      â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ  â–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆ  â–‘â–ˆâ–ˆ â–‘â–‘â–ˆâ–ˆâ–ˆ
â–‘â–ˆâ–ˆ      â–‘â–ˆâ–ˆ   â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–ˆâ–ˆâ–‘â–‘â–‘â–‘  â–‘â–ˆâ–ˆ         â–‘â–ˆâ–ˆ      â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ  â–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆ  â–‘â–ˆâ–ˆ  â–ˆâ–ˆâ–‘â–ˆâ–ˆ
â–‘â–ˆâ–ˆ      â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–‘ â–‘â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–ˆâ–ˆâ–ˆ         â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–ˆâ–ˆ â–ˆâ–ˆâ–ˆ  â–‘â–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆ â–‘â–‘â–ˆâ–ˆ
â–‘â–‘        â–‘â–‘â–‘â–‘â–‘â–‘  â–‘â–‘â–‘    â–‘â–‘â–‘  â–‘â–‘â–‘â–‘â–‘â–‘ â–‘â–‘â–‘          â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â–‘â–‘ â–‘â–‘â–‘   â–‘â–‘  â–‘â–‘â–‘â–‘â–‘â–‘ â–‘â–‘   â–‘â–‘
```

<p align="center">
    <a href="https://www.pixiv.net/en/artworks/77495663"><img src="../../../assets/img/banner/Power-Linux.jpg" width="90%"></a>
</p>

<p align="center">
    <a href="https://github.com/ellerbrock/open-source-badges/"><img src="../../../assets/img/è¿ç»´/Linux/open-source.png" width="15%"></a>
    <a href="https://github.com/ellerbrock/open-source-badges/"><img src="../../../assets/img/è¿ç»´/Linux/bash.png" width="15%"></a>
</p>

- `Linux ä¸‹å„ç§å¸¸è§æœåŠ¡çš„æ­å»º/é…ç½®æŒ‡å—`
- `å¤§éƒ¨åˆ†ç¯å¢ƒåœ¨ Centos7,å°‘éƒ¨åˆ† Ubuntu`
- `ä¸»è¦ä»¥å®‰è£…æ­å»ºä¸ºä¸»,æ›´æ·±ä¸€æ­¥çš„é…ç½®è¯·è‡ªè¡Œç ”ç©¶`
- `å¦‚æœä½ çš„æœåŠ¡å™¨ä¸åœ¨å›½å¤–,è¯·ä½ ä¸€å®šè¦å­¦ä¹ ä¸€ä¸‹ç»™æœåŠ¡å™¨åŠ é€Ÿçš„æ–¹æ³•ğŸ¤£ğŸ˜‚ğŸ¤£`

---

# å¤§çº²

* **[ğŸ¥© å¸¸è§æœåŠ¡](#å¸¸è§æœåŠ¡)**
  * [Lvm](#lvm)
  * [Net](#net)
  * [RAID](#raid)
  * [Vim](#vim)

* **[ğŸœ ç½‘ç»œæœåŠ¡](#ç½‘ç»œæœåŠ¡)**
  * [AdguardTeam](#adguardteam)
  * [Cacti](#cacti)
  * [Chrony](#chrony)
  * [cloud-torrent](#cloud-torrent)
  * [DHCP](#dhcp)
  * [DNS](#dns)
  * [frp](#frp)
  * [Kicktart](#kicktart)
  * [nps](#nps)
  * [OpenVPN](#openvpn)
  * [PowerDNS](#powerdns)
    * [PowerDNS-Admin](#powerdns-admin)
  * [proxychains-ng](#proxychains-ng)
  * [SSH](#ssh)
  * [ttyd](#ttyd)
  * [vnc4server](#vnc4server)

* **[ğŸ¦ webæœåŠ¡-ä¸­é—´ä»¶](#webæœåŠ¡-ä¸­é—´ä»¶)**
  * [ActiveMQ](#activemq)
  * [Apache](#apache)
  * [Caddy](#caddy)
  * [npm & Node](#npmnode)
  * [Nexus](#nexus)
  * [Nginx](#nginx)
  * [phpMyAdmin](#phpmyadmin)
  * [RabbitMQ](#rabbitmq)
  * [searx](#searx)
  * [Tomcat](#tomcat)
  * [Wordpress](#wordpress)
  * [Mijisou](#mijisou)

* **[ğŸ‰ æ•°æ®åº“](#æ•°æ®åº“)**
  * [Relational](#relational)
    * [Oracle](#oracle)
    * [Mariadb](#mariadb)
    * [MySQL](#mysql)
    * [Postgresql](#postgresql)
  * [Document](#document)
    * [MongoDB](#mongodb)
  * [Key-value](#key-value)
    * [Redis](#redis)
    * [Memcached](#Memcached)
  * [å›¾å½¢](#å›¾å½¢)
    * [Neo4j](#neo4j)

* **[ğŸ£ æ–‡ä»¶æœåŠ¡](#æ–‡ä»¶æœåŠ¡)**
  * [filebrowser](#filebrowser)
  * [NFS](#nfs)
  * [Samba](#samba)
  * [Vsftp](#vsftp)

* **[ğŸ— ç¼–ç¨‹è¯­è¨€](#ç¼–ç¨‹è¯­è¨€)**
  * [C](#c)
  * [Go](#go)
  * [JDK](#jdk)
  * [Python3](#python3)
    * [pip](#pip)
    * [jupyterlab](#jupyterlab)
  * [Ruby](#ruby)

* **[ğŸ ç³»ç»Ÿç›‘ç®¡](#ç³»ç»Ÿç›‘ç®¡)**
  * [BaoTa](#baota)
  * [Jenkins](#jenkins)
  * [JumpServer](#jumpserver)
  * [Loganalyzer](#loganalyzer)
  * [Supervisor](#supervisor)
  * [Webmin](#webmin)
  * [Zabbix](#zabbix)

* **[ğŸŒ­ è™šæ‹ŸåŒ–](#è™šæ‹ŸåŒ–)**
  * [Docker](#docker)
    * [Docker-Compose](#docker-compose)
  * [QEMU](#qemu)

* **[ğŸ¥• åˆ†å¸ƒå¼](#åˆ†å¸ƒå¼)**
  * [ZooKeeper](#zookeeper)

* **[ğŸ¯ å®‰å…¨æœåŠ¡](#å®‰å…¨æœåŠ¡)**
  * [ClamAV](#clamav)
  * [Fail2Ban](#fail2ban)
  * [OpenLDAP](#openldap)
    * [PhpLdapAdmin](#phpldapadmin)
  * [Snort](#snort)
  * [Suricata](#suricata)

* **[ğŸ¥ å„ç§ä¾èµ–](#å„ç§ä¾èµ–)**
  * [LuaJIT](#luajit)

---

# å¸¸è§æœåŠ¡
## Lvm

> LVM æ˜¯ Logical Volume Manager çš„ç¼©å†™ï¼Œä¸­æ–‡ä¸€èˆ¬ç¿»è¯‘ä¸º "é€»è¾‘å·ç®¡ç†"ï¼Œå®ƒæ˜¯ Linux ä¸‹å¯¹ç£ç›˜åˆ†åŒºè¿›è¡Œç®¡ç†çš„ä¸€ç§æœºåˆ¶ã€‚LVM æ˜¯å»ºç«‹åœ¨ç£ç›˜åˆ†åŒºå’Œæ–‡ä»¶ç³»ç»Ÿä¹‹é—´çš„ä¸€ä¸ªé€»è¾‘å±‚ï¼Œç³»ç»Ÿç®¡ç†å‘˜å¯ä»¥åˆ©ç”¨ LVM åœ¨ä¸é‡æ–°å¯¹ç£ç›˜åˆ†åŒºçš„æƒ…å†µä¸‹åŠ¨æ€çš„è°ƒæ•´åˆ†åŒºçš„å¤§å°ã€‚å¦‚æœç³»ç»Ÿæ–°å¢äº†ä¸€å—ç¡¬ç›˜ï¼Œé€šè¿‡ LVM å°±å¯ä»¥å°†æ–°å¢çš„ç¡¬ç›˜ç©ºé—´ç›´æ¥æ‰©å±•åˆ°åŸæ¥çš„ç£ç›˜åˆ†åŒºä¸Šã€‚

```bash
fdisk -l		        # æŸ¥çœ‹ç£ç›˜æƒ…å†µ
fdisk /dev/sdb	    # åˆ›å»ºç³»ç»Ÿåˆ†åŒº
	n
	p
	1
	åé¢éƒ½æ˜¯é»˜è®¤,ç›´æ¥å›è½¦

	t	  # è½¬æ¢åˆ†åŒºæ ¼å¼
	8e

	w   # å†™å…¥åˆ†åŒºè¡¨
```

**å·ç»„**

åˆ›å»ºä¸€ä¸ªåä¸º datastore çš„å·ç»„,å·ç»„çš„ PE å°ºå¯¸ä¸º 16MB;
```bash
pvcreate /dev/sdb1	                  # åˆå§‹åŒ–ç‰©ç†å·
vgcreate -s 16M datastore /dev/sdb1   # åˆ›å»ºç‰©ç†å·
```

**é€»è¾‘å·**

é€»è¾‘å·çš„åç§°ä¸º database æ‰€å±å·ç»„ä¸º datastore,è¯¥é€»è¾‘å·ç”± 50 ä¸ª PE ç»„æˆ;
```bash
lvcreate -l 50 -n database datastore
```

é€»è¾‘å·çš„åç§°ä¸º database æ‰€å±å·ç»„ä¸º datastore,è¯¥é€»è¾‘å·å¤§å°ä¸º 8GB;
```bash
lvcreate -L 8G -n database datastore
lvdisplay
```

**æ ¼å¼åŒ–**

å°†æ–°å»ºçš„é€»è¾‘å·æ ¼å¼åŒ–ä¸º XFS æ–‡ä»¶ç³»ç»Ÿ,è¦æ±‚åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶èƒ½å¤Ÿè‡ªåŠ¨æŒ‚åœ¨åˆ° /mnt/database ç›®å½•.
```bash
mkfs.xfs /dev/datastore/database
mkdir /mnt/database
```
```vim
vim /etc/fstab
/dev/datastore/database /mnt/database/ xfs defaults 0 0
```

é‡å¯éªŒè¯
```bash
shutdown -r now
mount | grep '^/dev'
```

**æ‰©å®¹**

å°† database é€»è¾‘å·æ‰©å®¹è‡³ 15GB ç©ºé—´å¤§å°,ä»¥æ»¡è¶³ä¸šåŠ¡éœ€æ±‚.
```bash
lvextend -L 15G /dev/datastore/database
lvs	    # ç¡®è®¤æœ‰è¶³å¤Ÿç©ºé—´
resize2fs /dev/datastore/database
lvdisplay
```

---

## Net

**centos é…ç½®ç½‘å¡**
```vim
vim /etc/sysconfig/network-scripts/ifcfg-eth0

DEVICE="enoXXXXXX"
BOOTPROTO=static  # ä½¿ç”¨é™æ€ IP,è€Œä¸æ˜¯ç”± DHCP åˆ†é… IP
IPADDR=172.16.102.61
PREFIX=24
ONBOOT=yes
GATEWAY=172.16.102.254
HOSTNAME=dns1.abc.com
DNS1=223.5.5.5
```

**ä¿®æ”¹ä¸»æœºå**
```vim
vim /etc/hosts

127.0.0.1  test localhost # ä¿®æ”¹ localhost.localdomain ä¸º test,shutdown -r now é‡å¯ä½¿ä¿®æ”¹ç”Ÿæ•ˆ
```

**ä¿®æ”¹ DNS**
```vim
vim /etc/resolv.conf

nameserver 8.8.8.8
```
```bash
service network restart
```

---

## RAID

**å®‰è£…**
```bash
yum remove mdadm # å»ºè®®å…ˆæŠŠåŸæœ¬çš„å¸æ‰é‡è£…
yum install mdadm
```

**åˆ†åŒº**
```bash
fdisk /dev/sdb
n åˆ›å»º
p ä¸»åˆ†åŒº
æ¥ä¸‹æ¥ä¸€è·¯å›è½¦é€‰é»˜è®¤å€¼
w å†™å…¥

fdisk /dev/sdc
n åˆ›å»º
p ä¸»åˆ†åŒº
æ¥ä¸‹æ¥ä¸€è·¯å›è½¦é€‰é»˜è®¤å€¼
w å†™å…¥
```

**åˆ›å»ºé˜µåˆ—**
- RAID1

	```bash
  mdadm -Cv /dev/md0 -a yes -l1 -n2 /dev/sd[b,c]1
  - -Cv: åˆ›å»ºä¸€ä¸ªé˜µåˆ—å¹¶æ‰“å°å‡ºè¯¦ç»†ä¿¡æ¯.
	- /dev/md0: é˜µåˆ—åç§°.
	- -aã€€: åŒæ„åˆ›å»ºè®¾å¤‡,å¦‚ä¸åŠ æ­¤å‚æ•°æ—¶å¿…é¡»å…ˆä½¿ç”¨ mknod å‘½ä»¤æ¥åˆ›å»ºä¸€ä¸ª RAID è®¾å¤‡,ä¸è¿‡æ¨èä½¿ç”¨ -a yes å‚æ•°ä¸€æ¬¡æ€§åˆ›å»º;
	- -l1 (l as in "level"): æŒ‡å®šé˜µåˆ—ç±»å‹ä¸º RAID-1 .
	- -n2: æŒ‡å®šæˆ‘ä»¬å°†ä¸¤ä¸ªåˆ†åŒºåŠ å…¥åˆ°é˜µåˆ—ä¸­å»,åˆ†åˆ«ä¸º/dev/sdb1 å’Œ /dev/sdc1
  ```

- RAID5

	```bash
  mdadm -Cv /dev/md0 -a yes -l5 -n3 /dev/sd[b,c,d]1
	cat /proc/mdstat    # æŸ¥çœ‹è¿›åº¦
	mdadm -D /dev/md0   # è·å–é˜µåˆ—ä¿¡æ¯
  ```

**æ ¼å¼åŒ–ä¸º xfs**

```bash
mkfs.xfs /dev/md0
```

**ä»¥ UUID çš„å½¢å¼å¼€æœºè‡ªåŠ¨æŒ‚è½½**
```bash
mkdir /data/ftp_data
blkid	/dev/md0    # æŸ¥ UUID å€¼
```
```vim
vim /etc/fstab
UUID=XXXXXXXXXXXXXXXXXXXXXXXXXX    /data/ftp_data  xfs defaults 0 0
```
```bash
shutdown -r now   # é‡å¯éªŒè¯
mount | grep '^/dev'
```

---

## Vim

<p align="center">
    <img src="../../../assets/img/logo/vim.svg" width="15%">
</p>

> VIM æ˜¯ Linux ç³»ç»Ÿä¸Šä¸€æ¬¾æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œå®ƒæ˜¯æ“ä½œæ–‡æœ¬çš„ä¸€æ¬¾åˆ©å™¨ã€‚

**å¸¸ç”¨æ“ä½œ**
```bash
Normal æ¨¡å¼ä¸‹ i è¿›å…¥ insert æ¨¡å¼
:wq                       # å­˜ç›˜+é€€å‡º
dd                        # åˆ é™¤å½“å‰è¡Œ,å¹¶å­˜å…¥å‰ªåˆ‡æ¿
p                         # ç²˜è´´
:q!                       # å¼ºåˆ¶é€€å‡º
:wq!                      # å¼ºåˆ¶ä¿å­˜é€€å‡º
:w !sudo tee %            # æ—  root æƒé™,ä¿å­˜ç¼–è¾‘çš„æ–‡ä»¶
:saveas <path/to/file>    # å¦å­˜ä¸º
æŒ‰ä¸‹ / å³å¯è¿›å…¥æŸ¥æ‰¾æ¨¡å¼,è¾“å…¥è¦æŸ¥æ‰¾çš„å­—ç¬¦ä¸²å¹¶æŒ‰ä¸‹å›è½¦. Vim ä¼šè·³è½¬åˆ°ç¬¬ä¸€ä¸ªåŒ¹é….æŒ‰ä¸‹ n æŸ¥æ‰¾ä¸‹ä¸€ä¸ª,æŒ‰ä¸‹ N æŸ¥æ‰¾ä¸Šä¸€ä¸ª.
:%s/foo/bar               # ä»£è¡¨æ›¿æ¢ foo ä¸º bar
:%!xxd                    # åå…­è¿›åˆ¶ç¼–è¾‘æ¨¡å¼, :%!xxd -r åˆ‡å›å»
insert æ¨¡å¼æŒ‰ ESC é”®,è¿”å› Normal æ¨¡å¼
```

**å¸¸ç”¨é…ç½®**

`sudo vim /etc/vim/vimrc` æˆ– `sudo vim /etc/vimrc` æœ€åé¢ç›´æ¥æ·»åŠ ä½ æƒ³æ·»åŠ çš„é…ç½®,ä¸‹é¢æ˜¯ä¸€äº›å¸¸ç”¨çš„ (ä¸å»ºè®®ç›´æ¥å¤åˆ¶è¿™ä¸ªè´§ç½‘ä¸Šçš„,è¦ç†è§£æ¯ä¸ªçš„å«ä¹‰åŠæœ‰ä»€ä¹ˆç”¨,æ ¹æ®è‡ªå·±éœ€è¦æ¥è°ƒæ•´)
```bash
set number                # æ˜¾ç¤ºè¡Œå·
set nobackup              # è¦†ç›–æ–‡ä»¶æ—¶ä¸å¤‡ä»½
set cursorline            # çªå‡ºæ˜¾ç¤ºå½“å‰è¡Œ
set ruler                 # åœ¨å³ä¸‹è§’æ˜¾ç¤ºå…‰æ ‡ä½ç½®çš„çŠ¶æ€è¡Œ
set shiftwidth=4          # è®¾å®š > å‘½ä»¤ç§»åŠ¨æ—¶çš„å®½åº¦ä¸º 4
set softtabstop=4         # ä½¿å¾—æŒ‰é€€æ ¼é”®æ—¶å¯ä»¥ä¸€æ¬¡åˆ æ‰ 4 ä¸ªç©ºæ ¼
set tabstop=4             # è®¾å®š tab é•¿åº¦ä¸º 4(å¯ä»¥æ”¹)
set smartindent           # å¼€å¯æ–°è¡Œæ—¶ä½¿ç”¨æ™ºèƒ½è‡ªåŠ¨ç¼©è¿›
set ignorecase smartcase  # æœç´¢æ—¶å¿½ç•¥å¤§å°å†™,ä½†åœ¨æœ‰ä¸€ä¸ªæˆ–ä»¥ä¸Šå¤§å†™å­—æ¯æ—¶ä» ä¿æŒå¯¹å¤§å°å†™æ•æ„Ÿ

ä¸‹é¢è¿™ä¸ªåœ¨ä»£ç å¤šçš„æ—¶å€™ä¼šæ¯”è¾ƒå¥½
#set showmatch # æ’å…¥æ‹¬å·æ—¶,çŸ­æš‚åœ°è·³è½¬åˆ°åŒ¹é…çš„å¯¹åº”æ‹¬å·
#set matchtime=2 # çŸ­æš‚è·³è½¬åˆ°åŒ¹é…æ‹¬å·çš„æ—¶é—´
```

**ä½¿ç”¨ vim å¯¹æ¯”æ–‡ä»¶**

```bash
vimdiff  FILE_LEFT  FILE_RIGHT
```

**è§£å†³ ssh å vim ä¸­ä¸èƒ½ä½¿ç”¨å°é”®ç›˜çš„é—®é¢˜**
- xshell

  æ›´æ”¹çš„æ–¹æ³•: åœ¨ç»ˆç«¯è®¾ç½®ä¸­é€‰æ‹©ç»ˆç«¯ç±»å‹ä¸º linux

- ubuntu
  ```bash
  sudo apt-get remove vim-common
  sudo apt-get install vim
  ```

**[SpaceVim](https://spacevim.org/cn/)** - æ¨¡å—åŒ–çš„ Vim IDE

**[how-to-exit-vim](https://github.com/hakluke/how-to-exit-vim)** - é€€å‡º vim çš„å¤šç§æ–¹å¼

---

# ç½‘ç»œæœåŠ¡
## AdguardTeam

<p align="center">
    <img src="../../../assets/img/logo/AdguardTeam.svg" width="25%">
</p>

> ä¸€ä¸ª DNS å»å¹¿å‘Šã€å»è·Ÿè¸ªçš„æœåŠ¡

**é¡¹ç›®åœ°å€**
- https://github.com/AdguardTeam/AdGuardHome

**å®‰è£…**
```bash
mkdir -p /opt/adguard && cd /opt/adguard
wget https://github.com/AdguardTeam/AdGuardHome/releases/download/v0.95-hotfix/AdGuardHome_v0.95-hotfix_linux_amd64.tar.gz
tar -xzvf AdGuardHome_v0.95-hotfix_linux_amd64.tar.gz
cd AdGuardHome
./AdGuardHome -s install

systemctl stop firewalld
```

**å…¶ä»–ç®¡ç†å‘½ä»¤**
```bash
./AdGuardHome -s uninstall
./AdGuardHome -s start
./AdGuardHome -s stop
./AdGuardHome -s restart
./AdGuardHome -s status
```
æ— è¯¯çš„è¯è®¿é—®æœåŠ¡å™¨ IP:3000 å°±å¯ä»¥çœ‹åˆ°ç®¡ç†é¡µé¢äº†

---

## butterfly

> åŸºäº websocket å’Œ tornado çš„ web ç»ˆç«¯

**é¡¹ç›®åœ°å€**
- https://github.com/paradoxxxzero/butterfly

**å®‰è£…**
```bash
pip install butterfly
```

**ä½¿ç”¨**
```bash
# èµ° http,ä½¿ç”¨ç³»ç»Ÿè®¤è¯
butterfly.server.py --host=192.168.1.1 --port=57575 --login --unsecure
```

è®¿é—® IP:57575 , åœ¨ web é¡µé¢ä¸­ Alt+s å¯ä»¥åˆ‡æ¢ä¸»é¢˜æ ·å¼

---

## Cacti

<p align="center">
    <img src="../../../assets/img/logo/Cacti.png" width="30%">
</p>

> Cacti æ˜¯ä¸€å¥—åŸºäº PHP,MySQL,SNMP åŠ RRDTool å¼€å‘çš„ç½‘ç»œæµé‡ç›‘æµ‹å›¾å½¢åˆ†æå·¥å…·ã€‚å®ƒçš„ä¸»è¦åŠŸèƒ½æ˜¯ç”¨ snmp æœåŠ¡è·å–æ•°æ®ï¼Œç„¶åç”¨ rrdtool å‚¨å­˜å’Œæ›´æ–°æ•°æ®ï¼Œå½“ç”¨æˆ·éœ€è¦æŸ¥çœ‹æ•°æ®çš„æ—¶å€™ç”¨ rrdtool ç”Ÿæˆå›¾è¡¨å‘ˆç°ç»™ç”¨æˆ·ã€‚

**å®˜ç½‘**
- https://www.cacti.net/

**ä»€ä¹ˆæ˜¯ RRDtools**

RRDtool æ˜¯æŒ‡ Round Robin Database å·¥å…·ï¼ˆç¯çŠ¶æ•°æ®åº“ï¼‰ã€‚Round robin æ˜¯ä¸€ç§å¤„ç†å®šé‡æ•°æ®ã€ä»¥åŠå½“å‰å…ƒç´ æŒ‡é’ˆçš„æŠ€æœ¯ã€‚æƒ³è±¡ä¸€ä¸ªå‘¨è¾¹æ ‡æœ‰ç‚¹çš„åœ†ç¯ï¼ï¼è¿™äº›ç‚¹å°±æ˜¯æ—¶é—´å­˜å‚¨çš„ä½ç½®ã€‚ä»åœ†å¿ƒç”»ä¸€æ¡åˆ°åœ†å‘¨çš„æŸä¸ªç‚¹çš„ç®­å¤´ï¼ï¼è¿™å°±æ˜¯æŒ‡é’ˆã€‚å°±åƒæˆ‘ä»¬åœ¨ä¸€ä¸ªåœ†ç¯ä¸Šä¸€æ ·ï¼Œæ²¡æœ‰èµ·ç‚¹å’Œç»ˆç‚¹ï¼Œä½ å¯ä»¥ä¸€ç›´å¾€ä¸‹èµ°ä¸‹å»ã€‚è¿‡æ¥ä¸€æ®µæ—¶é—´ï¼Œæ‰€æœ‰å¯ç”¨çš„ä½ç½®éƒ½ä¼šè¢«ç”¨è¿‡ï¼Œè¯¥å¾ªç¯è¿‡ç¨‹ä¼šè‡ªåŠ¨é‡ç”¨åŸæ¥çš„ä½ç½®ã€‚è¿™æ ·ï¼Œæ•°æ®é›†ä¸ä¼šå¢å¤§ï¼Œå¹¶ä¸”ä¸éœ€è¦ç»´æŠ¤ã€‚RRDtool å¤„ç† RRD æ•°æ®åº“ã€‚å®ƒç”¨å‘ RRD æ•°æ®åº“å­˜å‚¨æ•°æ®ã€ä» RRD æ•°æ®åº“ä¸­æå–æ•°æ®ã€‚

**æ­å»º lamp**

```bash
yum install yum-utils
wget https://repo.mysql.com//mysql80-community-release-el7-1.noarch.rpm
rpm -ivh mysql80-community-release-el7-1.noarch.rpm
yum-config-manager --disable mysql80-community
yum-config-manager --enable mysql57-community
yum install mysql-community-server mysql-community-devel httpd php php-mysql php-gd libjpeg* php-ldap php-odbc php-pear php-xml php-xmlrpc php-mbstring php-bcmath php-mhash libxml2-devel libevent-devel curl-devel net-snmp* php-snmp php-fpm

systemctl enable mysqld && systemctl enable httpd
```

åˆå§‹åŒ– mysql
```bash
/usr/bin/mysqld â€“initialize â€“basedir=/usr/share/mysql â€“datadir=/var/lib/mysql/data/
# æˆ–
/usr/bin/mysql â€“initialize â€“basedir=/usr/share/mysql â€“datadir=/var/lib/mysql/data/
```
```bash
systemctl start mysqld

vim /etc/my.cnf

# åœ¨æœ«å°¾æ·»åŠ ä¸€è¡Œè§„åˆ™
skip-grant-tables
```
```bash
systemctl restart mysqld
mysql -uroot -p

use mysql;
update user set authentication_string=password('123456') where user='root';
exit
```

> æ³¨æ„ : æ­¤å¤„åªæ˜¯ä¸ºäº†æ–¹ä¾¿æ¼”ç¤º,ç”Ÿäº§ç¯å¢ƒä¸‹è¯·ä¸è¦ä½¿ç”¨ç±»ä¼¼ 123456 è¿™ç±»å¼±å£ä»¤

ä¿®æ”¹ php.ini é…ç½®æ–‡ä»¶
```
vim /etc/php.ini

date.timezone = "Asia/Shanghai"
```
```bash
systemctl start httpd
echo "<?php phpinfo(); ?>" > /var/www/html/phpinfo.php
service firewalld stop
```

ç„¶ååœ¨æµè§ˆå™¨ä¸Šè®¿é—® `ip/phpinfo.php` èƒ½çœ‹åˆ° phpinfo ä¿¡æ¯å°±æ²¡é—®é¢˜

**å®‰è£…é…ç½® cacti**

ç¼–è¾‘ `my.cnf` é…ç½®æ–‡ä»¶
```bash
vim /etc/my.cn

[mysqld]
character-set-server=utf8mb4
collation-server=utf8mb4_unicode_ci
```
```bash
systemctl restart mysqld

mysql -uroot -p123456

create database cacti character set utf8 ;
ALTER DATABASE cacti CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
exit
```
```bash
vim /etc/my.cnf

# åˆ é™¤æœ«å°¾è§„åˆ™
skip-grant-tables


systemctl restart mysqld
mysql -uroot -p123456

set global validate_password_policy=LOW;
set global validate_password_length=6;
alter user 'root'@'localhost' identified by '123456';
grant all privileges on cacti.* to cacti@localhost identified by '1qaz@WSX';
GRANT SELECT ON mysql.time_zone_name TO cacti@localhost IDENTIFIED BY '1qaz@WSX';
flush privileges ;
mysql_tzinfo_to_sql /usr/share/zoneinfo
exit;

systemctl restart mysqld
```

å¯¼å…¥ cacti æ•°æ®åº“è„šæœ¬
```bash
cd /usr/local/src/
wget https://www.cacti.net/downloads/cacti-1.2.8.zip
unzip cacti-1.2.8.zip


mysql -uroot -p123456
use cacti ;
source /usr/local/src/cacti-1.2.8/cacti.sql ;
exit
```

```bash
cd /var/www/html
mkdir cacti
cp -r /usr/local/src/cacti-1.2.8/* /var/www/html/cacti
```
```bash
vim /var/www/html/cacti/include/config.php

# æŠŠåŸæ¥çš„é…ç½®ä¿¡æ¯ä¿®æ”¹æˆä»¥ä¸‹ä¿¡æ¯ï¼š
$database_type = 'mysql';
$database_default = 'cacti';
$database_hostname = 'localhost';
$database_username = 'cacti';
$database_password = '1qaz@WSX';
$database_port = '3306';
$database_ssl = false;
```

```bash
useradd -s /sbin/nologin cacti
mkdir /var/www/html/cacti/rra/log
chown -R cacti /var/www/html/cacti/rra/log/
```

é…ç½®å®šæ—¶ä»»åŠ¡
```bash
crontab -e

*/5 * * * * /usr/bin/php /var/www/html/cacti/poller.php > /dev/null 2>&1

crontab -l # æŸ¥çœ‹æ˜¯å¦å†™æ­£ç¡®
systemctl enable crond
systemctl start crond
```

**å®‰è£…å…¶ä»–ç»„ä»¶**
```bash
cd /tmp
wget https://oss.oetiker.ch/rrdtool/pub/rrdtool-1.7.0.tar.gz
wget https://www.cacti.net/downloads/spine/cacti-spine-1.2.1.tar.gz

yum install glib2-devel cairo-devel libxml2-devel pango pango-devel help2man
```

**å®‰è£… rrdtool å·¥å…·**
```bash
tar zxvf rrdtool-1.7.0.tar.gz
cd rrdtool-1.7.0
./configure --prefix=/usr/local/bin/rrdtool
make
make install
```

**å®‰è£… cacti-spine å·¥å…·**
```bash
cd ../
tar zxvf cacti-spine-1.2.1.tar.gz
cd cacti-spine-1.2.1
./configure --prefix=/usr/local/spine
make
make install
```
```bash
vim /usr/local/spine/etc/spine.conf

DB_Host localhost
DB_Database cacti
DB_User cacti
DB_Pass 1qaz@WSX
DB_Port 3306
```

```bash
setenforce 0

cd /var/www/html/cacti/log
ls
# å¦‚æœå‘ç°æ²¡æœ‰ cacti.log æ–‡ä»¶æ—¶ï¼Œå¯ä»¥æ‰§è¡Œä¸€ä¸‹å‘½ä»¤ï¼š
touch cacti.log
chmod 777 cacti.log

chmod 777 /var/www/html/cacti/resource/snmp_queries/
chmod 777 /var/www/html/cacti/resource/script_server/
chmod 777 /var/www/html/cacti/resource/script_queries/
chmod 777 /var/www/html/cacti/scripts/
chmod 777 /var/www/html/cacti/log/
chmod 777 /var/www/html/cacti/cache/boost/
chmod 777 /var/www/html/cacti/cache/mibcache/
chmod 777 /var/www/html/cacti/cache/realtime/
chmod 777 /var/www/html/cacti/cache/spikekill/
```

**å¦‚æœå‡ºç° csrf-secret.php not writable**
```bash
systemctl edit php-fpm.service

[Service]
ReadWritePaths = /usr/share/webapps/cacti/include/vendor/csrf

chmod 777 /var/www/html/cacti/include/vendor/csrf
systemctl restart php-fpm.service
```

åœ¨æµè§ˆå™¨è®¿é—®ï¼š`http://ip/cacti` é»˜è®¤å¯†ç  admin/admin

---

## Chrony

> ä¸€ä¸ªæ—¶é—´åŒæ­¥è½¯ä»¶,å¯ç”¨äºæ­å»ºç±» NTP æ—¶é—´æœåŠ¡

**å®˜ç½‘**
- https://chrony.tuxfamily.org/

**ç®€ä»‹**

å®ƒç”±ä¸¤ä¸ªç¨‹åºç»„æˆ:chronyd å’Œ chronyc.

chronyd æ˜¯ä¸€ä¸ªåå°è¿è¡Œçš„å®ˆæŠ¤è¿›ç¨‹,ç”¨äºè°ƒæ•´å†…æ ¸ä¸­è¿è¡Œçš„ç³»ç»Ÿæ—¶é’Ÿå’Œæ—¶é’ŸæœåŠ¡å™¨åŒæ­¥.å®ƒç¡®å®šè®¡ç®—æœºå¢å‡æ—¶é—´çš„æ¯”ç‡,å¹¶å¯¹æ­¤è¿›è¡Œè¡¥å¿.

chronyc æ˜¯ç”¨æ¥ç›‘æ§ chronyd æ€§èƒ½å’Œé…ç½®å…¶å‚æ•°ç¨‹åº

**å®‰è£…**
```bash
yum install chrony
```

**é…ç½®æ–‡ä»¶**
```vim
vim /etc/chrony.conf

server time1.aliyun.com iburst
server time2.aliyun.com iburst
server time3.aliyun.com iburst
server time4.aliyun.com iburst
server time5.aliyun.com iburst
server time6.aliyun.com iburst
server time7.aliyun.com iburst
# æˆ–
server time1.google.com iburst
server time2.google.com iburst
server time3.google.com iburst
server time4.google.com iburst
```

**å¯æœåŠ¡**
```bash
systemctl stop ntpd
systemctl disable ntpd

systemctl enable chronyd.service
systemctl start chronyd.service
```

**æŸ¥çœ‹åŒæ­¥çŠ¶æ€**
```bash
chronyc sourcestats # æ£€æŸ¥ ntp æºæœåŠ¡å™¨çŠ¶æ€
chronyc sources -v  # æ£€æŸ¥ ntp è¯¦ç»†åŒæ­¥çŠ¶æ€

chronyc             # è¿›å…¥äº¤äº’æ¨¡å¼
  activity
```

---

## cloud-torrent

> web torrent ä¸‹è½½æœåŠ¡

**é¡¹ç›®åœ°å€**
- https://github.com/jpillora/cloud-torrent

**å®‰è£…**
```
curl https://i.jpillora.com/cloud-torrent! | bash
```

**è¿è¡Œ**
```
cloud-torrent -o
```

---

## DHCP

> DHCP æœåŠ¡ç¨‹åºç”¨äºä¸ºå®¢æˆ·ç«¯ä¸»æœºåˆ†é…å¯ç”¨çš„ IP åœ°å€

**å®‰è£…**
```
yum install dhcp
```

**å¤åˆ¶ä¸€ä»½ç¤ºä¾‹**
```
cp /usr/share/doc/dhcp-4*/dhcpd.conf.example /etc/dhcp/dhcpd.conf
```

**ä¿®æ”¹é…ç½®æ–‡ä»¶**
```vim
vim /etc/dhcp/dhcpd.conf

ddns-update-style interim;      # è®¾ç½® DNS çš„åŠ¨æ€æ›´æ–°æ–¹å¼ä¸º interim
option domain-name-servers  8.8.8.8;           # æŒ‡å®š DNS æœåŠ¡å™¨åœ°å€
default-lease-time  43200;                          # æŒ‡å®šé»˜è®¤ç§Ÿçº¦çš„æ—¶é—´é•¿åº¦,å•ä½ä¸ºç§’
max-lease-time  86400;  # æŒ‡å®šæœ€å¤§ç§Ÿçº¦çš„æ—¶é—´é•¿åº¦

# ä»¥ä¸‹ä¸ºæŸåŒºåŸŸçš„ IP åœ°å€èŒƒå›´

subnet 192.168.1.0 netmask 255.255.255.0 {         # å®šä¹‰ DHCP ä½œç”¨åŸŸ
	range  192.168.1.20 192.168.1.100;                # æŒ‡å®šå¯åˆ†é…çš„ IP åœ°å€èŒƒå›´
	option routers  192.168.1.254;                       # æŒ‡å®šè¯¥ç½‘æ®µçš„é»˜è®¤ç½‘å…³
}
```
```bash
dhcpd -t                          # æ£€æµ‹è¯­æ³•æœ‰æ— é”™è¯¯
service dhcpd start               # å¼€å¯ dhcp æœåŠ¡

firewall-cmd --zone=public --add-service=dhcp --permanent
firewall-cmd --reload             # è®°å¾—é˜²ç«å¢™æ”¾è¡Œ

cat /var/lib/dhcpd/dhcpd.leases   # æŸ¥çœ‹ç§Ÿçº¦æ–‡ä»¶,äº†è§£ç§Ÿç”¨æƒ…å†µ
```
---

## DNS

> DNS ç”¨äºå°†äººç±»å¯è¯»çš„åŸŸå(ä¾‹å¦‚ï¼Œwww.google.com) è¿›è¡ŒåŸŸåè§£æä¸ºæœºå™¨å¯è¯»çš„ IP åœ°å€

**å®‰è£…**
```
yum install bind-*
```

**ä¸»é…ç½®æ–‡ä»¶**
```vim
vim /etc/named.conf

options {
    listen-on port 53 { any; };
    listen-on-v6 port 53 { any; };
    allow-query     { any; };
}
```

**åŒºåŸŸé…ç½®æ–‡ä»¶**
```vim
vim /etc/named.rfc1912.zones

zone "abc.com" IN {
        type master;
        file "abc.localhost";
};

zone "1.1.1.in-addr.arpa" IN {
        type master;
        file "abc.loopback";
};

zone "2.1.1.in-addr.arpa" IN {
        type master;
        file "www.loopback";
};
```

**åˆ›å»ºåŒºåŸŸæ•°æ®æ–‡ä»¶**
```bash
cd /var/named/
cp named.localhost abc.localhost
cp named.loopback abc.loopback
cp named.loopback www.loopback

chown named abc.localhost
chown named abc.loopback
chown named www.loopback
```

**åŸŸåæ­£å‘åå‘è§£æé…ç½®æ–‡ä»¶**
```vim
vim /var/named/abc.localhost

$TTL 1D
@      IN SOA  @ rname.invalid. (
                                      	0      ; serial
                                      	1D      ; refresh
                                      	1H      ; retry
                                      	1W      ; expire
                                      	3H )    ; minimum
      	NS     @
     		A      127.0.0.1
	    	AAAA   ::1
ftp    	A      1.1.1.1
www     A      1.1.2.1
```
```vim
vim /var/named/abc.loopback

$TTL 1D
@	IN SOA  @ rname.invalid. (
  	                                    0 ; serial
                                      	1D ; refresh
                                      	1H ; retry
                                      	1W ; expire
                                      	3H ) ; minimum
      	NS 		@
      	A 		127.0.0.1
      	AAAA	::1
      	PTR 	localhost.
1 PTR ftp.abc.com.
```
```vim
vim /var/named/www.loopback

$TTL 1D
@ 		IN SOA  @ rname.invalid. (
  	                                    0 ; serial
                                      	1D ; refresh
                                      	1H ; retry
                                      	1W ; expire
                                      	3H ) ; minimum
      	NS 		@
      	A 		127.0.0.1
      	AAAA	::1
      	PTR 	localhost.
1 PTR www.abc.com.
```

**å¯æœåŠ¡**
```bash
named-checkconf
named-checkzone abc.com abc.localhost
named-checkzone abc.com abc.loopback
named-checkzone abc.com www.loopback
service named restart

setenforce 0      # å…³é—­ selinux
firewall-cmd --zone=public --add-service=dns --permanent
firewall-cmd --reload
```

**æ›´å¤šé…ç½®æ¡ˆä¾‹**

è§ [dns.md](./å®éªŒ/dns.md)

---

## frp

> å¿«é€Ÿåå‘ä»£ç†ï¼Œå°†æœ¬åœ°æœåŠ¡å™¨æ˜ å°„åˆ°å…¬ç½‘ã€‚

**é¡¹ç›®åœ°å€**
- https://github.com/fatedier/frp

**æœåŠ¡ç«¯å®‰è£…**
```bash
wget https://github.com/fatedier/frp/releases/download/v0.32.0/frp_0.32.0_linux_amd64.tar.gz
tar -zxvf frp_0.32.0_linux_amd64.tar.gz
cd frp_0.32.0_linux_amd64
rm -rf frpc*
```

ç¼–è¾‘ frps é…ç½®æ–‡ä»¶
```bash
vim frps.ini

[common]
bind_port = 7000
dashboard_port = 7500
dashboard_user = admin
dashboard_pwd = admin
```

ç¬¬1è¡Œä¸º frps å’Œ frpc ä¹‹é—´ç«¯å£,ç¬¬ 2 è¡Œä¸ºç›‘æ§é¡µé¢ web åœ°å€,ç¬¬ 3.4 è¡Œä¸ºç›‘æ§é¡µé¢è´¦å·å¯†ç 

**æœåŠ¡ç«¯è¿è¡Œ**

è¿è¡Œ frps,-c å‚æ•°ç”¨äºæŒ‡å®šé…ç½®æ–‡ä»¶,åœ¨åŒçº§ç›®å½•ä¸‹çš„è¯å¯ä»¥ç›´æ¥è¿è¡Œ frps
```bash
service firewalld stop  # å…ˆå…³é—­é˜²ç«å¢™

./frps -c frps.ini
```

æ­¤æ—¶æœåŠ¡å™¨å·²åœ¨è¿è¡Œ,å¯ä»¥è®¿é—® æœåŠ¡å™¨ip:7500 è®¿é—® web ç›‘æ§ç•Œé¢

**å®¢æˆ·ç«¯å®‰è£…**
```bash
wget https://github.com/fatedier/frp/releases/download/v0.32.0/frp_0.32.0_linux_amd64.tar.gz
tar -zxvf frp_0.32.0_linux_amd64.tar.gz
cd frp_0.32.0_linux_amd64
rm -rf frps*
```

è¿™é‡Œæœ€åä¸€å¥æ˜¯ rm -rf frps* ä¸æœåŠ¡ç«¯æ“ä½œçš„æœ€åä¸€å¥ä¸ç›¸åŒã€‚

ç¼–è¾‘ frpc é…ç½®æ–‡ä»¶
```bash
vim frpc.ini

[common]
server_addr = 1.1.1.1   # å¡«æœåŠ¡å™¨IP
server_port = 7000      # å¡«æœåŠ¡å™¨ç«¯å£

# sshçš„é…ç½®
[ssh]
type = tcp
local_ip = 127.0.0.1
local_port = 22
remote_port = 10000
use_compression = true

[DSM]
type = tcp
local_ip = 192.168.1.1 # ç¾¤æ™– NAS åœ¨å±€åŸŸç½‘ä¸­çš„å†…ç½‘ IP
local_port = 5000
remote_port = 10002
```

è¿™æ ·å°±åœ¨æœ¬åœ°ä¸Šæ–°å¢äº†â€œDSMâ€å’Œâ€œSSHâ€ä¸¤ä¸ªå¯ä¾›å…¬ç½‘è®¿é—®çš„æœåŠ¡äº†

**å®¢æˆ·ç«¯è¿è¡Œ**
```bash
./frpc -c frpc.ini
# -c å‚æ•°ç”¨äºæŒ‡å®šé…ç½®æ–‡ä»¶,åœ¨åŒçº§ç›®å½•ä¸‹çš„è¯ å¯ä»¥ç›´æ¥è¿è¡Œ .frpc
```

SSH è¿æ¥æµ‹è¯•
```bash
ssh root@1.1.1.1 -p 10000
```
è¿™ä¸ªæ—¶å€™ç›¸å½“äºåœ¨è¿æ¥å®¢æˆ·ç«¯çš„ SSH æœåŠ¡

---

## Kicktart

> æ˜¯ Kicktart ä¸æ˜¯ kickstarter,è¿™ç©æ„ä¸èƒ½ä¼—ç­¹,è¿™æ˜¯ç”¨äºè”ç½‘å®‰è£…ç³»ç»Ÿæ—¶ç»™ PXE æœåŠ¡æä¾›åº”ç­”æ–‡ä»¶çš„

- è°ƒç”¨æœåŠ¡:PXE + TFTP +FTP + DHCP + Kicktart
- ç¯å¢ƒ:VMWARE
- 1å°æ— äººå€¼å®ˆç³»ç»Ÿâ€”â€”RHEL 7â€”â€”192.168.10.10
- 1å°å®¢æˆ·ç«¯â€”â€”æœªå®‰è£…æ“ä½œç³»ç»Ÿ

æ³¨:vmware ä¸­åšå®éªŒéœ€è¦åœ¨è™šæ‹Ÿç½‘ç»œç¼–è¾‘å™¨ä¸­å°† dhcp æœåŠ¡å…³é—­

**é…ç½® DHCP**

DHCP æœåŠ¡ç¨‹åºç”¨äºä¸ºå®¢æˆ·ç«¯ä¸»æœºåˆ†é…å¯ç”¨çš„ IP åœ°å€,è€Œä¸”è¿™æ˜¯æœåŠ¡å™¨ä¸å®¢æˆ·ç«¯ä¸»æœºè¿›è¡Œæ–‡ä»¶ä¼ è¾“çš„åŸºç¡€

```bash
yum install -y dhcp
```

```vim
# è¿™é‡Œä½¿ç”¨çš„é…ç½®æ–‡ä»¶æœ‰ä¸¤ä¸ªä¸»è¦åŒºåˆ«:å…è®¸äº† BOOTP å¼•å¯¼ç¨‹åºåè®®,æ—¨åœ¨è®©å±€åŸŸç½‘å†…æš‚æ—¶æ²¡æœ‰æ“ä½œç³»ç»Ÿçš„ä¸»æœºä¹Ÿèƒ½è·å–é™æ€ IP åœ°å€;åœ¨é…ç½®æ–‡ä»¶çš„æœ€ä¸‹é¢åŠ è½½äº†å¼•å¯¼é©±åŠ¨æ–‡ä»¶ pxelinux.0 (è¿™ä¸ªæ–‡ä»¶ä¼šåœ¨ä¸‹é¢çš„æ­¥éª¤ä¸­åˆ›å»º) ,å…¶ç›®çš„æ˜¯è®©å®¢æˆ·ç«¯ä¸»æœºè·å–åˆ° IP åœ°å€åä¸»åŠ¨è·å–å¼•å¯¼é©±åŠ¨æ–‡ä»¶,è‡ªè¡Œè¿›å…¥ä¸‹ä¸€æ­¥çš„å®‰è£…è¿‡ç¨‹.
vim /etc/dhcp/dhcpd.conf

allow booting;
allow bootp;
ddns-update-style interim;
ignore client-updates;
subnet 192.168.0.0 netmask 255.255.255.0 {
        option subnet-mask 255.255.255.0;
        option domain-name-servers 192.168.10.10;
        range dynamic-bootp 192.168.10.100 192.168.10.200;
        default-lease-time 21600;
        max-lease-time 43200;
        next-server 192.168.10.10;
        filename "pxelinux.0";
}
```
```bash
systemctl restart dhcpd
systemctl enable dhcpd
```

**é…ç½® TFTP æœåŠ¡**

é…ç½® TFTP æœåŠ¡ç¨‹åº,ä¸ºå®¢æˆ·ç«¯ä¸»æœºæä¾›å¼•å¯¼åŠé©±åŠ¨æ–‡ä»¶.å½“å®¢æˆ·ç«¯ä¸»æœºæœ‰äº†åŸºæœ¬çš„é©±åŠ¨ç¨‹åºä¹‹å,å†é€šè¿‡ vsftpd æœåŠ¡ç¨‹åºå°†å®Œæ•´çš„å…‰ç›˜é•œåƒæ–‡ä»¶ä¼ è¾“è¿‡å».
```bash
yum install -y tftp-server xinetd
```
```vim
vim /etc/xinetd.d/tftp

service tftp
{
        socket_type = dgram
        protocol = udp
        wait = yes
        user = root
        server = /usr/sbin/in.tftpd
        server_args = -s /var/lib/tftpboot
        disable = no
        per_source = 11
        cps = 100 2
        flags = IPv4
}
```
```bash
systemctl restart xinetd
systemctl enable xinetd
firewall-cmd --permanent --add-port=69/udp    # æ”¾è¡Œ tftp
firewall-cmd --reload
```

**é…ç½® SYSLinux æœåŠ¡**

SYSLinux æ˜¯ä¸€ä¸ªç”¨äºæä¾›å¼•å¯¼åŠ è½½çš„æœåŠ¡ç¨‹åº.ä¸å…¶è¯´ SYSLinux æ˜¯ä¸€ä¸ªæœåŠ¡ç¨‹åº,ä¸å¦‚è¯´æ›´éœ€è¦é‡Œé¢çš„å¼•å¯¼æ–‡ä»¶,åœ¨å®‰è£…å¥½ SYSLinux æœåŠ¡ç¨‹åºè½¯ä»¶åŒ…å, `/usr/share/syslinux` ç›®å½•ä¸­ä¼šå‡ºç°å¾ˆå¤šå¼•å¯¼æ–‡ä»¶.
```bash
yum install -y syslinux

# é¦–å…ˆæŠŠ SYSLinux æä¾›çš„å¼•å¯¼æ–‡ä»¶å¤åˆ¶åˆ° TFTP æœåŠ¡ç¨‹åºçš„é»˜è®¤ç›®å½•ä¸­,ä¹Ÿå°±æ˜¯ pxelinux.0,è¿™æ ·å®¢æˆ·ç«¯ä¸»æœºå°±èƒ½å¤Ÿé¡ºåˆ©åœ°è·å–åˆ°å¼•å¯¼æ–‡ä»¶.å¦å¤–åœ¨ RHEL 7 ç³»ç»Ÿå…‰ç›˜é•œåƒä¸­ä¹Ÿæœ‰ä¸€äº›éœ€è¦è°ƒå–çš„å¼•å¯¼æ–‡ä»¶.
cd /var/lib/tftpboot
cp /usr/share/syslinux/pxelinux.0 .
mkdir /media/cdrom
mount /dev/cdrom /media/cdrom
# ç¡®è®¤å…‰ç›˜é•œåƒå·²ç»è¢«æŒ‚è½½åˆ° /media/cdrom ç›®å½•å,ä½¿ç”¨å¤åˆ¶å‘½ä»¤å°†å…‰ç›˜é•œåƒä¸­è‡ªå¸¦çš„ä¸€äº›å¼•å¯¼æ–‡ä»¶ä¹Ÿå¤åˆ¶åˆ° TFTP æœåŠ¡ç¨‹åºçš„é»˜è®¤ç›®å½•ä¸­.
cp /media/cdrom/images/pxeboot/{vmlinuz,initrd.img} .
cp /media/cdrom/isolinux/{vesamenu.c32,boot.msg} .

# åœ¨ TFTP æœåŠ¡ç¨‹åºçš„ç›®å½•ä¸­æ–°å»º pxelinux.cfg ç›®å½•,è™½ç„¶è¯¥ç›®å½•çš„åå­—å¸¦æœ‰åç¼€,ä½†ä¾ç„¶ä¹Ÿæ˜¯ç›®å½•,è€Œéæ–‡ä»¶!å°†ç³»ç»Ÿå…‰ç›˜ä¸­çš„å¼€æœºé€‰é¡¹èœå•å¤åˆ¶åˆ°è¯¥ç›®å½•ä¸­,å¹¶å‘½åä¸º default.è¿™ä¸ª default æ–‡ä»¶å°±æ˜¯å¼€æœºæ—¶çš„é€‰é¡¹èœå•.
mkdir pxelinux.cfg
cp /media/cdrom/isolinux/isolinux.cfg pxelinux.cfg/default
```
```vim
# é»˜è®¤çš„å¼€æœºèœå•ä¸­æœ‰ä¸¤ä¸ªé€‰é¡¹,è¦ä¹ˆæ˜¯å®‰è£…ç³»ç»Ÿ,è¦ä¹ˆæ˜¯å¯¹å®‰è£…ä»‹è´¨è¿›è¡Œæ£€éªŒ.æ—¢ç„¶æˆ‘ä»¬å·²ç»ç¡®å®šé‡‡ç”¨æ— äººå€¼å®ˆçš„æ–¹å¼å®‰è£…ç³»ç»Ÿ,è¿˜éœ€è¦ä¸ºæ¯å°ä¸»æœºæ‰‹åŠ¨é€‰æ‹©ç›¸åº”çš„é€‰é¡¹,æœªå…ä¸æˆ‘ä»¬çš„ä¸»æ—¨ (æ— äººå€¼å®ˆå®‰è£…) ç›¸æ‚–.ç°åœ¨æˆ‘ä»¬ç¼–è¾‘è¿™ä¸ª default æ–‡ä»¶,æŠŠç¬¬ 1 è¡Œçš„ default å‚æ•°ä¿®æ”¹ä¸º linux,è¿™æ ·ç³»ç»Ÿåœ¨å¼€æœºæ—¶å°±ä¼šé»˜è®¤æ‰§è¡Œé‚£ä¸ªåç§°ä¸º linux çš„é€‰é¡¹äº†.å¯¹åº”çš„ linux é€‰é¡¹å¤§çº¦åœ¨ 64 è¡Œ,æˆ‘ä»¬å°†é»˜è®¤çš„å…‰ç›˜é•œåƒå®‰è£…æ–¹å¼ä¿®æ”¹æˆ FTP æ–‡ä»¶ä¼ è¾“æ–¹å¼,å¹¶æŒ‡å®šå¥½å…‰ç›˜é•œåƒçš„è·å–ç½‘å€ä»¥åŠ Kickstart åº”ç­”æ–‡ä»¶çš„è·å–è·¯å¾„

# ä¿®æ”¹ç¬¬ 1 è¡Œå’Œç¬¬ 64 è¡Œ
vim pxelinux.cfg/default

1 default linux
64 append initrd=initrd.img inst.stage2=ftp://192.168.10.10 ks=ftp://192.168.10.10/pub/ks.cfg quiet
```

**é…ç½® VSftpd æœåŠ¡**
```bash
yum install -y vsftpd

systemctl restart vsftpd
systemctl enable vsftpd
ln -s '/usr/lib/systemd/system/vsftpd.service' '/etc/systemd/system/multi-user.target.wants/vsftpd.service'

cp -rvf /media/cdrom/* /var/ftp
firewall-cmd --permanent --add-service=ftp
firewall-cmd --reload
setsebool -P ftpd_connect_all_unreserved=on
```

**åˆ›å»º KickStart åº”ç­”æ–‡ä»¶**
```bash
cp ~/anaconda-ks.cfg /var/ftp/pub/ks.cfg
chmod +r /var/ftp/pub/ks.cfg
```
```vim
# ä¿®æ”¹ç¬¬ 7ã€27ã€35 è¡Œ
vim /var/ftp/pub/ks.cfg

url --url=ftp://192.168.0.105
timezone Asia/Shanghai --isUtc
clearpart --all --initlabel
# å¦‚æœè§‰å¾—ç³»ç»Ÿé»˜è®¤è‡ªå¸¦çš„åº”ç­”æ–‡ä»¶å‚æ•°è¾ƒå°‘,ä¸èƒ½æ»¡è¶³ç”Ÿäº§ç¯å¢ƒçš„éœ€æ±‚,åˆ™å¯ä»¥é€šè¿‡ Yum è½¯ä»¶ä»“åº“æ¥å®‰è£… system-config-kickstart è½¯ä»¶åŒ….è¿™æ˜¯ä¸€æ¬¾å›¾å½¢åŒ–çš„ Kickstart åº”ç­”æ–‡ä»¶ç”Ÿæˆå·¥å…·,å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚ç”Ÿæˆè‡ªå®šä¹‰çš„åº”ç­”æ–‡ä»¶,ç„¶åå°†ç”Ÿæˆçš„æ–‡ä»¶æ”¾åˆ° /var/ftp/pub ç›®å½•ä¸­å¹¶å°†åå­—ä¿®æ”¹ä¸º ks.cfg å³å¯.
```

**Source & Reference**
- [ç¬¬19ç«  ä½¿ç”¨ PXE+Kickstart æ— äººå€¼å®ˆå®‰è£…æœåŠ¡.](https://www.linuxprobe.com/chapter-19.html)

---

## nps

> ã€ä¸€æ¬¾è½»é‡çº§ã€é«˜æ€§èƒ½ã€åŠŸèƒ½å¼ºå¤§çš„å†…ç½‘ç©¿é€ä»£ç†æœåŠ¡å™¨ã€‚æ”¯æŒtcpã€udpã€socks5ã€httpç­‰å‡ ä¹æ‰€æœ‰æµé‡è½¬å‘ï¼Œå¯ç”¨æ¥è®¿é—®å†…ç½‘ç½‘ç«™ã€æœ¬åœ°æ”¯ä»˜æ¥å£è°ƒè¯•ã€sshè®¿é—®ã€è¿œç¨‹æ¡Œé¢ï¼Œå†…ç½‘dnsè§£æã€å†…ç½‘socks5ä»£ç†ç­‰ç­‰â€¦â€¦ï¼Œå¹¶å¸¦æœ‰åŠŸèƒ½å¼ºå¤§çš„webç®¡ç†ç«¯ã€‚

**é¡¹ç›®åœ°å€**
- https://github.com/cnlh/nps

**æœåŠ¡ç«¯å®‰è£…**
```bash
mkdir nps
cd nps
wget https://github.com/ehang-io/nps/releases/download/v0.26.7/linux_amd64_server.tar.gz
tar -zxvf linux_amd64_server.tar.gz
./nps install
nps start

# å…³é—­é˜²ç«å¢™
systemctl stop firewalld
```

è®¿é—® <ip>:8080 ,é»˜è®¤ç”¨æˆ·åå’Œå¯†ç  admin/123

**å®¢æˆ·ç«¯å®‰è£…**

åœ¨æœåŠ¡å™¨ç«¯æ–°å¢å®¢æˆ·ç«¯,ç‚¹å‡»å®¢æˆ·ç«¯åˆ—è¡¨å‰çš„+å·ï¼Œå¤åˆ¶å¯åŠ¨å‘½ä»¤

æ‰§è¡Œå¯åŠ¨å‘½ä»¤ï¼Œlinux ç›´æ¥æ‰§è¡Œå³å¯ï¼Œwindows å°† ./npc æ¢æˆ npc.exe ç”¨ cmd æ‰§è¡Œ

**ä½¿ç”¨ç¤ºä¾‹**

- https://ehang-io.github.io/nps/#/example

---

## OpenVPN

<p align="center">
    <img src="../../../assets/img/logo/OpenVPN.png" width="30%">
</p>

> OpenVPN æ˜¯ä¸€ä¸ªç”¨äºåˆ›å»ºè™šæ‹Ÿä¸“ç”¨ç½‘ç»œåŠ å¯†é€šé“çš„è½¯ä»¶åŒ…

**å®˜ç½‘**
- https://openvpn.net/

**docker å®‰è£…**
```bash
systemctl start docker
docker pull kylemanna/openvpn:2.4
mkdir -p /data/openvpn
docker run -v /data/openvpn:/etc/openvpn --rm kylemanna/openvpn:2.4 ovpn_genconfig -u udp://<ä½ çš„IP>
```

**ç”Ÿæˆå¯†é’¥æ–‡ä»¶**
```bash
docker run -v /data/openvpn:/etc/openvpn --rm -it kylemanna/openvpn:2.4 ovpn_initpki
è¾“å…¥ç§é’¥å¯†ç  (è¾“å…¥æ—¶æ˜¯çœ‹ä¸è§çš„) :
Enter PEM pass phrase:12345678
å†è¾“å…¥ä¸€é
Verifying - Enter PEM pass phrase:12345678
è¾“å…¥ä¸€ä¸ª CA åç§° (æˆ‘è¿™é‡Œç›´æ¥å›è½¦)
Common Name (eg: your user, host, or server name) [Easy-RSA CA]:
è¾“å…¥åˆšæ‰è®¾ç½®çš„ç§é’¥å¯†ç  (è¾“å…¥å®Œæˆåä¼šå†è®©è¾“å…¥ä¸€æ¬¡)
Enter pass phrase for /etc/openvpn/pki/private/ca.key:12345678
```

> æ³¨æ„ : æ­¤å¤„åªæ˜¯ä¸ºäº†æ–¹ä¾¿æ¼”ç¤º,ç”Ÿäº§ç¯å¢ƒä¸‹è¯·ä¸è¦ä½¿ç”¨ç±»ä¼¼ 12345678 è¿™ç±»å¼±å£ä»¤

**ç”Ÿæˆå®¢æˆ·ç«¯è¯ä¹¦ (è¿™é‡Œçš„ user æ”¹æˆä½ æƒ³è¦çš„åå­—)**
```bash
docker run -v /data/openvpn:/etc/openvpn --rm -it kylemanna/openvpn:2.4 easyrsa build-client-full user nopass

è¾“å…¥åˆšæ‰è®¾ç½®çš„å¯†ç 
Enter pass phrase for /etc/openvpn/pki/private/ca.key:12345678
```

**å¯¼å‡ºå®¢æˆ·ç«¯é…ç½®**
```bash
mkdir -p /data/openvpn/conf
docker run -v /data/openvpn:/etc/openvpn --rm kylemanna/openvpn:2.4 ovpn_getclient user > /data/openvpn/conf/user.ovpn
```

**å¯åŠ¨ OpenVPN æœåŠ¡**
```bash
docker run --name openvpn -v /data/openvpn:/etc/openvpn -d -p 1194:1194/udp --cap-add=NET_ADMIN kylemanna/openvpn:2.4

service firewalld stop
```

**å°†ç™»å½•çš„è¯ä¹¦ä¸‹è½½åˆ°æœ¬åœ°**
```bash
yum install lrzsz -y
sz /data/openvpn/conf/whsir.ovpn
```

åœ¨ openvpn çš„å®‰è£…ç›®å½•ä¸‹,æœ‰ä¸ª config ç›®å½•,å°†æœåŠ¡å™¨ä¸Šçš„ user.ovpn,æ”¾åœ¨è¯¥ç›®å½•ä¸‹,è¿è¡Œ OpenVPN GUI,å³é”® whsir è¿æ¥ connect

**Source & Reference**
- [é€šè¿‡ docker æ­å»º openvpn](https://blog.whsir.com/post-2809.html)

---

## PowerDNS

<p align="center">
    <img src="../../../assets/img/logo/PowerDNS.png" width="33%">
</p>

> ä¸€ç§ DNS æœåŠ¡å™¨, ä¼˜ç‚¹, æ”¯æŒ PHP ç½‘é¡µç®¡ç†, æ”¯æŒç›´æ¥åœ¨æ•°æ®åº“ä¸­æ·»åŠ  DNS åœ°å€è®°å½•, æ¯”è¾ƒçµæ´», æ–¹ä¾¿

**é¡¹ç›®åœ°å€**
- https://github.com/PowerDNS/pdns

**å®‰è£…**

ä»¥ Ubuntu16.04 ä¸ºä¾‹

å…ˆé…ç½®å¥½ mysql
```bash
apt -y install mariadb-server mariadb-client
service mariadb start
mysql_secure_installation   # åˆå§‹åŒ–ä¸‹ Mysql,æ­¤æ—¶é…ç½®å¯†ç ,è¿™é‡Œä¸¾ä¾‹ä¸º 123456
```

ä¸º PowerDNS åˆ›å»ºä¸€ä¸ªæ•°æ®åº“,å¹¶åˆ›å»ºä¸€ä¸ªæ•°æ®åº“ç”¨æˆ· powerdns,å¯†ç  123456
```sql
mysql -u root -p

CREATE DATABASE powerdns;
GRANT ALL ON powerdns.* TO 'powerdns'@'localhost' IDENTIFIED BY '123456';
GRANT ALL ON powerdns.* TO 'powerdns'@'localhost.localdomain' IDENTIFIED BY '123456';
FLUSH PRIVILEGES;
```

> æ³¨æ„ : æ­¤å¤„åªæ˜¯ä¸ºäº†æ–¹ä¾¿æ¼”ç¤º,ç”Ÿäº§ç¯å¢ƒä¸‹è¯·ä¸è¦ä½¿ç”¨ç±»ä¼¼ 123456 è¿™ç±»å¼±å£ä»¤

åˆ›å»º PowerDNS æ‰€éœ€çš„è¡¨
```sql
CREATE DATABASE IF NOT EXISTS powerdns;
USE powerdns;

CREATE TABLE domains (
  id                    INT AUTO_INCREMENT,
  name                  VARCHAR(255) NOT NULL,
  master                VARCHAR(128) DEFAULT NULL,
  last_check            INT DEFAULT NULL,
  type                  VARCHAR(6) NOT NULL,
  notified_serial       INT DEFAULT NULL,
  account               VARCHAR(40) CHARACTER SET 'utf8' DEFAULT NULL,
  PRIMARY KEY (id)
) Engine=InnoDB CHARACTER SET 'latin1';

CREATE UNIQUE INDEX name_index ON domains(name);


CREATE TABLE records (
  id                    BIGINT AUTO_INCREMENT,
  domain_id             INT DEFAULT NULL,
  name                  VARCHAR(255) DEFAULT NULL,
  type                  VARCHAR(10) DEFAULT NULL,
  content               VARCHAR(64000) DEFAULT NULL,
  ttl                   INT DEFAULT NULL,
  prio                  INT DEFAULT NULL,
  change_date           INT DEFAULT NULL,
  disabled              TINYINT(1) DEFAULT 0,
  ordername             VARCHAR(255) BINARY DEFAULT NULL,
  auth                  TINYINT(1) DEFAULT 1,
  PRIMARY KEY (id)
) Engine=InnoDB CHARACTER SET 'latin1';

CREATE INDEX nametype_index ON records(name,type);
CREATE INDEX domain_id ON records(domain_id);
CREATE INDEX ordername ON records (ordername);


CREATE TABLE supermasters (
  ip                    VARCHAR(64) NOT NULL,
  nameserver            VARCHAR(255) NOT NULL,
  account               VARCHAR(40) CHARACTER SET 'utf8' NOT NULL,
  PRIMARY KEY (ip, nameserver)
) Engine=InnoDB CHARACTER SET 'latin1';


CREATE TABLE comments (
  id                    INT AUTO_INCREMENT,
  domain_id             INT NOT NULL,
  name                  VARCHAR(255) NOT NULL,
  type                  VARCHAR(10) NOT NULL,
  modified_at           INT NOT NULL,
  account               VARCHAR(40) CHARACTER SET 'utf8' DEFAULT NULL,
  comment               TEXT CHARACTER SET 'utf8' NOT NULL,
  PRIMARY KEY (id)
) Engine=InnoDB CHARACTER SET 'latin1';

CREATE INDEX comments_name_type_idx ON comments (name, type);
CREATE INDEX comments_order_idx ON comments (domain_id, modified_at);


CREATE TABLE domainmetadata (
  id                    INT AUTO_INCREMENT,
  domain_id             INT NOT NULL,
  kind                  VARCHAR(32),
  content               TEXT,
  PRIMARY KEY (id)
) Engine=InnoDB CHARACTER SET 'latin1';

CREATE INDEX domainmetadata_idx ON domainmetadata (domain_id, kind);


CREATE TABLE cryptokeys (
  id                    INT AUTO_INCREMENT,
  domain_id             INT NOT NULL,
  flags                 INT NOT NULL,
  active                BOOL,
  content               TEXT,
  PRIMARY KEY(id)
) Engine=InnoDB CHARACTER SET 'latin1';

CREATE INDEX domainidindex ON cryptokeys(domain_id);


CREATE TABLE tsigkeys (
  id                    INT AUTO_INCREMENT,
  name                  VARCHAR(255),
  algorithm             VARCHAR(50),
  secret                VARCHAR(255),
  PRIMARY KEY (id)
) Engine=InnoDB CHARACTER SET 'latin1';

CREATE UNIQUE INDEX namealgoindex ON tsigkeys(name, algorithm);
exit;
```

å®‰è£… PowerDNS
```bash
apt install -y pdns-recursor pdns-server pdns-backend-mysql
```

Ubuntu 18.04 é™„å¸¦ systemd-resolveï¼Œä½ éœ€è¦ç¦ç”¨å®ƒï¼Œå¹¶åˆ é™¤ resolv.conf æ–‡ä»¶ï¼Œå› ä¸ºå®ƒç»‘å®šåˆ°ç«¯å£ 53 ï¼Œè¿™å°†ä¸ PowerDNS ç«¯å£å†²çªã€‚
```bash
systemctl disable systemd-resolved
systemctl stop systemd-resolved
rm /etc/resolv.conf
```

```vim
vim /etc/powerdns/pdns.d/pdns.local.gmysql.conf

launch=gmysql

gmysql-host=localhost
gmysql-dbname=powerdns      # æ”¹æˆä¹‹å‰åˆ›å»ºçš„æ•°æ®åº“
gmysql-user=powerdns        # æ”¹æˆä¹‹å‰åˆ›å»ºçš„ç”¨æˆ·
gmysql-password=123456      # æ”¹æˆä¹‹å‰åˆ›å»ºçš„å¯†ç 
```

```
sed -i "s|# local-port=.*|local-port=5300|" /etc/powerdns/pdns.conf
sed -i "s|# config-dir=.*|config-dir=/etc/powerdns|" /etc/powerdns/pdns.conf
sed -i "s|# daemon=.*|daemon=yes|" /etc/powerdns/pdns.conf
sed -i "s|# guardian=.*|guardian=yes|" /etc/powerdns/pdns.conf
sed -i "s|# master=.*|master=yes|" /etc/powerdns/pdns.conf
sed -i "s|# max-tcp-connections=.*|max-tcp-connections=20|" /etc/powerdns/pdns.conf

service pdns restart
```

æ­¤æ—¶è®°å¾—å°† /etc/resolv.conf ä¸­çš„ nameserver æ”¹ä¸º 127.0.0.1
```bash
cat /etc/resolv.conf
# Generated by NetworkManager
search localdomain
nameserver 127.0.0.1
```

æµ‹è¯•
```
dig @127.0.0.1
dig www.baidu.com
pdnsutil create-zone test-zone-1
pdnsutil list-zone test-zone-1
```

### PowerDNS-Admin

> PowerDNS-Admin æ˜¯ä¸€ä¸ªå…·æœ‰ä»¥ä¸‹é«˜çº§åŠŸèƒ½çš„ PowerDNS Web ç•Œé¢

**é¡¹ç›®åœ°å€**
- https://github.com/ngoduykhanh/PowerDNS-Admin

**å®‰è£…**

è®¾ç½®æ•°æ®åº“
```sql
mysql -u root -p
CREATE DATABASE powerdnsadmin;
GRANT ALL PRIVILEGES ON powerdnsadmin.* TO 'pdnsadminuser'@'%' IDENTIFIED BY '123456';
FLUSH PRIVILEGES;
quit
```
> æ³¨æ„ : æ­¤å¤„åªæ˜¯ä¸ºäº†æ–¹ä¾¿æ¼”ç¤º,ç”Ÿäº§ç¯å¢ƒä¸‹è¯·ä¸è¦ä½¿ç”¨ç±»ä¼¼ 123456 è¿™ç±»å¼±å£ä»¤

```bash
# Install Python 3 devevelopment package
apt install -y python3-dev
# Install required packages for building python libraries from requirements.txt file
apt install -y libmysqlclient-dev libsasl2-dev libldap2-dev libssl-dev libxml2-dev libxslt1-dev libxmlsec1-dev libffi-dev pkg-config apt-transport-https virtualenv build-essential

# Install NodeJs
curl -sL https://deb.nodesource.com/setup_10.x | bash -
apt install -y nodejs

# Install yarn to build asset files
curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | apt-key add -
echo "deb https://dl.yarnpkg.com/debian/ stable main" > /etc/apt/sources.list.d/yarn.list
apt update -y
apt install -y yarn

# Checkout source code and create virtualenv
git clone https://github.com/ngoduykhanh/PowerDNS-Admin.git /opt/web/powerdns-admin
cd /opt/web/powerdns-admin
virtualenv -p python3 flask

# Activate your python3 environment and install libraries
source ./flask/bin/activate
pip install -r requirements.txt
```

Running PowerDNS-Admin

```vim
vim configs/development.py

SQLA_DB_USER = 'powerdns'   # æ”¹æˆä¹‹å‰åˆ›å»ºçš„æ•°æ®åº“
SQLA_DB_PASSWORD = '123456' # æ”¹æˆä¹‹å‰åˆ›å»ºçš„ç”¨æˆ·
SQLA_DB_HOST = '127.0.0.1'  # æ”¹æˆä¹‹å‰åˆ›å»ºçš„å¯†ç 
SQLA_DB_NAME = 'powerdns'
```

```bash
export FLASK_CONF=../configs/development.py
export FLASK_APP=powerdnsadmin/__init__.py
flask db upgrade

# generate asset files
yarn install --pure-lockfile
flask assets build

# run PowerDNS-Admin by command
./run.py
```

ç°åœ¨è®¿é—® <ip>:9191

> æ³¨: è¿™å¯¹äºæµ‹è¯•ç¯å¢ƒå¾ˆæœ‰æ•ˆï¼Œä½†æ˜¯å¯¹äºç”Ÿäº§ç¯å¢ƒï¼Œåº”è¯¥ä½¿ç”¨ gunicorn æˆ– uwsgi

---

## proxychains-ng

> é€šè¿‡ DLL æ³¨å…¥,ä½¿ç›®æ ‡ç¨‹åºèµ°ä»£ç†

**é¡¹ç›®åœ°å€**
- https://github.com/rofl0r/proxychains-ng

**å®‰è£…**
```bash
git clone https://github.com/rofl0r/proxychains-ng.git
cd proxychains-ng
./configure
make && make install
cp ./src/proxychains.conf /etc/proxychains.conf
cd .. && rm -rf proxychains-ng
```

**ç¼–è¾‘é…ç½®**
```bash
vim /etc/proxychains.conf

socks5 127.0.0.1 1080   # æ”¹æˆä½ æ‡‚çš„
```

**ä½¿ç”¨**

åœ¨éœ€è¦ä»£ç†çš„å‘½ä»¤å‰åŠ ä¸Š proxychains4 ,å¦‚ : `proxychains4 wget https://www.google.com/`

---

## SSH

> Secure Shell æ˜¯ä¸€ç¨®åŠ å¯†çš„ç¶²è·¯å‚³è¼¸å”å®šï¼Œå¯åœ¨ä¸å®‰å…¨çš„ç¶²è·¯ä¸­ç‚ºç¶²è·¯æœå‹™æä¾›å®‰å…¨çš„å‚³è¼¸ç’°å¢ƒã€‚

**å®˜ç½‘**
- https://www.ssh.com

ä¸€èˆ¬ä¸»æœºå®‰è£…å®Œæ¯•å SSH æ˜¯é»˜è®¤å¼€å¯çš„,ä½¿ç”¨ `/etc/init.d/ssh status` æŸ¥çœ‹ä¸»æœº SSH çŠ¶æ€

> æ³¨: ssh_config ä¸ºå®¢æˆ·ç«¯è¿æ¥åˆ°æœåŠ¡ç«¯çš„é…ç½®æ–‡ä»¶ï¼›sshd_config ä¸ºæœåŠ¡ç«¯çš„é…ç½®ã€‚

**Kali/Manjaro**

å®‰è£…å®Œæ¯•åä¼šè‡ªåŠ¨å¯åŠ¨,ä½†æ˜¯æ²¡æœ‰é…ç½®é…ç½®æ–‡ä»¶ä¼šæ— æ³•ç™»é™†,ä¿®æ”¹ä¸‹é…ç½®æ–‡ä»¶
```vim
echo "PermitRootLogin yes" >> /etc/ssh/sshd_config
echo "PasswordAuthentication yes" >> /etc/ssh/sshd_config
```
```bash
systemctl start ssh     # å¯åŠ¨ssh
systemctl enable ssh    # è®¾ç½®ä¸ºå¼€æœºè‡ªå¯

# æˆ–

/etc/init.d/ssh start   # å¯åŠ¨ssh
update-rc.d ssh enable  # è®¾ç½®ä¸ºå¼€æœºè‡ªå¯
```
è‹¥åœ¨ä½¿ç”¨å·¥å…·ç™»å½•æ—¶,å½“è¾“å®Œç”¨æˆ·åå¯†ç åæç¤º SSH æœåŠ¡å™¨æ‹’ç»äº†å¯†ç ,å°±å†è¯•ä¸€é.

è¿™æ—¶ä¸è¦ç€æ€¥,åªéœ€è¦åœ¨ Kali æ§åˆ¶ç«¯å£é‡æ–°ç”Ÿæˆä¸¤ä¸ªç§˜é’¥å³å¯.
```bash
ssh-keygen -t dsa -f /etc/ssh/ssh_host_dsa_key
ssh-keygen -t dsa -f /etc/ssh/ssh_host_rsa_key
```

**Ubuntu**

å¦‚æœæ²¡æœ‰å°±è£…ä¸€ä¸‹,å¦‚æœä½ åªæ˜¯æƒ³ç™»é™†åˆ«çš„æœºå™¨çš„ SSH åªéœ€è¦å®‰è£… openssh-client (ubuntu æœ‰é»˜è®¤å®‰è£…,å¦‚æœæ²¡æœ‰åˆ™ `sudo apt install openssh-client`) ,å¦‚æœè¦ä½¿æœ¬æœºå¼€æ”¾ SSH æœåŠ¡å°±éœ€è¦å®‰è£… openssh-server
```bash
apt install openssh-client=1:7.2p2-4ubuntu2.8
apt install openssh-server=1:7.2p2-4ubuntu2.8
apt install ssh
```
```bash
service ssh restart     # å¯åŠ¨ssh
systemctl enable ssh    # è®¾ç½®ä¸ºå¼€æœºè‡ªå¯
```

é…ç½®å…è®¸ root è¿œç¨‹ç™»å½•
```vim
echo "PermitRootLogin yes" >> /etc/ssh/sshd_config
echo "PasswordAuthentication yes" >> /etc/ssh/sshd_config
```

**Debian**
```
apt install openssh-client=1:7.9p1-10+deb10u1
apt install openssh-server=1:7.9p1-10+deb10u1
apt install ssh
```
```bash
service ssh restart
systemctl enable ssh
```

é…ç½®å…è®¸ root è¿œç¨‹ç™»å½•
```vim
echo "PermitRootLogin yes" >> /etc/ssh/sshd_config
echo "PasswordAuthentication yes" >> /etc/ssh/sshd_config
```

**åŠ å›º**

æœ¬éƒ¨åˆ†å†…å®¹ç§»æ­¥[Secure-Linux](./Secure-Linux#SSH) SSH éƒ¨åˆ†

**æ’é”™**

0. å…ˆæ’æŸ¥æ˜¯ä¸æ˜¯å®¢æˆ·ç«¯(è‡ªå·±)çš„é—®é¢˜,å†æ’æŸ¥æ˜¯ä¸æ˜¯æœåŠ¡ç«¯(å¯¹é¢)çš„é—®é¢˜,æœ€ååœ¨æ’æŸ¥æ˜¯ä¸æ˜¯ä¼ è¾“ä¸­(ä¸­é—´)çš„é—®é¢˜.
1. ping è¯•è¯•,å¦‚æœç½‘ç»œå±‚å¯é€š,é‚£ä¹ˆå¤§æ¦‚ç‡æ˜¯åº”ç”¨å±‚çš„é—®é¢˜,æ£€æŸ¥ SSH é…ç½®,æ˜¯å¦æœ‰ç™½åå•é™åˆ¶,æˆ–è€…ä½ ä»–å¨˜çš„æ„å¤§åˆ©é˜²ç«å¢™æˆ– selinux å°±æ²¡æ”¾è¡Œ
2. å‡è®¾è¿™ä¹ˆä¸€ç§æƒ…å†µ,åº”ç”¨å±‚é…ç½®æ­£å¸¸,ä¸»æœºä¸€åˆ‡æ­£å¸¸,ä½†è·¯ç”±å™¨/äº¤æ¢æœºåœ¨ ACL ä¸Šç¦ç”¨äº† SSH çš„æµé‡,è¿™æ ·å°±æ˜¯ä¼ è¾“å±‚çš„é—®é¢˜äº†.å†…ç½‘ IPS/IDS é˜»æ–­åŒç†.
4. éº»çƒ¦ä½ çœ‹ä¸‹è´¦å·å¯†ç æ˜¯ä¸æ˜¯å†™é”™äº†è°¢è°¢.æˆ–è€…æ˜¯ä¸æ˜¯é™åˆ¶åªä½¿ç”¨å¯†é’¥ç™»é™†çš„.
5. æ³¨æ„ä¸‹æ˜¯ä¸æ˜¯é…ç½®æ–‡ä»¶æˆ–æœåŠ¡çœ‹é”™äº†æ˜¯ sshd ä¸æ˜¯ ssh

**motd**
- [Mithrilwoodrat/FBI-WARNING-in-console](https://github.com/Mithrilwoodrat/FBI-WARNING-in-console)
- [abcfy2/motd](https://github.com/abcfy2/motd)
- `vim /etc/motd`

```
                   _ooOoo_
                  o8888888o
                  88" . "88
                  (| -_- |)
                  O\  =  /O
               ____/`---'\____
             .'  \\|     |//  `.
            /  \\|||  :  |||//  \
           /  _||||| -:- |||||-  \
           |   | \\\  -  /// |   |
           | \_|  ''\---/''  |   |
           \  .-\__  `-`  ___/-. /
         ___`. .'  /--.--\  `. . __
      ."" '<  `.___\_<|>_/___.'  >'"".
     | | :  `- \`.;`\ _ /`;.`/ - ` : | |
     \  \ `-.   \_ __\ /__ _/   .-` /  /
======`-.____`-.___\_____/___.-`____.-'======
                   `=---='

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ä½›ç¥–ä¿ä½‘       æ°¸ä¸æ­»æœº
           å¿ƒå¤–æ— æ³•       æ³•å¤–æ— å¿ƒ
```
```
  _      `-._     `-.     `.   \      :      /   .'     .-'     _.-'      _
   `--._     `-._    `-.    `.  `.    :    .'  .'    .-'    _.-'     _.--'
        `--._    `-._   `-.   `.  \   :   /  .'   .-'   _.-'    _.--'
  `--.__     `--._   `-._  `-.  `. `. : .' .'  .-'  _.-'   _.--'     __.--'
  __    `--.__    `--._  `-._ `-. `. \:/ .' .-' _.-'  _.--'    __.--'    __
    `--..__   `--.__   `--._ `-._`-.`_=_'.-'_.-' _.--'   __.--'   __..--'
  --..__   `--..__  `--.__  `--._`-q(-_-)p-'_.--'  __.--'  __..--'   __..--
        ``--..__  `--..__ `--.__ `-'_) (_`-' __.--' __..--'  __..--''
  ...___        ``--..__ `--..__`--/__/  \--'__..--' __..--''        ___...
        ```---...___    ``--..__`_(<_   _/)_'__..--''    ___...---'''
  ```-----....._____```---...___(__\_\_|_)/__)___...---'''_____.....-----'''
```
```
         .-.                     .-.
      .--' /                     \ '--.
      '--. \       _______       / .--'
          \ \   .-"       "-.   / /
           \ \ /             \ / /
            \ /               \ /
             \|   .--. .--.   |/
              | )/   | |   \( |
              |/ \__/   \__/ \|
              /      /^\      \
              \__    '='    __/
                |\         /|
                |\'"VUUUV"'/|
                \ `"""""""` /
                 `-._____.-'
                   / / \ \
                  / /   \ \
                 / /     \ \
              ,-' (       ) `-.
              `-'._)     (__._.)
```

---

## ttyd

> ç”¨äºåœ¨ web ä¸Šè®¿é—®ç»ˆç«¯

**é¡¹ç›®åœ°å€**
- https://github.com/tsl0922/ttyd

**å®‰è£…**
```bash
sudo apt-get install cmake g++ pkg-config git vim-common libwebsockets-dev libjson-c-dev libssl-dev
git clone https://github.com/tsl0922/ttyd.git
cd ttyd && mkdir build && cd build
cmake ..
make && make install
```

**è¿è¡Œ**
```bash
ttyd -p 8080 bash -x
```

ç°åœ¨è®¿é—® http://localhost:8080 å³å¯

---

## vnc4server

> ä¸ºä¸»æœºæä¾› VNC æœåŠ¡

**å®‰è£…**
```bash
apt-get install vnc4server

vncpasswd                                 # è®¾ç½®vncserverå¯†ç 
vncserver :1 -geometry 1024x768 -depth 24 # è®¾ç½®vncè¿æ¥æ—¶çª—å£çš„å¤§å°
netstat -tnl | grep 5901                  # æŸ¥çœ‹vncæ¿€æ´»çŠ¶æ€
```

windows ä½¿ç”¨ tightVNC æµ‹è¯•è¿æ¥,è¿æ¥åœ°å€:<IP>:5901

---

# webæœåŠ¡-ä¸­é—´ä»¶
## ActiveMQ

<p align="center">
    <img src="../../../assets/img/logo/ActiveMQ.png" width="23%">
</p>

> Apache ActiveMQ æ˜¯ Apache è½¯ä»¶åŸºé‡‘ä¼šæ‰€ç ”å‘çš„å¼€æ”¾æºä»£ç æ¶ˆæ¯ä¸­é—´ä»¶;ç”±äº ActiveMQ æ˜¯ä¸€ä¸ªçº¯ Java ç¨‹åº,å› æ­¤åªéœ€è¦æ“ä½œç³»ç»Ÿæ”¯æŒ Java è™šæ‹Ÿæœº,ActiveMQ ä¾¿å¯æ‰§è¡Œ.

**å®˜ç½‘**
- http://activemq.apache.org/

**å®‰è£…**

å®‰è£…ä¾èµ– JDK
```bash
cd /
tar xzf jdk-8u212-linux-x64.tar.gz
```
```vim
vim /etc/profile

export JAVA_HOME=/root/jdk1.8.0_212
export PATH=$PATH:$JAVA_HOME/bin
```
```bash
source /etc/profile
java -version
```

ä¸‹è½½ activemq å‹ç¼©åŒ…,è¿™é‡Œä»¥ 5.14.5 ä¸ºä¾‹
```
wget http://archive.apache.org/dist/activemq/5.14.5/apache-activemq-5.14.5-bin.tar.gz
tar -zxvf apache-activemq-5.14.5-bin.tar.gz
mv apache-activemq-5.14.5 activemq
cd activemq/bin/
./activemq start
ps -ef| grep activemq
```
```
firewall-cmd --zone=public --add-port=8161/tcp --permanent
firewall-cmd --reload
```

è®¿é—® 127.0.0.1:8161   ç”¨æˆ·å:admin å¯†ç :admin

ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯ç¼–è¾‘ conf/jetty-realm.properties å³å¯

---

## Apache

<p align="center">
    <img src="../../../assets/img/logo/apache.svg" width="8%">
</p>

> Apache HTTP Server æ˜¯ Apache è»Ÿé«”åŸºé‡‘æœƒçš„ä¸€å€‹é–‹æ”¾åŸå§‹ç¢¼çš„ç¶²é ä¼ºæœå™¨è»Ÿé«”ï¼Œå¯ä»¥åœ¨å¤§å¤šæ•¸é›»è…¦ä½œæ¥­ç³»çµ±ä¸­é‹è¡Œã€‚ç”±æ–¼å…¶è·¨å¹³å°å’Œå®‰å…¨æ€§ï¼Œè¢«å»£æ³›ä½¿ç”¨ï¼Œæ˜¯æœ€æµè¡Œçš„ Web ä¼ºæœå™¨è»Ÿé«”ä¹‹ä¸€ã€‚

**å®˜ç½‘**
- https://www.apache.org/

**å®‰è£…**
```bash
yum install httpd
yum install mod_ssl openssl
```

**ç®€å•é…ç½®**
```vim
vim /etc/httpd/conf/httpd.conf

DocumentRoot "/var/www/html"
ServerName  xx.xx.xx.xx:80
# è®¾ç½® Web æœåŠ¡å™¨çš„ä¸»æœºåå’Œç›‘å¬ç«¯å£
```

å¯æœåŠ¡
```vim
vim var/www/html/index.html

Hello World!
```
```bash
service httpd restart
firewall-cmd --zone=public --add-service=http --permanent
firewall-cmd --reload
```

æ­¤æ—¶å¯ä»¥è®¿é—® ip/index.html

**è™šæ‹Ÿä¸»æœº**

é…ç½®è™šæ‹Ÿä¸»æœºæ–‡ä»¶
```vim
vim /etc/httpd/conf.d/virthost.conf

<VirtualHost 192.168.1xx.22:80>
	ServerName  www.abc.com
  # è®¾ç½® Web æœåŠ¡å™¨çš„ä¸»æœºåå’Œç›‘å¬ç«¯å£
	DocumentRoot "/data/web_data"
	<Directory "/data/web_data">
		Require all granted
	</Directory>
</VirtualHost>

Listen 192.168.1XX.33:443
<VirtualHost 192.168.1xx.22:443>
	ServerName  www.abc.com
  # è®¾ç½® Web æœåŠ¡å™¨çš„ä¸»æœºåå’Œç›‘å¬ç«¯å£
	DocumentRoot "/data/web_data"

	SSLEngine on
	SSLCertificateFile /etc/httpd/ssl/httpd.crt
	SSLCertificateKeyFile /etc/httpd/ssl/httpd.key

	<Directory "/data/web_data">
		Require all granted
	</Directory>
</VirtualHost>
```
```bash
mkdir -p /data/web_data
echo 'Hello World!' >/data/web_data/index.html

service httpd restart
firewall-cmd --zone=public --add-service=http --permanent
firewall-cmd --reload
```

**ab**

> ab æ˜¯ apache çš„å‹åŠ›æµ‹è¯•å·¥å…·

å®‰è£…
```bash
sudo apt install apache2-utils
yum install httpd-tools
```

**æ›´å¤šé…ç½®æ¡ˆä¾‹**

è§ [apache.md](./å®éªŒ/apache.md)

---

## Caddy

<p align="center">
    <img src="../../../assets/img/logo/Caddy.png" width="30%">
</p>

> Caddy ä¼ºæœå™¨æ˜¯ä¸€å€‹é–‹æºçš„ï¼Œä½¿ç”¨ Golang ç·¨å¯«ï¼Œæ”¯æŒ HTTP/2 çš„ Web æœå‹™ç«¯ã€‚

**å®˜ç½‘**
- https://caddyserver.com/

**å®‰è£… Caddy**
```bash
wget -N --no-check-certificate https://raw.githubusercontent.com/ToyoDAdoubiBackup/doubi/master/caddy_install.sh && chmod +x caddy_install.sh && bash caddy_install.sh
```

**é…ç½®æ–‡ä»¶**
```bash
chown -R root:www-data /usr/local/bin   # è®¾ç½®ç›®å½•æ•°æ®æƒé™
touch /usr/local/caddy/Caddyfile

echo -e ":80 {
	gzip
	root /usr/local/caddy/www/
}" > /usr/local/caddy/Caddyfile

mkdir /usr/local/caddy/www
echo "<h1>first</h1>" >> /usr/local/caddy/www/index.html

/etc/init.d/caddy start
# å¦‚æœå¯åŠ¨å¤±è´¥å¯ä»¥çœ‹ Caddy æ—¥å¿—: tail -f /tmp/caddy.log
```

**åå‘ä»£ç†**

åšä¸€ä¸ª ip è·³è½¬
```bash
echo ":80 {
	gzip
	proxy / http://www.baidu.com
}" > /usr/local/caddy/Caddyfile

/etc/init.d/caddy start
```

**HTTPS**

ä¸ºå·²ç»ç»‘å®šåŸŸåçš„æœåŠ¡å™¨è‡ªåŠ¨ä» Letâ€™s Encrypt ç”Ÿæˆå’Œä¸‹è½½ HTTPS è¯ä¹¦,æ”¯æŒ HTTPS åè®®è®¿é—®,ä½ åªéœ€è¦å°†ç»‘å®šçš„ IP æ¢æˆ åŸŸå å³å¯
```bash
echo -e "xxx.com {
	gzip
    root /usr/local/bin/www
	tls xxxx@xxx.com  #ä½ çš„é‚®ç®±
}" > /usr/local/caddy/Caddyfile

/etc/init.d/caddy start
```

---

## npm&Node

<p align="center">
    <img src="../../../assets/img/logo/npm&Node.png" width="40%">
</p>

> npm æ˜¯ Node.js é è¨­çš„ã€ä»¥ JavaScript ç·¨å¯«çš„è»Ÿé«”å¥—ä»¶ç®¡ç†ç³»çµ±ã€‚

> Node.js æ˜¯èƒ½å¤ åœ¨ä¼ºæœå™¨ç«¯é‹è¡Œ JavaScript çš„é–‹æ”¾åŸå§‹ç¢¼ã€è·¨å¹³å° JavaScript åŸ·è¡Œç’°å¢ƒã€‚

**å®˜ç½‘**
- https://www.npmjs.com/
- https://nodejs.org

**åŒ…ç®¡ç†å™¨æ–¹å¼**
- apt
  ```bash
  curl -sL https://deb.nodesource.com/setup_10.x | sudo bash -  # æ·»åŠ  Node.js PPA
  apt-get install nodejs npm
  ```

- yum
  ```bash
  yum install epel-release
  yum install nodejs npm
  ```

**æºæ–‡ä»¶æ–¹å¼å®‰è£…**

é¦–å…ˆä¸‹è½½ NodeJS çš„äºŒè¿›åˆ¶æ–‡ä»¶,http://nodejs.org/download/ .åœ¨ Linux Binaries (.tar.gz) è¡Œå¤„æ ¹æ®è‡ªå·±ç³»ç»Ÿçš„ä½æ•°é€‰æ‹©
```bash
# è§£å‹åˆ°å½“å‰æ–‡ä»¶å¤¹ä¸‹è¿è¡Œ
tar xvJf node-v12.17.0-linux-x64.tar

è¿›å…¥è§£å‹åçš„ç›®å½• bin ç›®å½•ä¸‹,æ‰§è¡Œ ls ä¼šçœ‹åˆ°ä¸¤ä¸ªæ–‡ä»¶ node,npm. ç„¶åæ‰§è¡Œ ./node -v ,å¦‚æœæ˜¾ç¤ºå‡º ç‰ˆæœ¬å·è¯´æ˜æˆ‘ä»¬ä¸‹è½½çš„ç¨‹åºåŒ…æ˜¯æ²¡æœ‰é—®é¢˜çš„.ä¾æ¬¡è¿è¡Œå¦‚ä¸‹ä¸‰æ¡å‘½ä»¤
cd node-v12.17.0-linux-x64/bin
ls
./node -v
```
å› ä¸º /home/node-v12.17.0-linux-x64/bin è¿™ä¸ªç›®å½•æ˜¯ä¸åœ¨ç¯å¢ƒå˜é‡ä¸­çš„,æ‰€ä»¥åªèƒ½åˆ°è¯¥ç›®å½•ä¸‹æ‰èƒ½ node çš„ç¨‹åº.å¦‚æœåœ¨å…¶ä»–çš„ç›®å½•ä¸‹æ‰§è¡Œ node å‘½ä»¤çš„è¯ ,å¿…é¡»é€šè¿‡ç»å¯¹è·¯å¾„è®¿é—®æ‰å¯ä»¥çš„

å¦‚æœè¦åœ¨ä»»æ„ç›®å½•å¯ä»¥è®¿é—®çš„è¯,éœ€è¦å°† node æ‰€åœ¨çš„ç›®å½•,æ·»åŠ  PATH ç¯å¢ƒå˜é‡é‡Œé¢,æˆ–è€…é€šè¿‡è½¯è¿æ¥çš„å½¢å¼å°† node å’Œ npm é“¾æ¥åˆ°ç³»ç»Ÿé»˜è®¤çš„ PATH ç›®å½•ä¸‹çš„ä¸€ä¸ª
åœ¨ç»ˆç«¯æ‰§è¡Œ echo $PATH å¯ä»¥è·å– PATH å˜é‡åŒ…å«çš„å†…å®¹,ç³»ç»Ÿé»˜è®¤çš„ PATH ç¯å¢ƒå˜é‡åŒ…æ‹¬ /usr/local/bin:/usr/bin:/bin:/usr/local/sbin:/usr/sbin:/sbin: ,å†’å·ä¸ºåˆ†éš”ç¬¦.æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°† node å’Œ npm é“¾æ¥åˆ° /usr/local/bin ç›®å½•ä¸‹å¦‚ä¸‹æ‰§è¡Œ
```bash
ln -s /home/node-v12.17.0-linux-x64/bin/node /usr/local/bin/node
ln -s /home/node-v12.17.0-linux-x64/bin/npm /usr/local/bin/npm
```

**åŠ é€Ÿ**
- [node&js](../../Plan/Misc-Plan.md#node&js)

**å¼ºåˆ¶å®‰è£…**
```bash
npm install --unsafe-perm=true --allow-root
```

**forever**

> forever æ˜¯ä¸€ä¸ªç®€å•çš„å‘½ä»¤å¼ nodejs çš„å®ˆæŠ¤è¿›ç¨‹ï¼Œèƒ½å¤Ÿå¯åŠ¨ï¼Œåœæ­¢ï¼Œé‡å¯ App åº”ç”¨ã€‚forever å®Œå…¨åŸºäºå‘½ä»¤è¡Œæ“ä½œï¼Œåœ¨foreverè¿›ç¨‹ä¹‹ä¸‹ï¼Œåˆ›å»º node çš„å­è¿›ç¨‹ï¼Œé€šè¿‡ monitor ç›‘æ§ node å­è¿›ç¨‹çš„è¿è¡Œæƒ…å†µï¼Œä¸€æ—¦æ–‡ä»¶æ›´æ–°æˆ–è¿›ç¨‹æŒ‚æ‰ï¼Œforever ä¼šè‡ªåŠ¨é‡å¯ node æœåŠ¡å™¨ï¼Œç¡®ä¿åº”ç”¨æ­£å¸¸è¿è¡Œã€‚

```bash
npm install forever -g    # å…¨å±€å®‰è£…
forever start app.js      # å¯åŠ¨
forever stop app.js       # å…³é—­
forever start -l forever.log -o out.log -e err.log app.js # è¾“å‡ºæ—¥å¿—å’Œé”™è¯¯
forever -w app.js         # è‡ªåŠ¨ç›‘æ§æ–‡ä»¶å˜åŒ–ï¼Œæ–‡ä»¶ä¿®æ”¹ä¿å­˜ä¹‹åè‡ªåŠ¨é‡å¯app.js
forever -h                # æŸ¥çœ‹å¸®åŠ©
```

---

## Nexus

<p align="center">
    <img src="../../../assets/img/logo/Nexus.png" width="28%">
</p>

> Nexus æ˜¯ä¸€ç§ Maven ä»“åº“ç®¡ç†è½¯ä»¶ç”¨äºæ­å»ºç§æœ,ç§æœæ˜¯æ¶è®¾åœ¨å±€åŸŸç½‘çš„ä¸€ç§ç‰¹æ®Šçš„è¿œç¨‹ä»“åº“ï¼Œç›®çš„æ˜¯ä»£ç†è¿œç¨‹ä»“åº“åŠéƒ¨ç½²ç¬¬ä¸‰æ–¹æ„ä»¶ã€‚æœ‰äº†ç§æœä¹‹åï¼Œå½“ Maven éœ€è¦ä¸‹è½½æ„ä»¶æ—¶ï¼Œç›´æ¥è¯·æ±‚ç§æœï¼Œç§æœä¸Šå­˜åœ¨åˆ™ä¸‹è½½åˆ°æœ¬åœ°ä»“åº“ï¼›å¦åˆ™ï¼Œç§æœè¯·æ±‚å¤–éƒ¨çš„è¿œç¨‹ä»“åº“ï¼Œå°†æ„ä»¶ä¸‹è½½åˆ°ç§æœï¼Œå†æä¾›ç»™æœ¬åœ°ä»“åº“ä¸‹è½½ã€‚

**å®˜ç½‘**
- https://www.sonatype.com/nexus-repository-oss

**å®‰è£…**
- **JDK**
    ```bash
    tar xzf jdk-8u212-linux-x64.tar.gz
    ```
    ```vim
    vim /etc/profile

    export JAVA_HOME=/root/jdk1.8.0_212
    export PATH=$PATH:$JAVA_HOME/bin
    ```
    ```bash
    source /etc/profile
    java -version
    ```

- **Maven**
    ```bash
    tar xzf apache-maven-3.6.2-bin.tar.gz
    ```
    ```vim
    vim /etc/profile

    export MAVEN_HOME=/root/apache-maven-3.6.2
    export PATH=$PATH:$MAVEN_HOME/bin
    ```
    ```bash
    source /etc/profile
    mvn -version
    ```

- **Nexus**
    - åœ¨å®˜ç½‘ä¸‹è½½ UNIX å®‰è£…åŒ…,ä¸Šä¼ è‡³æœåŠ¡å™¨,è¿™é‡Œä»¥ https://help.sonatype.com/repomanager2/download#Download-NexusRepositoryManager2OSS 2.14.14-01 ä¸ºä¾‹

    ```bash
    tar -xf nexus-2.14.14-01-bundle.tar.gz -C /usr/local
    cd /usr/local/nexus-2.14.14-01/bin/
    export RUN_AS_USER=root

    ./nexus start
    firewall-cmd --add-port=8081/tcp --permanent
    firewall-cmd --reload
    ```
    ```bash
    curl http://127.0.0.1:8081/nexus/
    ```
    é»˜è®¤ç™»å½•è´¦å·/å¯†ç ä¸º: admin/admin123

---

## Nginx

<p align="center">
    <img src="../../../assets/img/logo/nginx.svg" width="20%">
</p>

> Nginx æ˜¯éåŒæ­¥æ¡†æ¶çš„ç¶²é ä¼ºæœå™¨ï¼Œä¹Ÿå¯ä»¥ç”¨ä½œåå‘ä»£ç†ã€è² è¼‰å¹³è¡¡å™¨å’Œ HTTP ç¼“å­˜ã€‚

**å®˜ç½‘**
- https://nginx.org/

**å®‰è£…**
- **yum å®‰è£…**
  ```bash
  yum install nginx
  systemctl start nginx.service
  ```

- **Debian & Ubuntu å®‰è£…**
  ```bash
  apt update
  apt-get -y install nginx
  ```

- **æºä»£ç ç¼–è¯‘å®‰è£…**

  è‡ªå·±ä¸‹è½½å¥½åŒ… https://nginx.org/en/download.html,ä¼ åˆ°æœåŠ¡å™¨ä¸Š,è¿™é‡Œä»¥1.14.2 ä¸¾ä¾‹

  ```bash
  tar -zxvf nginx-1.14.2.tar.gz
  cd nginx-1.14.2/
  ./configure
  make
  make install
  cd /usr/local/nginx/sbin
  ./nginx
  ```

  æ³¨:æºä»£ç å®‰è£…ä½ çš„é»˜è®¤ç›®å½•åœ¨ /usr/local/nginx ä¸‹,é…ç½®æ–‡ä»¶åœ¨ conf/ ä¸­,ä¸è¦æé”™äº†

**è™šæ‹Ÿä¸»æœº**

åœ¨ /etc/nginx/conf.d/ ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªç«™ç‚¹çš„é…ç½®æ–‡ä»¶,åˆ—å¦‚:test.com.conf
```vim
vim /etc/nginx/conf.d/test.com.conf

server {
        listen 80;
        server_name www.test.com test.com;
        root /usr/share/nginx/test.com;
        index index.html;

        location / {
        }
}
```
`nginx -t ` æ£€æµ‹æ–‡ä»¶æ˜¯å¦æœ‰è¯¯

```bash
mkdir /usr/share/nginx/test.com
echo "hello world!" > /usr/share/nginx/test.com/index.html
firewall-cmd --permanent --zone=public --add-service=http
firewall-cmd --reload
systemctl start nginx.service
```

å¦‚æœæœåŠ¡å™¨ç½‘å€æ²¡æœ‰æ³¨å†Œ,é‚£ä¹ˆå¯ä»¥åœ¨æœ¬æœºç”µè„‘çš„ /etc/hosts æ·»åŠ è®¾ç½®: `192.168.1.112   www.test.com test.com`

æœ¬åœ° curl è®¿é—®æµ‹è¯• `curl www.test.com`

**æŸ¥çœ‹æŠ¥é”™**
```
less /var/log/nginx/error.log
```

**æ›´å¤šé…ç½®æ¡ˆä¾‹**

è§ [Nginx.md](./å®éªŒ/Nginx.md)

---

## phpMyAdmin

<p align="center">
    <img src="../../../assets/img/logo/phpMyAdmin.png" width="30%">
</p>

**å®˜ç½‘**
- https://www.phpmyadmin.net/

`å»ºè®®æ­é…ä¸Šé¢çš„ nginx+php æ‰©å±•ç¬”è®°`

**åˆ›å»ºæ•°æ®åº“å’Œä¸€ä¸ªç”¨æˆ·**
```bash
yum install mariadb mariadb-server
systemctl start mariadb
systemctl enable mariadb
mysql_secure_installation

mysql -u root -p

# åˆ›å»ºä¸€ä¸ªä¸“ç»™ WordPress å­˜æ•°æ®çš„æ•°æ®åº“
MariaDB [(none)]> create database idiota_info;  # æœ€åçš„"idiota_info"ä¸ºæ•°æ®åº“å

# åˆ›å»ºç”¨äº WordPress å¯¹åº”ç”¨æˆ·
MariaDB [(none)]> create user idiota@localhost identified by 'password';  # "idiota"å¯¹åº”åˆ›å»ºçš„ç”¨æˆ·,"password"å†…å¡«å†™ç”¨æˆ·çš„å¯†ç 

# åˆ†åˆ«é…ç½®æœ¬åœ°ç™»å½•å’Œè¿œç¨‹ç™»å½•æƒé™
MariaDB [(none)]> grant all privileges on idiota_info.* to idiota@'localhost' identified by 'password';
MariaDB [(none)]> grant all privileges on idiota_info.* to idiota@'%' identified by 'password';

# åˆ·æ–°æƒé™
MariaDB [(none)]> flush privileges;
```

**ä¸‹è½½**
```bash
wget https://files.phpmyadmin.net/phpMyAdmin/4.8.5/phpMyAdmin-4.8.5-all-languages.zip
unzip phpMyAdmin-4.8.5-all-languages.zip
mv phpMyAdmin-4.8.5-all-languages phpMyAdmin
cp phpMyAdmin /usr/share/nginx/test.com/
cd /usr/share/nginx/test.com/phpMyAdmin

cp config.sample.inc.php config.inc.php

systemctl restart nginx
```

è®¿é—® `https://www.test.com/phpMyAdmin/index.php`

---

## RabbitMQ

<p align="center">
    <img src="../../../assets/img/logo/rabbitmq.svg" width="10%">
</p>

> RabbitMQ æ˜¯æµè¡Œçš„å¼€æºæ¶ˆæ¯é˜Ÿåˆ—ç³»ç»Ÿ,æ˜¯ AMQP(Advanced Message Queuing Protocol é«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®®)çš„æ ‡å‡†å®ç°,ç”¨ erlang è¯­è¨€å¼€å‘.RabbitMQ æ®è¯´å…·æœ‰è‰¯å¥½çš„æ€§èƒ½å’Œæ—¶æ•ˆæ€§,åŒæ—¶è¿˜èƒ½å¤Ÿéå¸¸å¥½çš„æ”¯æŒé›†ç¾¤å’Œè´Ÿè½½éƒ¨ç½²,éå¸¸é€‚åˆåœ¨è¾ƒå¤§è§„æ¨¡çš„åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ä½¿ç”¨.

**å®˜ç½‘**
- https://www.rabbitmq.com/

**å®‰è£…**

å¿…é¡»è¦æœ‰ Erlang ç¯å¢ƒæ”¯æŒ,ä¸‹è½½ erlang è½¯ä»¶åŒ…,è¿™é‡Œä»¥ erlang-19.0.4 ä¸ºä¾‹
```bash
wget http://www.rabbitmq.com/releases/erlang/erlang-19.0.4-1.el7.centos.x86_64.rpm
rpm -ivh erlang-19.0.4-1.el7.centos.x86_64.rpm
```
å®‰è£…å®Œåè¾“å…¥ erl æµ‹è¯•

å®‰è£… rabbitmq,è¿™é‡Œä»¥ v3.6.10 ä¸ºä¾‹
```bash
yum install -y socat
wget  http://www.rabbitmq.com/releases/rabbitmq-server/v3.6.10/rabbitmq-server-3.6.10-1.el7.noarch.rpm
rpm -ivh rabbitmq-server-3.6.10-1.el7.noarch.rpm
```

`æ³¨æ„:å¦‚æœæ˜¯é‡è£…è¯·è®°å¾—åˆ é™¤ /var/lib/rabbitmq ç›®å½•å’Œ /etc/rabbitmq ç›®å½•,å¦åˆ™å¯èƒ½æœåŠ¡ä¼šèµ·ä¸æ¥`

```bash
systemctl start rabbitmq-server
æˆ–
rabbitmq-server -detached   # å¯åŠ¨rabbitmq,-detached ä»£è¡¨åå°å®ˆæŠ¤è¿›ç¨‹æ–¹å¼å¯åŠ¨

rabbitmqctl status
```

**é…ç½®ç½‘é¡µæ’ä»¶**
```bash
# é¦–å…ˆåˆ›å»ºç›®å½•,å¦åˆ™å¯èƒ½æŠ¥é”™:
mkdir /etc/rabbitmq

# ç„¶åå¯ç”¨æ’ä»¶:
rabbitmq-plugins enable rabbitmq_management

# é…ç½®é˜²ç«å¢™
firewall-cmd --permanent --add-port=15672/tcp
firewall-cmd --permanent --add-port=5672/tcp
firewall-cmd --reload
```

è®¿é—®: 127.0.0.1:15672,è¿™ä¸ªæ—¶å€™æ˜¯æ²¡æœ‰è´¦å·å¯†ç çš„!

**é…ç½® web ç«¯è®¿é—®è´¦å·å¯†ç å’Œæƒé™**

é»˜è®¤ç½‘é¡µæ˜¯ä¸å…è®¸è®¿é—®çš„,éœ€è¦å¢åŠ ä¸€ä¸ªç”¨æˆ·ä¿®æ”¹ä¸€ä¸‹æƒé™,ä»£ç å¦‚ä¸‹:
```bash
## æ·»åŠ ç”¨æˆ·,åé¢ä¸¤ä¸ªå‚æ•°åˆ†åˆ«æ˜¯ç”¨æˆ·åå’Œå¯†ç 
rabbitmqctl add_user <è´¦å·> <å¯†ç >
rabbitmqctl set_permissions -p / <è´¦å·> ".*" ".*" ".*"  # æ·»åŠ æƒé™
rabbitmqctl set_user_tags <è´¦å·> administrator          # ä¿®æ”¹ç”¨æˆ·è§’è‰²
```

**å¼€å¯ç”¨æˆ·è¿œç¨‹è®¿é—®**

é»˜è®¤æƒ…å†µä¸‹,RabbitMQ çš„é»˜è®¤çš„ guest ç”¨æˆ·åªå…è®¸æœ¬æœºè®¿é—®, å¦‚æœæƒ³è®© guest ç”¨æˆ·èƒ½å¤Ÿè¿œç¨‹è®¿é—®çš„è¯,åªéœ€è¦å°†é…ç½®æ–‡ä»¶ä¸­çš„ loopback_users åˆ—è¡¨ç½®ä¸ºç©ºå³å¯,
å¦‚ä¸‹:
```
{loopback_users, []}
```

å¦å¤–å…³äºæ–°æ·»åŠ çš„ç”¨æˆ·,ç›´æ¥å°±å¯ä»¥ä»è¿œç¨‹è®¿é—®çš„,å¦‚æœæƒ³è®©æ–°æ·»åŠ çš„ç”¨æˆ·åªèƒ½æœ¬åœ°è®¿é—®,å¯ä»¥å°†ç”¨æˆ·åæ·»åŠ åˆ°ä¸Šé¢çš„åˆ—è¡¨, å¦‚åªå…è®¸ admin ç”¨æˆ·æœ¬æœºè®¿é—®.
```
{loopback_users, ["admin"]}
```

---


## searx

<p align="center">
    <img src="../../../assets/img/logo/searx.png" width="20%">
</p>

> å°Šé‡éšç§,å¯æ§çš„å…ƒæœç´¢å¼•æ“.

**é¡¹ç›®åœ°å€**
- https://github.com/asciimoo/searx

**å®‰è£…æ­å»º**

æ³¨:æœ¬æ¬¡åœ¨ Debian/Ubuntu ä¸‹æ­å»º,centos ä¸‹åŸºæœ¬ä¸€è‡´,è¯·å‚è€ƒ [å®˜æ–¹æ•™ç¨‹](https://github.com/asciimoo/searx/wiki/Installation-on-RHEL-7---CentOS-7)

åŠ æº,å®‰è£…ä¾èµ–
```
sudo add-apt-repository universe
sudo apt-get update

sudo apt-get install git build-essential libxslt-dev python-dev python-virtualenv python-babel zlib1g-dev libffi-dev libssl-dev vim lrzsz unzip
```

å®‰è£… searx
```bash
cd /usr/local
sudo git clone https://github.com/asciimoo/searx.git
sudo useradd searx -d /usr/local/searx
sudo chown searx:searx -R /usr/local/searx
```

æµ‹è¯• python è™šæ‹Ÿç¯å¢ƒ
```bash
sudo -u searx -i
cd /usr/local/searx
virtualenv searx-ve
. ./searx-ve/bin/activate
./manage.sh update_packages
```

ä¸€äº›å®‰å…¨æ€§é…ç½®
```bash
sed -i -e "s/ultrasecretkey/`openssl rand -hex 16`/g" searx/settings.yml
sed -i -e "s/debug : True/debug : False/g" searx/settings.yml
```

```bash
sudo apt-get install -y uwsgi uwsgi-plugin-python
```
```vim
vim /etc/uwsgi/apps-available/searx.ini

[uwsgi]
# Who will run the code
uid = searx
gid = searx

# disable logging for privacy
disable-logging = true

# Number of workers (usually CPU count)
workers = 4

# The right granted on the created socket
chmod-socket = 666

# Plugin to use and interpretor config
single-interpreter = true
master = true
plugin = python
lazy-apps = true
enable-threads = true

# Module to import
module = searx.webapp

# Virtualenv and python path
virtualenv = /usr/local/searx/searx-ve/
pythonpath = /usr/local/searx/
chdir = /usr/local/searx/searx/
```
```bash
cd /etc/uwsgi/apps-enabled
ln -s ../apps-available/searx.ini
/etc/init.d/uwsgi restart
```

é…ç½® nginx ä»£ç†
```bash
sudo apt-get install -y nginx
```
```vim
vim /etc/nginx/sites-available/searx

server {
    listen 80;
    server_name www.ä½ çš„åŸŸå.com;
    root /usr/local/searx;

    location / {
            include uwsgi_params;
            uwsgi_pass unix:/run/uwsgi/app/searx/socket;
    }
}
```
```bash
sudo ln -s /etc/nginx/sites-available/searx /etc/nginx/sites-enabled/searx
sudo service nginx restart
sudo service uwsgi restart
```

ç°åœ¨è®¿é—® www.ä½ çš„åŸŸå.com æŸ¥çœ‹ä½ çš„æœç´¢å¼•æ“æœåŠ¡æŠŠ~

**Tips**

æœç´¢å¼•æ“è®¾ç½®åœ¨ settings_et_dev.yml æ–‡ä»¶ä¸­

å»ºè®®åˆ é™¤æˆ–ä¸ä½¿ç”¨çš„æœç´¢æ¥å£(ç”±äºå¯¹è¯·æ±‚é€Ÿåº¦çš„å½±å“å®åœ¨å¤ªå¤§,å¹¶ä¸”ç»å¸¸æŠ½é£æŠ¥é”™)
- archive is
- wikipedia
- wikidata
- faroo
- library genesis
- reddit
- startpage
- mymemory translated

æœç´¢ç»“æœå®šå‘,ä¸é€‚åˆæ—¥å¸¸ä½¿ç”¨
- etymonline
- gigablast
- duden
- seznam
- erowid

---

## Tomcat

<p align="center">
    <img src="../../../assets/img/logo/tomcat.svg" width="15%">
</p>

> Tomcat ç±»ä¼¼ä¸ä¸€ä¸ª apache çš„æ‰©å±•å‹,å±äº apache è½¯ä»¶åŸºé‡‘ä¼šçš„æ ¸å¿ƒé¡¹ç›®,å±äºå¼€æºçš„è½»é‡çº§ Web åº”ç”¨æœåŠ¡å™¨,æ˜¯å¼€å‘å’Œè°ƒè¯• JSP ç¨‹åºçš„é¦–é€‰,ä¸»è¦é’ˆå¯¹ Jave è¯­è¨€å¼€å‘çš„ç½‘é¡µä»£ç è¿›è¡Œè§£æ,Tomcat è™½ç„¶å’Œ Apache æˆ–è€… Nginx è¿™äº› Web æœåŠ¡å™¨ä¸€æ ·,å…·æœ‰å¤„ç† HTML é¡µé¢çš„åŠŸèƒ½,ç„¶è€Œç”±äºå…¶å¤„ç†é™æ€ HTML çš„èƒ½åŠ›è¿œä¸åŠ Apache æˆ–è€… Nginx,æ‰€ä»¥ Tomcat é€šå¸¸åšä¸ºä¸€ä¸ª Servlet å’Œ JSP å®¹å™¨å•ç‹¬è¿è¡Œåœ¨åç«¯.å¯ä»¥è¿™æ ·è®¤ä¸º,å½“é…ç½®æ­£ç¡®æ—¶,Apache ä¸º HTML é¡µé¢æœåŠ¡,è€Œ Tomcat å®é™…ä¸Šè¿è¡Œ JSP é¡µé¢å’Œ Servlet.æ¯”å¦‚ apache å¯ä»¥é€šè¿‡ cgi æ¥å£ç›´æ¥è°ƒå– Tomcat ä¸­çš„ç¨‹åº.

**å®˜ç½‘**
- https://tomcat.apache.org

**Tomcat è§’è‰²åˆ’åˆ†**
- manager-guiï¼šå…è®¸è®¿é—® Manager APP é¡µé¢å’Œ Server Status
- manager-scriptï¼šå…è®¸è®¿é—®çº¯æ–‡æœ¬æ¥å£å’Œ Server Status
- manager-jmxï¼šå…è®¸è®¿é—® JMX ä»£ç†æ¥å£å’Œ Server Status
- manager-statusï¼šä»…å…è®¸è®¿é—® Server Status é¡µé¢(å³ URL è·¯å¾„ä¸º /manager/status/*)
- admin-guiï¼š å…è®¸è®¿é—® Host Managerï¼ŒGUI ç•Œé¢(å³ URL è·¯å¾„ä¸º /host-manager/html)
- admin-scriptï¼šå…è®¸è®¿é—® Host Managerï¼Œæ–‡æœ¬æ¥å£ï¼Œ(å³ URL è·¯å¾„ä¸º /host-manager/text)

**Tomcat manager æ¥å£**
- Server Status : æŸ¥çœ‹æœåŠ¡å™¨çŠ¶æ€ï¼ŒåŒ…æ‹¬ä¸­é—´ä»¶åŠæ“ä½œç³»ç»Ÿç›¸å…³ä¿¡æ¯
- Manager App : ç®¡ç†æœåŠ¡å™¨ä¸Šéƒ¨ç½²çš„åº”ç”¨(Application),å¦‚å°† WAR file æ–‡ä»¶éƒ¨ç½²åˆ° tomcat ä¸­ï¼Œè¿˜å¯ä»¥å¯ç”¨æˆ–åœæ­¢é¡¹ç›®
- Host Manager : ç®¡ç†ç‰©ç†ä¸»æœºå’Œè™šæ‹Ÿä¸»æœºï¼Œå¯å¢åŠ ã€åˆ é™¤è™šæ‹Ÿä¸»æœºï¼Œé»˜è®¤æœªå®‰è£…ï¼Œè¦è®¿é—® host manager éœ€è¦åœ¨å®‰è£…é¡µé¢å‹¾é€‰

**éƒ¨åˆ†æ–‡ä»¶ä»‹ç»**
- content.xmlï¼šTomcat é»˜è®¤çš„æ•°æ®æºåœ¨è¿™é‡Œé…ç½®ï¼Œä¸€èˆ¬å­˜æ”¾è¿æ¥æ•°æ®åº“çš„ä¿¡æ¯ï¼›
- server.xmlï¼šTomcat è®¿é—®ç«¯å£ã€åŸŸåç»‘å®šå’Œæ•°æ®æºåœ¨è¿™é‡Œé…ç½®ï¼›
- web.xmlï¼šTomcat é¡¹ç›®åˆå§‹åŒ–ä¼šå»è°ƒç”¨çš„æ–‡ä»¶ï¼›

**å®‰è£…**

Tomcat ä¾èµ– JDK,åœ¨å®‰è£… Tomcat ä¹‹å‰éœ€è¦å…ˆå®‰è£… Java JDK.è¾“å…¥å‘½ä»¤ java -version,å¦‚æœæ˜¾ç¤º JDK ç‰ˆæœ¬,è¯æ˜å·²ç»å®‰è£…äº† JDK

JDK å®‰è£…è¿‡ç¨‹ è§ [å¦‚ä¸‹](##JDK)

ä¸‹è½½ Tomcat å®‰è£…åŒ… https://tomcat.apache.org/download-80.cgi å°†å®‰è£…åŒ…ä¸Šä¼ è‡³æœåŠ¡å™¨,æˆ‘è¿™é‡Œä»¥ 8.5.46 ä¸ºä¾‹
```bash
tar -zvxf apache-tomcat-8.5.46.tar.gz
cd apache-tomcat-8.5.46
cd bin
./startup.sh
```

å¦‚æœè®¿é—® http://ip:8080/ å¤±è´¥,æŸ¥çœ‹é˜²ç«å¢™å¼€æ”¾ç«¯å£
```bash
firewall-cmd --permanent --zone=public --add-port=8080/tcp
firewall-cmd --reload
```

**è®¾ç½® tomcat çš„æœåŠ¡å™¨å¯åŠ¨å’Œå…³é—­**

```vim
vim /etc/rc.d/init.d/tomcat

#!/bin/bash
# /etc/rc.d/init.d/tomcat
# init script for tomcat precesses
# processname: tomcat
# description: tomcat is a j2se server
# chkconfig: 2345 86 16
# description: Start up the Tomcat servlet engine.

if [ -f /etc/init.d/functions ]; then
. /etc/init.d/functions
elif [ -f /etc/rc.d/init.d/functions ]; then
. /etc/rc.d/init.d/functions
else
echo -e "\atomcat: unable to locate functions lib. Cannot continue."
exit -1
fi
RETVAL=$?
CATALINA_HOME="/usr/local/root/tomcat"  # tomcat å®‰è£…ç›®å½•,ä½ å®‰è£…åœ¨ä»€ä¹ˆç›®å½•ä¸‹å°±å¤åˆ¶ä»€ä¹ˆç›®å½•
case "$1" in
start)
if [ -f $CATALINA_HOME/bin/startup.sh ];
then
echo $"Starting Tomcat"
$CATALINA_HOME/bin/startup.sh
fi
;;
stop)
if [ -f $CATALINA_HOME/bin/shutdown.sh ];
then
echo $"Stopping Tomcat"
$CATALINA_HOME/bin/shutdown.sh
fi
;;
*)
echo $"Usage: $0 {start|stop}"
exit 1
;;
esac
exit $RETVAL
```
```bash
chmod 755 /etc/rc.d/init.d/tomcat
chkconfig --add /etc/rc.d/init.d/tomcat
```

ä»¥ä¸Šæ‰€æœ‰å·¥ä½œé¡ºåˆ©è¿›è¡Œå¹¶ä¸”æ²¡æœ‰æŠ¥é”™,åˆ™é…ç½®å®Œæˆ,ä½ å¯ä»¥è¾“å…¥å‘½ä»¤ `service tomcat start` å’Œ `service tomcat stop` è¿›è¡ŒéªŒè¯

**ä¿®æ”¹ç«¯å£å·**

è¿›å…¥ tomcat çš„ conf ç›®å½•ä¸‹,ä¿®æ”¹ server.xml æ–‡ä»¶,å¯ä»¥ä¿®æ”¹ç«¯å£,é»˜è®¤ 8080

**è®¾ç½®ç”¨æˆ·åå’Œå¯†ç ç™»å½•**

ä¿®æ”¹ conf ç›®å½•ä¸‹ tomcat-users.xml (éƒ¨åˆ†ç‰ˆæœ¬æ˜¯tomcat-user.xml)
```vim
<role rolename="admin-gui"/>
<role rolename="manager-gui"/>
<role rolename="manager-jmx"/>
<role rolename="manager-script"/>
<role rolename="manager-status"/>
<user username="admin" password="admin" roles="admin-gui,manager-gui,manager-jmx,manager-script,manager-status"/>
```

```bash
service tomcat stop
service tomcat start
```

å¦‚æœçˆ† 403 é”™è¯¯,å°±æ³¨é‡Šæ‰ Tomcat/webapps/manager/META-INF/context.xml æ–‡ä»¶ä¸­å†…å®¹
```xml
<!-- <Valve className="org.apache.catalina.valves.RemoteAddrValve"
         allow="127\.\d+\.\d+\.\d+|::1|0:0:0:0:0:0:0:1" />-->
```

è‡ªè¡Œé‡å¯æœåŠ¡

**å‘å¸ƒæµ‹è¯•**

tomcat é»˜è®¤çš„å‘å¸ƒ web é¡¹ç›®çš„ç›®å½•æ˜¯:webapps

å°†å¯¼å‡ºçš„ war åŒ…ç›´æ¥ä¸Šä¼ åˆ° webapps æ ¹ç›®å½•ä¸‹,éšç€ tomcat çš„å¯åŠ¨,war åŒ…å¯ä»¥è‡ªåŠ¨è¢«è§£æ.

ç„¶åè°ƒç”¨è·¯å¾„æŸ¥è¯¢æ˜¯å¦å®‰è£…æˆåŠŸ

---

## Wordpress

<p align="center">
    <img src="../../../assets/img/logo/wordpress.svg" width="30%">
</p>

> WordPress æ˜¯ä¸€ä¸ªå¼€æºçš„å†…å®¹ç®¡ç†ç³»ç»Ÿ(CMS),å…è®¸ç”¨æˆ·æ„å»ºåŠ¨æ€ç½‘ç«™å’Œåšå®¢.

**å®˜ç½‘**
- https://wordpress.org/

**å®‰è£…**

ä¸‹è½½ WordPress å®‰è£…åŒ…å¹¶è§£å‹
```bash
wget https://wordpress.org/latest.tar.gz

tar -xzvf latest.tar.gz
```

åˆ›å»º WordPress æ•°æ®åº“å’Œä¸€ä¸ªç”¨æˆ·
```bash
yum install mariadb mariadb-server
systemctl start mariadb
systemctl enable mariadb
mysql_secure_installation

mysql -u root -p

# åˆ›å»ºä¸€ä¸ªä¸“ç»™ WordPress å­˜æ•°æ®çš„æ•°æ®åº“
MariaDB [(none)]> create database idiota_info; # æœ€åçš„"idiota_info"ä¸ºæ•°æ®åº“å

# åˆ›å»ºç”¨äº WordPress å¯¹åº”ç”¨æˆ·
MariaDB [(none)]> create user idiota@localhost identified by 'password';   # "idiota"å¯¹åº”åˆ›å»ºçš„ç”¨æˆ·,"password"å†…å¡«å†™ç”¨æˆ·çš„å¯†ç 

# åˆ†åˆ«é…ç½®æœ¬åœ°ç™»å½•å’Œè¿œç¨‹ç™»å½•æƒé™
MariaDB [(none)]> grant all privileges on idiota_info.* to idiota@'localhost' identified by 'password';
MariaDB [(none)]> grant all privileges on idiota_info.* to idiota@'%' identified by 'password';

# åˆ·æ–°æƒé™
MariaDB [(none)]> flush privileges;
```

é…ç½® PHP
```bash
# å®‰è£… PHP æº
rpm -ivh https://mirror.webtatic.com/yum/el7/epel-release.rpm
rpm -ivh https://mirror.webtatic.com/yum/el7/webtatic-release.rpm

# å®‰è£… PHP7.0
yum install php70w
yum install php70w-mysql
yum install httpd

# é‡å¯ Apache
systemctl restart httpd

# æŸ¥çœ‹ PHP ç‰ˆæœ¬
php -v
```

è®¾ç½® wp-config.php æ–‡ä»¶
```bash
cd wordpress
vim wp-config-sample.php
```
åœ¨æ ‡æœ‰ `// ** MySQL settings - You can get this info from your web host ** //` ä¸‹è¾“å…¥ä½ çš„æ•°æ®åº“ç›¸å…³ä¿¡æ¯
```
DB_NAME
    åœ¨ç¬¬äºŒæ­¥ä¸­ä¸º WordPress åˆ›å»ºçš„æ•°æ®åº“åç§°
DB_USER
    åœ¨ç¬¬äºŒæ­¥ä¸­åˆ›å»ºçš„ WordPress ç”¨æˆ·å
DB_PASSWORD
    ç¬¬äºŒæ­¥ä¸­ä¸º WordPress ç”¨æˆ·åè®¾å®šçš„å¯†ç 
DB_HOST
    ç¬¬äºŒæ­¥ä¸­è®¾å®šçš„ hostname (é€šå¸¸æ˜¯ localhost,ä½†æ€»æœ‰ä¾‹å¤–;å‚è§ç¼–è¾‘wp-config.php æ–‡ä»¶ä¸­çš„"å¯èƒ½çš„ DB_HOST å€¼) .
DB_CHARSET
    æ•°æ®åº“å­—ç¬¦ä¸²,é€šå¸¸ä¸å¯æ›´æ”¹.
DB_COLLATE
    ç•™ä¸ºç©ºç™½çš„æ•°æ®åº“æ’åº.
```

åœ¨æ ‡æœ‰ `* Authentication Unique Keys.` çš„ç‰ˆå—ä¸‹è¾“å…¥å¯†é’¥çš„å€¼,ä¿å­˜ wp-config.php æ–‡ä»¶,ä¹Ÿå¯ä»¥ä¸ç®¡è¿™ä¸ª

ä¸Šä¼ æ–‡ä»¶

æ¥ä¸‹æ¥éœ€è¦å†³å®šå°†åšå®¢æ”¾åœ¨ç½‘ç«™çš„ä»€ä¹ˆä½ç½®ä¸Š:
- ç½‘ç«™æ ¹ç›®å½•ä¸‹ (å¦‚:http://example.com/)
- ç½‘ç«™å­ç›®å½•ä¸‹ (å¦‚:http://example.com/blog/)

æ ¹ç›®å½•

å¦‚æœéœ€è¦å°†æ–‡ä»¶ä¸Šä¼ åˆ° web æœåŠ¡å™¨,å¯ç”¨ FTP å®¢æˆ·ç«¯å°† wordpress ç›®å½•ä¸‹æ‰€æœ‰å†…å®¹ (æ— éœ€ä¸Šä¼ ç›®å½•æœ¬èº«) ä¸Šä¼ è‡³ç½‘ç«™æ ¹ç›®å½•

å¦‚æœæ–‡ä»¶å·²ç»åœ¨ web æœåŠ¡å™¨ä¸­ä¸”å¸Œæœ›é€šè¿‡ shell è®¿é—®æ¥å®‰è£… wordpress,å¯å°† wordpress ç›®å½•ä¸‹æ‰€æœ‰å†…å®¹ (æ— éœ€è½¬ç§»ç›®å½•æœ¬èº«) è½¬ç§»åˆ°ç½‘ç«™æ ¹ç›®å½•

å­ç›®å½•

å¦‚æœéœ€è¦å°†æ–‡ä»¶ä¸Šä¼ åˆ° web æœåŠ¡å™¨,éœ€å°† wordpress ç›®å½•é‡å‘½å,ä¹‹åç”¨ FTP å®¢æˆ·ç«¯å°†é‡å‘½ååçš„ç›®å½•ä¸Šä¼ åˆ°ç½‘ç«™æ ¹ç›®å½•ä¸‹æŸä¸€ä½ç½®

å¦‚æœæ–‡ä»¶å·²ç»åœ¨ web æœåŠ¡å™¨ä¸­ä¸”å¸Œæœ›é€šè¿‡shellè®¿é—®æ¥å®‰è£… wordpress,å¯å°† wordpress ç›®å½•è½¬ç§»åˆ°ç½‘ç«™æ ¹ç›®å½•ä¸‹æŸä¸€ä½ç½®,ä¹‹åé‡å‘½å wordpress ç›®å½•

```bash
mv wordpress/* /var/www/html

setenforce 0    # å…³é—­ selinux
service httpd start
service firewalld stop
```

è¿è¡Œå®‰è£…è„šæœ¬

- å°† WordPress æ–‡ä»¶æ”¾åœ¨æ ¹ç›®å½•ä¸‹çš„ç”¨æˆ·è¯·è®¿é—®:http://example.com/wp-admin/install.php
- å°† WordPress æ–‡ä»¶æ”¾åœ¨å­ç›®å½• (å‡è®¾å­ç›®å½•åä¸º blog) ä¸‹çš„ç”¨æˆ·è¯·è®¿é—®:http://example.com/blog/wp-admin/install.php
- è®¿é—® `http://xxx.xxx.xxx.xxx/wp-admin/setup-config.php` ä¸‹é¢å°±ç•¥äº†,è‡ªå·±ç…§ç€é¡µé¢ä¸Šæ˜¾ç¤ºçš„æ¥

---

## Mijisou

<p align="center">
    <img src="../../../assets/img/logo/Mijisou.png" width="50%">
</p>

> åŸºäºå¼€æºé¡¹ç›® Searx äºŒæ¬¡å¼€å‘çš„æ“ä½œå¼•æ“

> 2019-11-17:ä¸åœ¨æ¨èè¯¥å¼€æºé¡¹ç›®,å»ºè®®ç›´æ¥ä½¿ç”¨æºé¡¹ç›® [searx](##searx)

**é¡¹ç›®åœ°å€**
- https://github.com/entropage/mijisou

**ä¾èµ–**

è‡ªè¡Œå®‰è£… python3 pip redis

**å®‰è£…**
```bash
systemctl start redis
systemctl enable redis
git clone https://github.com/entropage/mijisou.git
cd mijisou && pip install -r requirements.txt
```

**é…ç½®**
```yml
vim searx/settings_et_dev.yml

general:
    debug : False # Debug mode, only for development
    instance_name : "123æœç´¢" # displayed name

search:
    safe_search : 0 # Filter results. 0: None, 1: Moderate, 2: Strict
    autocomplete : "" # Existing autocomplete backends: "baidu", "dbpedia", "duckduckgo", "google", "startpage", "wikipedia" - leave blank to turn it off by default
    language : "zh-CN"
    ban_time_on_fail : 5 # ban time in seconds after engine errors
    max_ban_time_on_fail : 120 # max ban time in seconds after engine errors

server:
    port : 8888
    bind_address : "0.0.0.0" # address to listen on
    secret_key : "123" # change this!
    base_url : False # Set custom base_url. Possible values: False or "https://your.custom.host/location/"
    image_proxy : False # Proxying image results through searx
    http_protocol_version : "1.0"  # 1.0 and 1.1 are supported

cache:
    cache_server : "127.0.0.1" # redis cache server ip address
    cache_port : 6379 # redis cache server port
    cache_time : 30 # cache 30 s
    cache_type : "redis" # cache type
    cache_db : 0 # we use db 0 in dev env

ui:
    static_path : "" # Custom static path - leave it blank if you didn't change
    templates_path : "" # Custom templates path - leave it blank if you didn't change
    default_theme : entropage # ui theme
    default_locale : "" # Default interface locale - leave blank to detect from browser information or use codes from the 'locales' config section
    theme_args :
        oscar_style : logicodev # default style of oscar

# searx supports result proxification using an external service: https://github.com/asciimoo/morty
# uncomment below section if you have running morty proxy
result_proxy:
    url : ""  #morty proxy service
    key : Your_result_proxy_key
    server_name : ""

outgoing: # communication with search engines
    request_timeout : 2.0 # seconds
    useragent_suffix : "" # suffix of searx_useragent, could contain informations like an email address to the administrator
    pool_connections : 100 # Number of different hosts
    pool_maxsize : 10 # Number of simultaneous requests by host
# uncomment below section if you want to use a proxy
# see http://docs.python-requests.org/en/latest/user/advanced/#proxies
# SOCKS proxies are also supported: see http://docs.python-requests.org/en/master/user/advanced/#socks
#    proxies :
#        http : http://192.168.199.5:24000
#        http : http://192.168.199.5:3128
#        https: http://127.0.0.1:8080
# uncomment below section only if you have more than one network interface
# which can be the source of outgoing search requests
#    source_ips:
#        - 1.1.1.1
#        - 1.1.1.2
    haipproxy_redis:
      #host: 192.168.199.5
      #port: 6379
      #password: kckdkkdkdkddk
      #db: 0

engines:
  - name : duckduckgo
    engine : duckduckgo
    shortcut : ddg

  - name : duckduckgo images
    engine : duckduckgo_images
    shortcut : ddi

  - name : twitter
    engine : twitter
    shortcut : tw

  - name : mojeek
    shortcut: mjk
    engine: xpath
    paging : True
    search_url : https://www.mojeek.com/search?q={query}&s={pageno}
    results_xpath: /html/body//div[@class="results"]/ul[@class="results-standard"]/li
    url_xpath : ./h2/a/@href
    title_xpath : ./h2
    content_xpath : ./p[@class="s"]
    suggestion_xpath : /html/body//div[@class="top-info"]/p[@class="top-info spell"]/a
    first_page_num : 1
    page_size : 10

  - name : torrentz
    engine : torrentz
    shortcut : tor
    url: https://torrentz2.eu/
    timeout : 3.0

  - name : startpage
    engine : startpage
    shortcut : sp
    timeout : 6.0

  - name : baidu
    engine : baidu
    shortcut : bd

  - name : baidu images
    engine : baidu_images
    shortcut : bdi

  - name : baidu videos
    engine : baidu_videos
    shortcut : bdv

  - name : sogou images
    engine : sogou_images
    shortcut : sgi

  - name : sogou videos
    engine : sogou_videos
    shortcut : sgv

  - name : 360 images
    engine : so_images
    shortcut : 360i

  - name : bing
    engine : bing
    shortcut : bi

  - name : bing images
    engine : bing_images
    shortcut : bii

  - name : bing videos
    engine : bing_videos
    shortcut : biv

  - name : bitbucket
    engine : xpath
    paging : True
    search_url : https://bitbucket.org/repo/all/{pageno}?name={query}
    url_xpath : //article[@class="repo-summary"]//a[@class="repo-link"]/@href
    title_xpath : //article[@class="repo-summary"]//a[@class="repo-link"]
    content_xpath : //article[@class="repo-summary"]/p
    categories : it
    timeout : 4.0
    shortcut : bb

  - name : free software directory
    engine : mediawiki
    shortcut : fsd
    categories : it
    base_url : https://directory.fsf.org/
    number_of_results : 5
    search_type : title
    timeout : 5.0

  - name : gentoo
    engine : gentoo
    shortcut : ge

  - name : gitlab
    engine : json_engine
    paging : True
    search_url : https://gitlab.com/api/v4/projects?search={query}&page={pageno}
    url_query : web_url
    title_query : name_with_namespace
    content_query : description
    page_size : 20
    categories : it
    shortcut : gl
    timeout : 10.0

  - name : github
    engine : github
    shortcut : gh

  - name : stackoverflow
    engine : stackoverflow
    shortcut : st

  - name : wikipedia
    engine : wikipedia
    shortcut : wp
    base_url : 'https://en.wikipedia.org/'

locales:
    en : English
    ar : Ø§Ù„Ø¹ÙØ±ÙØ¨ÙÙŠÙÙ‘Ø© (Arabic)
    bg : Ğ‘ÑŠĞ»Ğ³Ğ°Ñ€ÑĞºĞ¸ (Bulgarian)
    cs : ÄŒeÅ¡tina (Czech)
    da : Dansk (Danish)
    de : Deutsch (German)
    el_GR : Î•Î»Î»Î·Î½Î¹ÎºÎ¬ (Greek_Greece)
    eo : Esperanto (Esperanto)
    es : EspaÃ±ol (Spanish)
    fi : Suomi (Finnish)
    fil : Wikang Filipino (Filipino)
    fr : FranÃ§ais (French)
    he : ×¢×‘×¨×™×ª (Hebrew)
    hr : Hrvatski (Croatian)
    hu : Magyar (Hungarian)
    it : Italiano (Italian)
    ja : æ—¥æœ¬èª (Japanese)
    nl : Nederlands (Dutch)
    pl : Polski (Polish)
    pt : PortuguÃªs (Portuguese)
    pt_BR : PortuguÃªs (Portuguese_Brazil)
    ro : RomÃ¢nÄƒ (Romanian)
    ru : Ğ ÑƒÑÑĞºĞ¸Ğ¹ (Russian)
    sk : SlovenÄina (Slovak)
    sl : Slovenski (Slovene)
    sr : ÑÑ€Ğ¿ÑĞºĞ¸ (Serbian)
    sv : Svenska (Swedish)
    tr : TÃ¼rkÃ§e (Turkish)
    uk : ÑƒĞºÑ€Ğ°Ñ—Ğ½ÑÑŒĞºĞ° Ğ¼Ğ¾Ğ²Ğ° (Ukrainian)
    zh : ç®€ä½“ä¸­æ–‡ (Chinese, Simplified)
    zh_TW : ç¹é«”ä¸­æ–‡ (Chinese, Traditional)

doi_resolvers :
  oadoi.org : 'https://oadoi.org/'
  doi.org : 'https://doi.org/'
  doai.io  : 'http://doai.io/'
  sci-hub.tw : 'http://sci-hub.tw/'

default_doi_resolver : 'oadoi.org'

sentry:
  dsn: https://xkdkkdkdkdkdkdkdk@sentry.xxx.com/2
```

**è¿è¡Œ+caddy åä»£**
```bash
mv searx/settings_et_dev.yml searx/settings.yml
gunicorn searx.webapp:app -b 127.0.0.1:8888 -D  # ä¸€å®šè¦åœ¨mijisouç›®å½•ä¸‹è¿è¡Œ

wget -N --no-check-certificate https://raw.githubusercontent.com/ToyoDAdoubiBackup/doubi/master/caddy_install.sh && chmod +x caddy_install.sh && bash caddy_install.sh

echo "www.ä½ çš„åŸŸå.com {
 gzip
 tls xxxx@xxx.com
 proxy / 127.0.0.1:8888
}" >> /usr/local/caddy/Caddyfile

/etc/init.d/caddy start
# å¦‚æœå¯åŠ¨å¤±è´¥å¯ä»¥çœ‹ Caddy æ—¥å¿—:tail -f /tmp/caddy.log
```

**opensearch**
```xml
vim /root/mijisou/searx/templates/__common__/opensearch.xml

<?xml version="1.0" encoding="utf-8"?>
<OpenSearchDescription xmlns="http://a9.com/-/spec/opensearch/1.1/">
  <ShortName>{{ instance_name }}</ShortName>
  <Description>a privacy-respecting, hackable metasearch engine</Description>
  <InputEncoding>UTF-8</InputEncoding>
  <Image>{{ urljoin(host, url_for('static', filename='img/favicon.png')) }}</Image>
   <LongName>searx metasearch</LongName>
  {% if opensearch_method == 'get' %}
     <Url type="text/html" method="get" template="https://www.ä½ çš„åŸŸå.com/?q={searchTerms}"/>
  {% if autocomplete %}
  <Url type="application/x-suggestions+json" method="get" template="{{ host }}autocompleter">
      <Param name="format" value="x-suggestions" />
      <Param name="q" value="{searchTerms}" />
  </Url>
  {% endif %}
  {% else %}
  <Url type="text/html" method="post" template="{{ host }}">
    <Param name="q" value="{searchTerms}" />
  </Url>
  {% if autocomplete %}
  <!-- TODO, POST REQUEST doesn't work -->
  <Url type="application/x-suggestions+json" method="get" template="{{ host }}autocompleter">
  <Param name="format" value="x-suggestions" />
  <Param name="q" value="{searchTerms}" />
  </Url>
  {% endif %}
  {% endif %}
</OpenSearchDescription>
```

**ä¿®æ”¹**

é…ç½®æ–‡ä»¶ä¸­æ”¹ä¸‹åå­— `mijisou/searx/static/themes/entropage/img` ä¸­çš„ logo å›¾æ ‡è‡ªå·±æ¢ä¸€ä¸‹

**ç®¡ç†**
```bash
ps -aux
çœ‹ä¸€ä¸‹å“ªä¸ªæ˜¯ gunicorn è¿›ç¨‹
kill æ€æ‰
gunicorn searx.webapp:app -b 127.0.0.1:8888 -D  # å†æ¬¡å¼ºè°ƒ,åœ¨ /mijisou ç›®å½•ä¸‹è¿è¡Œ
```

**é…åˆ Cloudflare çš„ CDN**
1. Cloudflare åˆ›å»º site
2. åŸŸåå•†æ”¹ nameserver
3. ä¿®æ”¹ Caddy é…ç½®
  ```bash
  echo "www.ä½ çš„åŸŸå.com:80 {
  gzip
  proxy / 127.0.0.1:8888
  }" >> /usr/local/caddy/Caddyfile
  ```

**ç£ç›˜å ç”¨**

æœåŠ¡è¿è¡Œä¸€æ®µæ—¶é—´å, `/var/lib/redis` è·¯å¾„ä¸‹ä¼šæœ‰ä¸€äº›ç¼“å­˜æ–‡ä»¶(è²Œä¼¼),ç›´æ¥åˆ äº†å°±è¡Œ

**redis æŠ¥é”™**

å¦‚æœå‡ºç° "MISCONF Redis is configured to save RDB snapshots, but is currently not able to persist on disk. Commands that may modify the data set are disabled. Please check Redis logs for details about the error. Resque" å¯ä»¥å°è¯•ä»¥ä¸‹å‘½ä»¤

```bash
$ redis-cli
> config set stop-writes-on-bgsave-error no
```
æˆ–
```
vim /etc/redis.conf

stop-writes-on-bgsave-error no
```

- https://gist.github.com/kapkaev/4619127

---

# æ•°æ®åº“
## Relational
### Oracle

<p align="center">
    <img src="../../../assets/img/logo/oracle.svg" width="25%">
</p>

- æœºå™¨ç‰©ç†å†…å­˜åº”ä¸å°‘äº 1GB,å¦‚æœæ˜¯ VMWARE è™šæ‹Ÿæœºå»ºè®®ä¸å°‘äº 1200MB.
- å¯¹äº64ä½çš„oracle11gæ•°æ®åº“,è‹¥ç¨‹åºæ–‡ä»¶å’Œæ•°æ®æ–‡ä»¶å®‰è£…åœ¨åŒä¸€ä¸ªåˆ†åŒº,åˆ™è¯¥åˆ†åŒºçš„ç¡¬ç›˜ç©ºé—´è¦æ±‚åˆ†åˆ«ä¸º:ä¼ä¸šç‰ˆ 5.65GBã€æ ‡å‡†ç‰ˆ 5.38GB;é™¤æ­¤ä»¥å¤–,è¿˜åº”ç¡®ä¿ `/tmp` ç›®å½•æ‰€åœ¨åˆ†åŒºçš„ç©ºé—´ä¸å°‘äº1GB,æ€»çš„æ¥è¯´,å»ºè®®ä¸º oracle11g å‡†å¤‡è‡³å°‘ 8GB çš„ç¡¬ç›˜ç©ºé—´

**RPM æ–¹å¼å®‰è£…**

ä¸‹è½½éœ€è¦çš„å®‰è£…åŒ…
- http://yum.oracle.com/repo/OracleLinux/OL7/latest/x86_64/getPackage/oracle-database-preinstall-19c-1.0-1.el7.x86_64.rpm
- https://www.oracle.com/technetwork/database/enterprise-edition/downloads/index.html

è¿™é‡Œä»¥ Oracle19c ä¸ºä¾‹

```bash
yum localinstall -y oracle-database-preinstall-19c-1.0-1.el7.x86_64.rpm

yum localinstall -y oracle-database-ee-19c-1.0-1.x86_64.rpm
```

æ³¨æ„å®‰è£…å®Œæˆä¹‹åçš„é…ç½® éœ€è¦ä½¿ç”¨ root ç”¨æˆ·.

ä¿®æ”¹å­—ç¬¦é›†ä»¥åŠå…¶ä»–çš„é…ç½®:
```
vim /etc/init.d/oracledb_ORCLCDB-19c

export ORACLE_VERSION=19c
export ORACLE_SID=ORA19C
export TEMPLATE_NAME=General_Purpose.dbc
export CHARSET=ZHS16GBK
export PDB_NAME=ORA19CPDB
export CREATE_AS_CDB=true
```

å¤åˆ¶å‚æ•°æ–‡ä»¶
```bash
cd /etc/sysconfig/
cp oracledb_ORCLCDB-19c.conf  oracledb_ORA19C-19c.conf

/etc/init.d/oracledb_ORCLCDB-19c configure
# ç­‰å¾… Oracle æ•°æ®åº“æ‰§è¡Œåˆå§‹åŒ–æ“ä½œå³å¯
```

å¢åŠ ç¯å¢ƒå˜é‡å¤„ç†
```vim
vim /etc/profile.d/oracle19c.sh

export  ORACLE_HOME=/opt/oracle/product/19c/dbhome_1
export  PATH=$PATH:/opt/oracle/product/19c/dbhome_1/bin
export  ORACLE_SID=ORA19C
```
```
source /etc/profile.d/oracle19c.sh
```

```bash
# ä¿®æ”¹ Oracle ç”¨æˆ·çš„å¯†ç :
passwd oracle

# ä½¿ç”¨ Oracle ç™»å½•è¿›è¡Œç›¸å…³çš„å¤„ç†
su - oracle
sqlplus / as sysdba

# æŸ¥çœ‹ pdb ä¿¡æ¯
show pdbs

# ä¿®æ”¹å¯†ç 
alter user system identified by Test1234;

# å¯åŠ¨
startup
exit

# å¯åŠ¨ç›‘å¬å™¨
cd $ORACLE_HOME/bin
lsnrctl start
```
```
systemctl stop firewalld
systemctl disable firewalld
setenforce 0
```

ä½¿ç”¨ navicat è¿æ¥æµ‹è¯•

é»˜è®¤ Oracle æ•°æ®åº“ä¸­çš„ä¸¤ä¸ªå…·æœ‰ DBA æƒé™çš„ç”¨æˆ· Sys å’Œ System çš„ç¼ºçœå¯†ç æ˜¯ managerã€‚

![](../../../assets/img/è¿ç»´/Linux/Power/1.png)

`æ³¨:æˆ‘åœ¨ oracle-database-ee-19c-1.0-1.x86_64 ç¯å¢ƒä¸‹,ä½¿ç”¨ Navicat Premium 12.1.18 å®‰è£… instantclient-basic-windows.x64-12.1.0.2.0 å¯ä»¥æˆåŠŸè¿æ¥`

**æ³¨ : æŠ¥é”™ ORA-03135**

æŠŠæœ¬æœºé˜²ç«å¢™å…³æ‰,é¡ºä¾¿çœ‹ä¸‹æ•°æ®åº“æœåŠ¡å™¨é˜²ç«å¢™æœ‰æ²¡æœ‰æ”¾è¡Œ

**æ³¨ : æŠ¥é”™ ORA-28547:connection to server failed, probable Oracle Net admin error**

`oci.dll` ç‰ˆæœ¬ä¸å¯¹.å› ä¸º Navicat æ˜¯é€šè¿‡ Oracle å®¢æˆ·ç«¯è¿æ¥ Oracle æœåŠ¡å™¨çš„,Oracle çš„å®¢æˆ·ç«¯åˆ†ä¸ºä¸¤ç§,ä¸€ç§æ˜¯æ ‡å‡†ç‰ˆ,ä¸€ç§æ˜¯ç®€æ´ç‰ˆ,å³ Oracle Install Client.è€Œæˆ‘ä»¬ç”¨ Navicat æ—¶é€šå¸¸ä¼šåœ¨è‡ªå·±çš„å®‰è£…è·¯å¾„ä¸‹åŒ…å«å¤šä¸ªç‰ˆæœ¬çš„ OCI,å¦‚æœä½¿ç”¨ Navicat è¿æ¥ Oracle æœåŠ¡å™¨å‡ºç° ORA-28547 é”™è¯¯æ—¶,å¤šæ•°æ˜¯å› ä¸º Navicat æœ¬åœ°çš„ OCI ç‰ˆæœ¬ä¸ Oracle æœåŠ¡å™¨æœåŠ¡å™¨ä¸ç¬¦é€ æˆçš„.

OCI ä¸‹è½½åœ°å€ : https://www.oracle.com/database/technologies/instant-client/downloads.html ,è§£å‹ instantclient-basic-win-x64

æ‰“å¼€ navicat,ä¸€æ¬¡é€‰æ‹©:å·¥å…·->é€‰é¡¹->ç¯å¢ƒ-->OCI ç¯å¢ƒ,é€‰æ‹©åˆšæ‰è§£å‹å¥½çš„ instantclient-basic-win-x64 ç›®å½•ä¸­çš„ oci.dll æ–‡ä»¶å³å¯,é‡å¯ navicat

**æ³¨ : æŠ¥é”™ oracle library is not loaded**

è¿˜æ˜¯ oci.dll ç‰ˆæœ¬ä¸å¯¹,æ¢ä¸ªä½ç‰ˆæœ¬çš„ Instant Client ğŸ¤£

**æ³¨ : æŠ¥é”™ ORA-28040: No matching authentication protocol**

è¿™ä¸ªè¿˜æ˜¯ oci.dll ç‰ˆæœ¬ä¸å¯¹,å†æ¢ä¸ªé«˜ç‰ˆæœ¬çš„ Instant Client ğŸ˜‚

**åˆ›å»ºç”¨æˆ·**

oracle å†…éƒ¨æœ‰ä¸¤ä¸ªé»˜è®¤çš„ç”¨æˆ·ï¼š`system` å’Œ `sys`ã€‚ç”¨æˆ·å¯ç›´æ¥ç™»å½•åˆ° `system` ç”¨æˆ·ä»¥åˆ›å»ºå…¶ä»–ç”¨æˆ·ï¼Œå› ä¸º `system` å…·æœ‰åˆ›å»ºåˆ«çš„ç”¨æˆ·çš„æƒé™ã€‚ åœ¨å®‰è£… oracle æ—¶ï¼Œç”¨æˆ·æˆ–ç³»ç»Ÿç®¡ç†å‘˜é¦–å…ˆå¯ä»¥ä¸ºè‡ªå·±å»ºç«‹ä¸€ä¸ªç”¨æˆ·ã€‚

```
è¯­æ³•[åˆ›å»ºç”¨æˆ·]ï¼š create user ç”¨æˆ·å identified by å£ä»¤[å³å¯†ç ]ï¼›
ä¾‹å­ï¼š create user test identified by test;

è¯­æ³•[æ›´æ”¹ç”¨æˆ·]: alter user ç”¨æˆ·å identified by å£ä»¤[æ”¹å˜çš„å£ä»¤];
ä¾‹å­ï¼š alter user test identified by 123456;
```

> æ³¨æ„ : æ­¤å¤„åªæ˜¯ä¸ºäº†æ–¹ä¾¿æ¼”ç¤º,ç”Ÿäº§ç¯å¢ƒä¸‹è¯·ä¸è¦ä½¿ç”¨ç±»ä¼¼ 123456 è¿™ç±»å¼±å£ä»¤

åˆ›å»ºç”¨æˆ·çš„æ—¶å€™ç”¨æˆ·åä»¥ `c##` æˆ–è€… `C##` å¼€å¤´å³å¯ã€‚
```
é”™è¯¯å†™æ³•ï¼šcreate user test identified by oracle;
æ­£ç¡®å†™æ³•ï¼šcreate user c##test identified by oracle;
```

**å…³é—­**
```
su - oracle
sqlplus / as sysdba
shutdown
```

æ•´ä¸ªå¯åŠ¨å’Œå…³é—­çš„è¿‡ç¨‹éƒ½ä¼šè®°å½•åœ¨ alert æ—¥å¿—æ–‡ä»¶ä¸­ã€‚

---

### Mariadb

<p align="center">
    <img src="../../../assets/img/logo/Mariadb.svg" width="25%">
</p>

**å®˜ç½‘**
- https://mariadb.org/

**å®‰è£…**

- Centosä¸‹
  ```bash
  yum install -y mariadb mariadb-server
  ```

- Ubuntuä¸‹
  ```bash
  apt -y install mariadb-server mariadb-client
  ```

**æ•°æ®åº“åˆå§‹åŒ–**
```bash
systemctl start mariadb
mysql_secure_installation
```

|é…ç½®æµç¨‹ 	|è¯´æ˜ |æ“ä½œ|
|------------ | ------------- | ------------|
Enter current password for root (enter for none) |	è¾“å…¥ root å¯†ç  	| åˆæ¬¡è¿è¡Œç›´æ¥å›è½¦
Set root password? [Y/n] |	æ˜¯è®¾ç½® root å¯†ç  |	å¯ä»¥ y æˆ–è€… å›è½¦
New password |	è¾“å…¥æ–°å¯†ç 
Re-enter new password |	å†æ¬¡è¾“å…¥æ–°å¯†ç 
Remove anonymous users? [Y/n] |	æ˜¯å¦åˆ é™¤åŒ¿åç”¨æˆ· | å¯ä»¥ y æˆ–è€…å›è½¦ æœ¬æ¬¡ y
Disallow root login remotely? [Y/n]  |	æ˜¯å¦ç¦æ­¢ root è¿œç¨‹ç™»å½• |  å¯ä»¥ y æˆ–è€…å›è½¦ æœ¬æ¬¡ n
Remove test database and access to it? [Y/n]  |	æ˜¯å¦åˆ é™¤ test æ•°æ®åº“ | y æˆ–è€…å›è½¦ æœ¬æ¬¡ y
Reload privilege tables now? [Y/n] | æ˜¯å¦é‡æ–°åŠ è½½æƒé™è¡¨ | y æˆ–è€…å›è½¦ æœ¬æ¬¡ y

**é…ç½®è¿œç¨‹è®¿é—®**

Mariadb æ•°æ®åº“æˆæƒ root ç”¨æˆ·èƒ½å¤Ÿè¿œç¨‹è®¿é—®

```bash
systemctl start mariadb
mysql -u root -p


select User, host from mysql.user;
GRANT ALL PRIVILEGES ON *.* TO 'root'@'%'IDENTIFIED BY 'toor' WITH GRANT OPTION;
# è¿™å¥è¯çš„æ„æ€ ï¼Œå…è®¸ä»»ä½• IP åœ°å€ï¼ˆä¸Šé¢çš„ % å°±æ˜¯è¿™ä¸ªæ„æ€ï¼‰çš„ç”µè„‘ ç”¨ root å¸æˆ· å’Œå¯†ç  toor æ¥è®¿é—®è¿™ä¸ªæ•°æ®åº“

FLUSH PRIVILEGES;
exit
```

> æ³¨æ„ : æ­¤å¤„åªæ˜¯ä¸ºäº†æ–¹ä¾¿æ¼”ç¤º,ç”Ÿäº§ç¯å¢ƒä¸‹è¯·ä¸è¦ä½¿ç”¨ç±»ä¼¼ toor è¿™ç±»å¼±å£ä»¤

- Centosä¸‹
  ```bash
  firewall-cmd --permanent --add-service=mysql
  firewall-cmd --reload

  systemctl enable mariadb
  systemctl restart mariadb
  ```

- Ubuntuä¸‹
  ```bash
  vim /etc/mysql/mariadb.conf.d/50-server.cnf

  # æ³¨é‡Šæ‰ bind-address = 127.0.0.1 è¿™ä¸€è¡Œ
  systemctl restart mariadb
  ```

**é‡ç½®å¯†ç **

```bash
# å…ˆå…³æœåŠ¡
systemctl stop mariadb

# ç”¨ä»¥ä¸‹å‘½ä»¤åœ¨æ²¡æœ‰æƒé™æ£€æŸ¥çš„æƒ…å†µä¸‹é‡æ–°å¯åŠ¨æ•°æ®åº“
mysqld_safe --skip-grant-tables &

# è¿™é‡Œ, --skip-grant-tables é€‰é¡¹è®©ä½ åœ¨æ²¡æœ‰å¯†ç å’Œæ‰€æœ‰æƒé™çš„æƒ…å†µä¸‹è¿›è¡Œè¿æ¥.å¦‚æœä½¿ç”¨æ­¤é€‰é¡¹å¯åŠ¨æœåŠ¡å™¨,å®ƒè¿˜ä¼šå¯ç”¨ --skip-networking é€‰é¡¹,è¿™ç”¨äºé˜²æ­¢å…¶ä»–å®¢æˆ·ç«¯è¿æ¥åˆ°æ•°æ®åº“æœåŠ¡å™¨.å¹¶ä¸”,& ç¬¦å·ç”¨äºåœ¨åå°è¿è¡Œå‘½ä»¤,å› æ­¤ä½ å¯ä»¥åœ¨ä»¥ä¸‹æ­¥éª¤ä¸­è¾“å…¥å…¶ä»–å‘½ä»¤.è¯·æ³¨æ„,ä¸Šè¿°å‘½ä»¤å¾ˆå±é™©,å¹¶ä¸”ä½ çš„æ•°æ®åº“ä¼šå˜å¾—ä¸å®‰å…¨.ä½ åº”è¯¥åªåœ¨çŸ­æ—¶é—´å†…è¿è¡Œæ­¤å‘½ä»¤ä»¥é‡ç½®å¯†ç .

# æ¥ä¸‹æ¥,ä»¥ root ç”¨æˆ·èº«ä»½ç™»å½• MySQL/MariaDB æœåŠ¡å™¨:
mysql

# åœ¨ mysql > æˆ– MariaDB [(none)] > æç¤ºç¬¦ä¸‹,è¿è¡Œä»¥ä¸‹å‘½ä»¤é‡ç½® root ç”¨æˆ·å¯†ç :
UPDATE mysql.user SET Password=PASSWORD('NEW-PASSWORD') WHERE User='root';

# ä½¿ç”¨ä½ è‡ªå·±çš„å¯†ç æ›¿æ¢ä¸Šè¿°å‘½ä»¤ä¸­çš„ NEW-PASSWORD.
# ç„¶å,è¾“å…¥ä»¥ä¸‹å‘½ä»¤é€€å‡º mysql æ§åˆ¶å°.

FLUSH PRIVILEGES;
exit

# æœ€å,å…³é—­ä¹‹å‰ä½¿ç”¨ --skip-grant-tables é€‰é¡¹è¿è¡Œçš„æ•°æ®åº“.ä¸ºæ­¤,è¿è¡Œ:
mysqladmin -u root -p shutdown
# ç³»ç»Ÿå°†è¦æ±‚ä½ è¾“å…¥åœ¨ä¸Šä¸€æ­¥ä¸­è®¾ç½®çš„ MySQL/MariaDB ç”¨æˆ·å¯†ç .

systemctl start mariadb
mysql -u root -p  # æœ¬åœ°è¿æ¥
```

**è¿æ¥è¿œç¨‹æ•°æ®åº“**

`mysql -u ç”¨æˆ·å -på¯†ç  -h æœåŠ¡å™¨IPåœ°å€ -P æœåŠ¡å™¨ç«¯å£å· -D æ•°æ®åº“å`

- æœåŠ¡å™¨ç«¯å£æ ‡å¿— -P ä¸€å®šè¦å¤§äº›ä»¥åŒºåˆ«äºç”¨æˆ· -p,å¦‚æœç›´æ¥è¿æ¥æ•°æ®åº“æ ‡å¿— -D ä¹Ÿè¦å¤§å†™ï¼›
- å¦‚æœè¦ç›´æ¥è¾“å…¥å¯†ç  -p åé¢ä¸èƒ½ç•™æœ‰ç©ºæ ¼å¦‚ -pmypassword;
- å‘½ä»¤ç»“æŸæ®µæ²¡æœ‰';'åˆ†å·ã€‚

ä¾‹å¦‚ : `mysql -u root -p123456 -h 192.168.1.1 -P 3306 -D test`

---

### MySQL

<p align="center">
    <img src="../../../assets/img/logo/mysql.svg" width="10%">
</p>

**å®˜ç½‘**
- https://www.mysql.com

**å®‰è£…**

å’Œ Mariadb å·®ä¸å¤š,çœ‹ Mariadb çš„å°±è¡Œäº†

- Ubuntu
  ```
  apt install mysql-server mysql-client
  ```

- Centos
  ```bash
  yum install yum-utils
  wget https://repo.mysql.com//mysql80-community-release-el7-1.noarch.rpm
  rpm -ivh mysql80-community-release-el7-1.noarch.rpm
  yum-config-manager --disable mysql80-community
  yum-config-manager --enable mysql57-community
  yum install mysql-community-server mysql-community-devel
  ```

**é…ç½®**
```bash
systemctl enable mysqld

# åˆå§‹åŒ– mysql
/usr/bin/mysqld â€“initialize â€“basedir=/usr/share/mysql â€“datadir=/var/lib/mysql/data/
# æˆ–
/usr/bin/mysql â€“initialize â€“basedir=/usr/share/mysql â€“datadir=/var/lib/mysql/data/
```
```bash
systemctl start mysqld
mysql -uroot -p

use mysql;
update user set authentication_string=password('123456') where user='root';
FLUSH PRIVILEGES;
exit
```

> æ³¨æ„ : æ­¤å¤„åªæ˜¯ä¸ºäº†æ–¹ä¾¿æ¼”ç¤º,ç”Ÿäº§ç¯å¢ƒä¸‹è¯·ä¸è¦ä½¿ç”¨ç±»ä¼¼ 123456 è¿™ç±»å¼±å£ä»¤

**é…ç½®è¿œç¨‹è¿æ¥**
```bash
mysql -u root -p

select User, host from mysql.user;
GRANT ALL PRIVILEGES ON *.* TO 'root'@'%'IDENTIFIED BY '123456' WITH GRANT OPTION;
FLUSH PRIVILEGES;
exit
```

> æ³¨æ„ : æ­¤å¤„åªæ˜¯ä¸ºäº†æ–¹ä¾¿æ¼”ç¤º,ç”Ÿäº§ç¯å¢ƒä¸‹è¯·ä¸è¦ä½¿ç”¨ç±»ä¼¼ 123456 è¿™ç±»å¼±å£ä»¤

```bash
firewall-cmd --permanent --add-service=mysql
firewall-cmd --reload
```

**è¿œç¨‹è®¿é—®æŠ¥é”™ Table 'performance_schema.session_variables' doesn't exist**
```bash
mysql_upgrade -u root -p --force
systemctl restart mysqld
```

---

### Postgresql

<p align="center">
    <img src="../../../assets/img/logo/Postgresql.png" width="18%">
</p>

**å®˜ç½‘**
- https://www.postgresql.org

**å®‰è£…**
```bash
yum install postgresql-server
postgresql-setup initdb   # åˆå§‹åŒ–æ•°æ®åº“
service postgresql start  # å¯åŠ¨æœåŠ¡
```

PostgreSQL å®‰è£…å®Œæˆå,ä¼šå»ºç«‹ä¸€ä¸‹ â€˜postgresâ€™ ç”¨æˆ·,ç”¨äºæ‰§è¡Œ PostgreSQL,æ•°æ®åº“ä¸­ä¹Ÿä¼šå»ºç«‹ä¸€ä¸ª 'postgres' ç”¨æˆ·,é»˜è®¤å¯†ç ä¸ºè‡ªåŠ¨ç”Ÿæˆ,éœ€è¦åœ¨ç³»ç»Ÿä¸­æ”¹ä¸€ä¸‹.

**ä¿®æ”¹ç”¨æˆ·å¯†ç **
```bash
sudo -u postgres psql postgres
\l                  # æŸ¥çœ‹å½“å‰çš„æ•°æ®åº“åˆ—è¡¨
\password postgres  # ç»™ postgres ç”¨æˆ·è®¾ç½®å¯†ç 
\q                  # é€€å‡ºæ•°æ®åº“
```

**å¼€å¯è¿œç¨‹è®¿é—®**
```vim
vim /var/lib/pgsql/data/postgresql.conf

listen_addresses='*'
```
```vim
vim /var/lib/pgsql/data/pg_hba.conf

# IPv4 local connections:
host    all             all             127.0.0.1/32            md5
host    all             all             0.0.0.0/0               md5

# å…¶ä¸­ 0.0.0.0/0 è¡¨ç¤ºè¿è¡Œä»»æ„ ip åœ°å€è®¿é—®.
# è‹¥è®¾ç½®ä¸º 192.168.1.0/24 åˆ™è¡¨ç¤ºå…è®¸æ¥è‡ª ip ä¸º 192.168.1.0 ~ 192.168.1.255 ä¹‹é—´çš„è®¿é—®.
```

`service postgresql restart` é˜²ç«å¢™è®°å¾—æ”¾è¡Œ

---

## Document
### MongoDB

<p align="center">
    <img src="../../../assets/img/logo/MongoDB.png" width="27%">
</p>

**å®˜ç½‘**
- https://www.mongodb.com/

**å®‰è£…**
```vim
vim /etc/yum.repos.d/mongodb-org-4.0.repo

[mongodb-org-4.0]
name=MongoDB Repository
baseurl=https://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/4.0/x86_64/
gpgcheck=1
enabled=1
gpgkey=https://www.mongodb.org/static/pgp/server-4.0.asc
```

```bash
yum install -y mongodb-org
```

**é…ç½®è¿œç¨‹è®¿é—®**
```vim
vim /etc/mongod.conf

# Listen to all ip address
bind_ip = 0.0.0.0
```
```bash
service mongod start
```

**åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·**
```sql
mongo
>use admin
 db.createUser(
  {
    user: "myUserAdmin",
    pwd: "abc123",
    roles: [ { role: "userAdminAnyDatabase", db: "admin" }, "readWriteAnyDatabase" ]
  }
 )

> show dbs;	    # æŸ¥çœ‹æ•°æ®åº“
> db.version();	# æŸ¥çœ‹æ•°æ®åº“ç‰ˆæœ¬
```

**å¯ç”¨æƒé™ç®¡ç†**
```vim
vim /etc/mongod.conf

#security
security:
authorization: enabled
```

```bash
service mongod restart
```

---

## Key-value
### Redis

<p align="center">
    <img src="../../../assets/img/logo/redis.svg" width="15%">
</p>

**å®˜ç½‘**
- https://redis.io/

**å®‰è£…**
- **åŒ…ç®¡ç†å™¨æ–¹å¼**

  åœ¨ CentOS å’Œ Red Hat ç³»ç»Ÿä¸­,é¦–å…ˆæ·»åŠ  EPEL ä»“åº“,ç„¶åæ›´æ–° yum æº:

  ```bash
  wget -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo
  yum clean all
  yum makecache
  yum install redis
  ```

  åœ¨ debian ä¸­
  ```bash
  apt install redis-server
  systemctl start redis # å®‰è£…å¥½åå¯åŠ¨ Redis æœåŠ¡å³å¯
  ```

- **æºä»£ç ç¼–è¯‘æ–¹å¼å®‰è£…**

  åœ¨å®˜ç½‘ä¸‹è½½ tar.gz çš„å®‰è£…åŒ…,æˆ–è€…é€šè¿‡ wget çš„æ–¹å¼ä¸‹è½½
  ```bash
  wget http://download.redis.io/releases/redis-5.0.5.tar.gz
  tar -zxvf redis-5.0.5.tar.gz
  cd redis-5.0.5
  make
  yum install tcl tcl-devel -y
  make test
  make MALLOC=libc
  make install
  ```
  ```bash
  ./usr/local/bin/redis-server
  ctrl+z
  bg
  redis-cli
  ```

ä½¿ç”¨ redis-cli è¿›å…¥ Redis å‘½ä»¤è¡Œæ¨¡å¼æ“ä½œ
```bash
redis-cli
127.0.0.1:6379> ping
PONG
127.0.0.1:6379> exit
```

**å¼€å¯è¿œç¨‹è®¿é—®**

ä¸ºäº†å¯ä»¥ä½¿ Redis èƒ½è¢«è¿œç¨‹è¿æ¥,éœ€è¦ä¿®æ”¹é…ç½®æ–‡ä»¶,è·¯å¾„ä¸º /etc/redis.conf
```vim
vim /etc/redis.conf

#bind 127.0.0.1
requirepass å¯†ç 	      # è®¾ç½® redis å¯†ç 
```
```bash
service redis restart   # å½“ç„¶è¿˜è¦è®°å¾—å¼€é˜²ç«å¢™
```

è¿æ¥æµ‹è¯•
```
redis-cli -h <ip> -p 6379 -a <PASSWORD>
```

**å‹æµ‹**

Redis-benchmark æ˜¯å®˜æ–¹è‡ªå¸¦çš„ Redis æ€§èƒ½æµ‹è¯•å·¥å…·,å¯ä»¥æœ‰æ•ˆçš„æµ‹è¯• Redis æœåŠ¡çš„æ€§èƒ½.
```bash
redis-benchmark -h 127.0.0.1 -p 6379 -c 100 -n 100000
# 100 ä¸ªå¹¶å‘è¿æ¥,100000 ä¸ªè¯·æ±‚,æ£€æµ‹ host ä¸º localhost ç«¯å£ä¸º 6379 çš„ redis æœåŠ¡å™¨æ€§èƒ½

redis-benchmark -h 127.0.0.1 -p 6379 -q -d 100
# æµ‹è¯•å­˜å–å¤§å°ä¸º100å­—èŠ‚çš„æ•°æ®åŒ…çš„æ€§èƒ½

redis-benchmark -t set,lpush -n 100000 -q
# åªæµ‹è¯•æŸäº›æ“ä½œçš„æ€§èƒ½

redis-benchmark -n 100000 -q script load "redis.call('set','foo','bar')"
# åªæµ‹è¯•æŸäº›æ•°å€¼å­˜å–çš„æ€§èƒ½
```

---

### Memcached

<p align="center">
    <img src="../../../assets/img/logo/memcached.svg" width=10%">
</p>

**å®˜ç½‘**
- https://memcached.org/

**å®‰è£…**
- **è½¯ä»¶åŒ…å®‰è£…**
  ```bash
  yum install -y memcached
  cat /etc/sysconfig/memcached
  ```

- **æºä»£ç ç¼–è¯‘æ–¹å¼å®‰è£…**

  åœ¨å®˜ç½‘ä¸‹è½½ tar.gz çš„å®‰è£…åŒ…,æˆ–è€…é€šè¿‡ wget çš„æ–¹å¼ä¸‹è½½
  ```bash
  wget http://memcached.org/latest
  tar -zxvf memcached-1.x.x.tar.gz
  cd memcached-1.x.x
  ./configure --prefix=/usr/local/memcached
  make && make test
  make install
  ```

**è¿è¡Œ**
```bash
systemctl start memcached
systemctl enable memcached

firewall-cmd --add-port=11211/tcp --permanent
firewall-cmd --reload
```

---

## å›¾å½¢
### Neo4j

<p align="center">
    <img src="../../../assets/img/logo/neo4j.svg" width="10%">
</p>

**å®˜ç½‘**
- https://neo4j.com

**å®‰è£…**

ä¾èµ– jdk,å®‰è£…è¿‡ç¨‹è§ [JDK](#JDK)

ä¸‹è½½ neo4j,è¿™é‡Œä»¥ 2.3.9 ä¸ºä¾‹
```bash
tar -zvxf neo4j-community-2.3.9-unix.tar.gz
cd neo4j-community-2.3.9/conf
```
```vim
vim neo4j-server.properties

org.neo4j.server.webserver.address=0.0.0.0
```
```bash
cd ../bin
firewall-cmd --permanent --zone=public --add-port=7474/tcp
firewall-cmd --reload
./neo4j start
```
è®¿é—® 127.0.0.1:7474,åˆå§‹è´¦å·å¯†ç  neo4j,è¿›å»åä¼šè¦æ±‚ä½ ä¿®æ”¹å¯†ç 

---

# æ–‡ä»¶æœåŠ¡
## filebrowser

<p align="center">
    <img src="../../../assets/img/logo/filebrowser.png" width="32%">
</p>

> ä¸€ä¸ªåœ¨çº¿ç½‘ç›˜æœåŠ¡,åªèƒ½åœ¨çº¿çœ‹å›¾ç‰‡,åœ¨çº¿çœ‹è§†é¢‘æ˜¯ä¸æ”¯æŒçš„ ^w^

**é¡¹ç›®åœ°å€**
- https://github.com/filebrowser/filebrowser

**å®‰è£…**

```bash
curl -fsSL https://filebrowser.xyz/get.sh | bash
```

**ä½¿ç”¨**

```bash
filebrowser -a <ä½ è‡ªå·±çš„IP> -r <æ–‡ä»¶å¤¹è·¯å¾„>
```

é»˜è®¤è´¦å·å¯†ç  admin

---

## NFS

**æœåŠ¡ç«¯**

å®‰è£…
```bash
yum install -y nfs-utils
```

ä¿®æ”¹é…ç½®æ–‡ä»¶
```vim
vim /etc/exports
/public 192.168.xxx.xxx(ro)
```

å¯æœåŠ¡
```bash
mkdir /public

vim /etc/selinux/config
	SELINUX=disabled

firewall-cmd --zone=public --add-service=rpc-bind --permanent
firewall-cmd --zone=public --add-service=mountd --permanent
firewall-cmd --zone=public --add-port=2049/tcp --permanent
firewall-cmd --zone=public --add-port=2049/udp --permanent
firewall-cmd --reload

service rpcbind start
service nfs start
```

**å®¢æˆ·ç«¯**

å®‰è£…,åˆ›å»ºç”¨æˆ·
```bash
yum install -y nfs-utils
mkdir /mnt/nfsfiles

useradd nfsuser1
passwd nfsuser1
```

éªŒè¯å…±äº«æ˜¯å¦æˆåŠŸ
```bash
showmount -e 192.168.xxx.xxx
```

æŒ‚è½½å…±äº«ç›®å½•
```vim
vim /etc/fstab

192.168.xxx.xxx:/public /mnt/nfsfiles/	nfs defaults 0 0
```
```
su -l nfsuser1
```

**éªŒè¯**

æœåŠ¡å™¨
```bash
cd /public/
echo "hello" > hello.txt
```

å®¢æˆ·ç«¯
```bash
cd /mnt/nfsfiles/
cat hello.txt
```

**æ›´å¤šé…ç½®æ¡ˆä¾‹**

è§ [nfs.md](./å®éªŒ/nfs.md)

---

## Samba

**å®˜ç½‘**
- https://www.samba.org

**æœåŠ¡ç«¯**

å®‰è£…
```
yum install samba
```

ä¿®æ”¹é…ç½®æ–‡ä»¶
```vim
vim /etc/samba/smb.conf
[smbshare]
path = /smbshare	                # å…±äº«ç›®å½•
public = yes
writeable=yes
hosts allow = 192.168.1xx.33/32	  # å…è®¸ä¸»æœº
hosts deny = all
create mask = 0770	              # åˆ›å»ºæ–‡ä»¶çš„æƒé™ä¸º 0770;
```

```bash
testparm  # éªŒè¯é…ç½®æ–‡ä»¶æœ‰æ²¡æœ‰é”™è¯¯
```

**ç”¨æˆ·é…ç½®**
```bash
# æ·»åŠ ç”¨æˆ·,è®¾ç½®å¯†ç 
useradd smb1
smbpasswd -a smb1(å¯†ç :smb123456)

# å°†ç”¨æˆ·æ·»åŠ åˆ° samba æœåŠ¡å™¨ä¸­,å¹¶è®¾ç½®å¯†ç 
pdbedit -a smb1(å¯†ç :smb123456)

# æŸ¥çœ‹ samba æ•°æ®åº“ç”¨æˆ·
pdbedit -L
```

åˆ›å»ºå…±äº«ç›®å½•,è®¾ç½®æ‰€æœ‰è€…å’Œæ‰€å±ç»„
```bash
mkdir /smbshare
chown smb1:smb1 /smbshare
```

å…³é—­ selinux (éœ€è¦é‡å¯)
```vim
vim /etc/selinux/config
SELINUX=disabled
```
```bash
firewall-cmd --zone=public --add-service=samba --permanent
firewall-cmd --reload

systemctl restart smb
```

**å®¢æˆ·ç«¯**
```bash
yum install samba

mkdir /data/web_data
mount -t cifs -o username=smb1,password='smb123456' //192.168.xx+1.xx/webdata
/data/web_data
```

**æ›´å¤šé…ç½®æ¡ˆä¾‹**

è§ [Samba.md](./å®éªŒ/Samba.md)

---

## Vsftp

**å®˜ç½‘**
- https://security.appspot.com/vsftpd.html

**åŒ¿åè®¿é—®**

|å‚æ•°|ä½œç”¨|
| :------------- | :------------- |
|anonymous_enable=YES |	å…è®¸åŒ¿åè®¿é—®æ¨¡å¼ |
|anon_umask=022 |	åŒ¿åç”¨æˆ·ä¸Šä¼ æ–‡ä»¶çš„umaskå€¼|
|anon_upload_enable=YES |	å…è®¸åŒ¿åç”¨æˆ·ä¸Šä¼ æ–‡ä»¶|
|anon_mkdir_write_enable=YES |	å…è®¸åŒ¿åç”¨æˆ·åˆ›å»ºç›®å½•|
|anon_other_write_enable=YES |	å…è®¸åŒ¿åç”¨æˆ·ä¿®æ”¹ç›®å½•åç§°æˆ–åˆ é™¤ç›®å½•|

```vim
vim /etc/vsftpd/vsftpd.conf

anonymous_enable=YES
anon_umask=022
anon_upload_enable=YES
anon_mkdir_write_enable=YES
anon_other_write_enable=YES
```
```bash
setenforce 0  # å…³é—­ selinux
firewall-cmd --permanent --zone=public --add-service=ftp
firewall-cmd --reload
systemctl restart vsftpd
systemctl enable vsftpd
```

ç°åœ¨å°±å¯ä»¥åœ¨å®¢æˆ·ç«¯æ‰§è¡Œ ftp å‘½ä»¤è¿æ¥åˆ°è¿œç¨‹çš„ FTP æœåŠ¡å™¨äº†.
åœ¨ vsftpd æœåŠ¡ç¨‹åºçš„åŒ¿åå¼€æ”¾è®¤è¯æ¨¡å¼ä¸‹,å…¶è´¦æˆ·ç»Ÿä¸€ä¸º anonymous,å¯†ç ä¸ºç©º.è€Œä¸”åœ¨è¿æ¥åˆ° FTP æœåŠ¡å™¨å,é»˜è®¤è®¿é—®çš„æ˜¯ `/var/ftp` ç›®å½•.
æˆ‘ä»¬å¯ä»¥åˆ‡æ¢åˆ°è¯¥ç›®å½•ä¸‹çš„ pub ç›®å½•ä¸­,ç„¶åå°è¯•åˆ›å»ºä¸€ä¸ªæ–°çš„ç›®å½•æ–‡ä»¶,ä»¥æ£€éªŒæ˜¯å¦æ‹¥æœ‰å†™å…¥æƒé™:
```bash
[root@linuxprobe ~]# ftp 192.168.10.10
Connected to 192.168.10.10 (192.168.10.10).
220 (vsFTPd 3.0.2)
Name (192.168.10.10:root): anonymous
331 Please specify the password.
Password:æ­¤å¤„æ•²å‡»å›è½¦å³å¯
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.

ftp> cd pub
250 Directory successfully changed.

ftp> mkdir files
257 "/pub/files" created

ftp> rename files database
350 Ready for RNTO.
250 Rename successful.

ftp> rmdir database
250 Remove directory operation successful.

ftp> exit
221 Goodbye.
```

---

**æœ¬åœ°ç”¨æˆ·**

|å‚æ•° |	ä½œç”¨|
| :------------- | :------------- |
|anonymous_enable=NO 	|ç¦æ­¢åŒ¿åè®¿é—®æ¨¡å¼|
|local_enable=YES |	å…è®¸æœ¬åœ°ç”¨æˆ·æ¨¡å¼|
|write_enable=YES |	è®¾ç½®å¯å†™æƒé™|
|local_umask=022 |	æœ¬åœ°ç”¨æˆ·æ¨¡å¼åˆ›å»ºæ–‡ä»¶çš„umaskå€¼|
|userlist_deny=YES 	|å¯ç”¨"ç¦æ­¢ç”¨æˆ·åå•",åå•æ–‡ä»¶ä¸º ftpusers å’Œ user_list|
|userlist_enable=YES |	å¼€å¯ç”¨æˆ·ä½œç”¨åå•æ–‡ä»¶åŠŸèƒ½|

```vim
vim /etc/vsftpd/vsftpd.conf

anonymous_enable=NO
local_enable=YES
write_enable=YES
local_umask=022
```
```bash
setenforce 0      # å…³é—­ selinux
firewall-cmd --permanent --zone=public --add-service=ftp
firewall-cmd --reload
systemctl restart vsftpd
systemctl enable vsftpd
```
æŒ‰ç†æ¥è®²,ç°åœ¨å·²ç»å®Œå…¨å¯ä»¥æœ¬åœ°ç”¨æˆ·çš„èº«ä»½ç™»å½• FTP æœåŠ¡å™¨äº†.ä½†æ˜¯åœ¨ä½¿ç”¨ root ç®¡ç†å‘˜ç™»å½•å,ç³»ç»Ÿæç¤ºå¦‚ä¸‹çš„é”™è¯¯ä¿¡æ¯:
```bash
[root@linuxprobe ~]# ftp 192.168.10.10
Connected to 192.168.10.10 (192.168.10.10).
220 (vsFTPd 3.0.2)
Name (192.168.10.10:root): root
530 Permission denied.
Login failed.
ftp>
```
å¯è§,åœ¨æˆ‘ä»¬è¾“å…¥ root ç®¡ç†å‘˜çš„å¯†ç ä¹‹å‰,å°±å·²ç»è¢«ç³»ç»Ÿæ‹’ç»è®¿é—®äº†.è¿™æ˜¯å› ä¸º vsftpd æœåŠ¡ç¨‹åºæ‰€åœ¨çš„ç›®å½•ä¸­é»˜è®¤å­˜æ”¾ç€ä¸¤ä¸ªåä¸º"ç”¨æˆ·åå•"çš„æ–‡ä»¶ (ftpusers å’Œ user_list) .åªè¦é‡Œé¢å†™æœ‰æŸä½ç”¨æˆ·çš„åå­—,å°±ä¸å†å…è®¸è¿™ä½ç”¨æˆ·ç™»å½•åˆ° FTP æœåŠ¡å™¨ä¸Š.
```bash
[root@linuxprobe ~]# cat /etc/vsftpd/user_list

[root@linuxprobe ~]# cat /etc/vsftpd/ftpusers
```
å¦‚æœä½ ç¡®è®¤åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ root ç®¡ç†å‘˜ä¸ä¼šå¯¹ç³»ç»Ÿå®‰å…¨äº§ç”Ÿå½±å“,åªéœ€æŒ‰ç…§ä¸Šé¢çš„æç¤ºåˆ é™¤æ‰ root ç”¨æˆ·åå³å¯.æˆ‘ä»¬ä¹Ÿå¯ä»¥é€‰æ‹© ftpusers å’Œ user_list æ–‡ä»¶ä¸­æ²¡æœ‰çš„ä¸€ä¸ªæ™®é€šç”¨æˆ·å°è¯•ç™»å½• FTP æœåŠ¡å™¨
åœ¨é‡‡ç”¨æœ¬åœ°ç”¨æˆ·æ¨¡å¼ç™»å½•FTPæœåŠ¡å™¨å,é»˜è®¤è®¿é—®çš„æ˜¯è¯¥ç”¨æˆ·çš„å®¶ç›®å½•,ä¹Ÿå°±æ˜¯è¯´,è®¿é—®çš„æ˜¯ `/home/username` ç›®å½•.è€Œä¸”è¯¥ç›®å½•çš„é»˜è®¤æ‰€æœ‰è€…ã€æ‰€å±ç»„éƒ½æ˜¯è¯¥ç”¨æˆ·è‡ªå·±,å› æ­¤ä¸å­˜åœ¨å†™å…¥æƒé™ä¸è¶³çš„æƒ…å†µ.

---

**è™šæ‹Ÿç”¨æˆ·**

å®‰è£…
```bash
yum install vsftpd
```

è®¤è¯

åˆ›å»ºè™šæ‹Ÿç”¨æˆ·æ–‡ä»¶,æŠŠè¿™äº›ç”¨æˆ·åå’Œå¯†ç å­˜æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­.è¯¥æ–‡ä»¶å†…å®¹æ ¼å¼æ˜¯:ç”¨æˆ·åå ç”¨ä¸€è¡Œ,å¯†ç å ä¸€è¡Œ.
```bash
cd /etc/vsftp
```
```vim
vim login.list

Ftpuser1
123456
Ftpuser2
123456
Ftpadmin
123456
```

ä½¿ç”¨ db_load å‘½ä»¤ç”Ÿæˆ db å£ä»¤ login æ•°æ®åº“æ–‡ä»¶
```bash
db_load -T -t hash -f login.list login.db
```
é€šè¿‡ä¿®æ”¹æŒ‡å®šçš„é…ç½®æ–‡ä»¶,è°ƒæ•´å¯¹è¯¥ç¨‹åºçš„è®¤è¯æ–¹å¼
```vim
vim /etc/vsftpd/vsftpd.conf

pam_service_name=vsftpd.vu  # è®¾ç½® PAM ä½¿ç”¨çš„åç§°,è¯¥åç§°å°±æ˜¯ /etc/pam.d/ ç›®å½•ä¸‹ vsfptd æ–‡ä»¶çš„æ–‡ä»¶å
```
```bash
cp /etc/pam.d/vsftpd /etc/pam.d/vsftpd.vu
```
```vim
vim /etc/pam.d/vsftpd.vu

auth       required     pam_userdb.so db=/etc/vsftpd/login
account    required     pam_userdb.so db=/etc/vsftpd/login
# æ³¨æ„:æ ¼å¼æ˜¯ db=/etc/vsftpd/login è¿™æ ·çš„,ä¸€å®šä¸è¦å»æ‰æºæ–‡ä»¶çš„ .db åç¼€
```

é…ç½®æ–‡ä»¶
```vim
vim /etc/vsftpd/vsftpd.conf

anonymous_enable=NO
local_enable=YES
guest_enable=YES
guest_username=virtual
pam_service_name=vsftpd.vu
allow_writeable_chroot=YES
```

|å‚æ•° |	ä½œç”¨|
| :------------- | :------------- |
|anonymous_enable=NO 	|ç¦æ­¢åŒ¿åå¼€æ”¾æ¨¡å¼|
|local_enable=YES |	å…è®¸æœ¬åœ°ç”¨æˆ·æ¨¡å¼|
|guest_enable=YES |	å¼€å¯è™šæ‹Ÿç”¨æˆ·æ¨¡å¼|
|guest_username=virtual |	æŒ‡å®šè™šæ‹Ÿç”¨æˆ·è´¦æˆ·|
|pam_service_name=vsftpd.vu |	æŒ‡å®šPAMæ–‡ä»¶|
|allow_writeable_chroot=YES |	å…è®¸å¯¹ç¦é”¢çš„FTPæ ¹ç›®å½•æ‰§è¡Œå†™å…¥æ“ä½œ,è€Œä¸”ä¸æ‹’ç»ç”¨æˆ·çš„ç™»å½•è¯·æ±‚|

ç”¨æˆ·é…ç½®æƒé™æ–‡ä»¶
æ‰€æœ‰ç”¨æˆ·ä¸»ç›®å½•ä¸º /home/ftp å®¿ä¸»ä¸º virtual ç”¨æˆ·;
```bash
useradd -d /home/ftp -s /sbin/nologin virtual
chmod -Rf 755 /home/ftp/
cd /home/ftp/
touch testfile
```
```vim
vim /etc/vsftpd/vsftpd.conf

guest_enable=YES      # è¡¨ç¤ºæ˜¯å¦å¼€å¯ vsftpd è™šæ‹Ÿç”¨æˆ·çš„åŠŸèƒ½,yes è¡¨ç¤ºå¼€å¯,no è¡¨ç¤ºä¸å¼€å¯.
guest_username=virtual       # æŒ‡å®šè™šæ‹Ÿç”¨æˆ·çš„å®¿ä¸»ç”¨æˆ·
user_config_dir=/etc/vsftpd/user_conf     # è®¾å®šè™šæ‹Ÿç”¨æˆ·ä¸ªäºº vsftpd æœåŠ¡æ–‡ä»¶å­˜æ”¾è·¯å¾„
allow_writeable_chroot=YES
```

ç¼–è¾‘ç”¨æˆ·æƒé™é…ç½®æ–‡ä»¶
```vim
vim Ftpadmin  # åˆ›å»º Ftpadmin è¿™ä¸ªç”¨æˆ·çš„é…ç½®æ–‡ä»¶

anon_upload_enable=YES
anon_mkdir_wirte_enable=YES
anon_other_wirte_enable=YES
anon_umask=022


# è¦æ±‚è™šæ‹Ÿç”¨æˆ·å…·æœ‰å†™æƒé™ (ä¸Šä¼ ã€ä¸‹è½½ã€åˆ é™¤ã€é‡å‘½å)

# umask = 022 æ—¶,æ–°å»ºçš„ç›®å½• æƒé™æ˜¯755,æ–‡ä»¶çš„æƒé™æ˜¯ 644
# umask = 077 æ—¶,æ–°å»ºçš„ç›®å½• æƒé™æ˜¯700,æ–‡ä»¶çš„æƒé™æ—¶ 600
# vsftpdçš„local_umaskå’Œanon_umaskå€Ÿé‰´äº†å®ƒ
# é»˜è®¤æƒ…å†µä¸‹vsftpä¸Šä¼ ä¹‹åæ–‡ä»¶çš„æƒé™æ˜¯600,ç›®å½•æƒé™æ˜¯700
# æƒ³è¦ä¿®æ”¹ä¸Šä¼ ä¹‹åæ–‡ä»¶çš„æƒé™,æœ‰ä¸¤ç§æƒ…å†µ
# å¦‚æœä½¿ç”¨vsftpçš„æ˜¯æœ¬åœ°ç”¨æˆ·
# åˆ™è¦ä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„ local_umask çš„å€¼
# å¦‚æœä½¿ç”¨vsftpçš„æ˜¯è™šæ‹Ÿç”¨æˆ·
# åˆ™è¦ä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„ anon_umask çš„å€¼
```

**å¯æœåŠ¡**
```bash
setenforce 0    # å…³é—­ selinux
firewall-cmd --zone=public --add-service=ftp
firewall-cmd --reload
systemctl restart vsftpd
systemctl enable vsftpd
```

**Source & Reference**
- [ç¬¬11ç«  ä½¿ç”¨VsftpdæœåŠ¡ä¼ è¾“æ–‡ä»¶.](https://www.linuxprobe.com/chapter-11.html)

**æ›´å¤šé…ç½®æ¡ˆä¾‹**

è§ [Vsftp.md](./å®éªŒ/Vsftp.md)

---

# ç¼–ç¨‹è¯­è¨€
## C

<p align="center">
    <img src="../../../assets/img/logo/c.svg" width="10%">
</p>

```c
vim world.c

#include <stdio.h>
int main(void){
				printf("Hello World");
				return 0;
}
```
```bash
gcc helloworld.c -o execFile
./execFlie
```

---

## Go

<p align="center">
    <img src="../../../assets/img/logo/go.svg" width="20%">
</p>

**å®˜ç½‘**
- https://golang.org/

**å®‰è£…**

è®¿é—® https://golang.org/dl/ ä¸‹è½½æœ€æ–°ç‰ˆæœ¬åŒ…,è¿™é‡Œä»¥ `go1.13.linux-amd64.tar.gz` ä¸ºä¾‹

```bash
tar -C /usr/local -xzf go1.13.linux-amd64.tar.gz

export PATH=$PATH:/usr/local/go/bin
export GOROOT=/usr/local/go
export GOPATH=$HOME/Applications/Go
source ~/.bash_profile
# $GOPATH å¯ä»¥åŒ…å«å¤šä¸ªå·¥ä½œç›®å½•,å–å†³äºä½ çš„ä¸ªäººæƒ…å†µ.å¦‚æœä½ è®¾ç½®äº†å¤šä¸ªå·¥ä½œç›®å½•,é‚£ä¹ˆå½“ä½ åœ¨ä¹‹åä½¿ç”¨ go get (è¿œç¨‹åŒ…å®‰è£…å‘½ä»¤) æ—¶è¿œç¨‹åŒ…å°†ä¼šè¢«å®‰è£…åœ¨ç¬¬ä¸€ä¸ªç›®å½•ä¸‹.
go version
```

**æµ‹è¯•å®‰è£…**
```bash
mkdir -p $HOME/Applications/Go
cd $HOME/Applications/Go
```
```vim
vim hello.go


package main

import "fmt"

func main() {
	fmt.Printf("hello, world\n")
}
```
```bash
go build
./hello
```

---

## JDK

<p align="center">
    <img src="../../../assets/img/logo/java.svg" width="10%">
</p>

**rpm åŒ…æ–¹å¼å®‰è£…**

ä¸‹è½½
https://www.oracle.com/technetwork/java/javase/downloads/
```bash
chmod +x jdk-****.rpm
yum localinstall jdk-****.rpm
ä¹Ÿå¯ä»¥
rpm -ivh jdk-****.rpm
```

**ä½¿ç”¨ ppa/æºæ–¹å¼å®‰è£…**
1. æ·»åŠ  ppa

    `sudo add-apt-repository ppa:webupd8team/java`

    `sudo apt-get update`

2. å®‰è£… oracle-java-installer

	jdk7

	`sudo apt-get install oracle-java7-installer`

	jdk8

	`sudo apt-get install oracle-java8-installer`

**ç›´æ¥ä½¿ç”¨ç¼–è¯‘å®Œæˆçš„**

è‡ªè¡Œä¸‹è½½ [oracle jdk](https://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html)

è¿™é‡Œä»¥ `jdk-8u212-linux-x64.tar.gz` ä¸¾ä¾‹

```bash
tar -xzvf jdk-8u212-linux-x64.tar.gz

mkdir /usr/local/java/

mv jdk1.8.0_212/ /usr/local/java

export JAVA_HOME=/usr/local/java/jdk1.8.0_212
export JRE_HOME=${JAVA_HOME}/jre
export CLASSPATH=.:${JAVA_HOME}/lib:${JRE_HOME}/lib
export PATH=${JAVA_HOME}/bin:$PATH

source /etc/profile

ln -s /usr/local/java/jdk1.8.0_212/bin/java /usr/bin/java
```

**æµ‹è¯•**
```bash
java
javac
```

---

## Python3

<p align="center">
    <img src="../../../assets/img/logo/python.svg" width="10%">
</p>

**å®˜ç½‘**
- https://www.python.org/

**yum å®‰è£…**
```bash
yum install epel-release
æˆ–
wget -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo
yum install -y python36 python36-devel
```

**æºä»£ç ç¼–è¯‘æ–¹å¼å®‰è£…**

å®‰è£…ä¾èµ–ç¯å¢ƒ
```bash
yum install -y zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gdbm-devel db4-devel libpcap-devel xz-devel
```

ä¸‹è½½Python3
```bash
wget https://www.python.org/ftp/python/3.6.1/Python-3.6.1.tgz
```

å®‰è£…python3
```bash
mkdir -p /usr/local/python3
tar zxvf Python-3.6.1.tgz
cd Python-3.6.1
./configure --prefix=/usr/local/python3
make
make install æˆ–è€… make && make install
```

æ·»åŠ åˆ°ç¯å¢ƒå˜é‡
```bash
ln -s /usr/local/python3/bin/python3 /usr/bin/python3
```
```vim
vim ~/.bash_profile # æ°¸ä¹…ä¿®æ”¹å˜é‡

PATH=$PATH:/usr/local/python3/bin/
```
```bash
source ~/.bash_profile
```
æ£€æŸ¥ Python3 åŠ pip3 æ˜¯å¦æ­£å¸¸å¯ç”¨
```bash
python3 -V
pip3 -V
```

### pip

```bash
wget https://bootstrap.pypa.io/get-pip.py
python3 get-pip.py
```

debian ç³»å¯ä»¥ç›´æ¥ç”¨ apt è£…

```bash
apt-get install python-pip
```

**åŠ é€Ÿ**
- [pip](../../Plan/Misc-Plan.md#pip)

**pip æŒ‡å®šç‰ˆæœ¬å®‰è£…**

æ£€æŸ¥ä¸€é pip å’Œ pip3 åˆ†åˆ«æŒ‡å‘çš„ Python
```bash
pip -V
pip3 -V
```

åœ¨ linux å®‰è£…äº†å¤šç‰ˆæœ¬ python æ—¶(ä¾‹å¦‚ python2.6 å’Œ 2.7),pip å®‰è£…çš„åŒ…ä¸ä¸€å®šæ˜¯ç”¨æˆ·æƒ³è¦çš„ä½ç½®,æ­¤æ—¶å¯ä»¥ç”¨ -t é€‰é¡¹æ¥æŒ‡å®šä½ç½®
```bash
pip install -t /usr/local/lib/python2.7/site-packages/ docker
```

### jupyterlab

**å®‰è£…è¿è¡Œ**
```bash
pip3 install jupyterlab

jupyter lab --ip=0.0.0.0 --allow-root         # è¿è¡Œ
# æˆ–
jupyter lab --ip=* --allow-root               # å…è®¸æ‰€æœ‰IPè®¿é—®
```

**ç®¡ç†**
```bash
jupyter-notebook list                         # æŸ¥çœ‹ä»¤ç‰Œ
jupyter-labextension list                     # åˆ—å‡ºå·²å®‰è£…æ‰©å±•
jupyter-labextension uninstall my-extension   # å¸è½½å·²å®‰è£…æ‰©å±•
```

---

## Ruby

<p align="center">
    <img src="../../../assets/img/logo/ruby.svg" width="8%">
</p>

**å®˜ç½‘**
- https://www.ruby-lang.org

**å®‰è£…**

ä¸‹è½½ ruby å®‰è£…åŒ…,å¹¶è¿›è¡Œç¼–è¯‘å®‰è£…
```bash
wget https://cache.ruby-lang.org/pub/ruby/2.6/ruby-2.6.2.tar.gz
tar xvfvz ruby-2.6.2.tar.gz
cd ruby-2.6.2
./configure
make
make install
```

å°† ruby æ·»åŠ åˆ°ç¯å¢ƒå˜é‡,ruby å®‰è£…åœ¨/usr/local/bin/ç›®å½•ä¸‹,å› æ­¤ç¼–è¾‘ ~/.bash_profileæ–‡ä»¶,æ·»åŠ ä¸€ä¸‹å†…å®¹:
```bash
vim ~/.bash_profile

export PATH=$PATH:/usr/local/bin/
```
```bash
source ~/.bash_profile  # ä¸è¦å¿˜äº†ç”Ÿæ•ˆä¸€ä¸‹
```

---

## Rust

<p align="center">
    <img src="../../../assets/img/logo/rust.svg" width="10%">
</p>

**å®˜ç½‘**
- https://www.rust-lang.org

**å®‰è£…**
```bash
curl https://sh.rustup.rs -sSf | sh

æˆ–

dnf install rust cargo
```

**æµ‹è¯•å®‰è£…**
```bash
rustc --version
cargo --version

tee hello.rs <<-'EOF'
fn main() {
    println!("Hello, world!");
}
EOF
rustc hello.rs    # ç¼–è¯‘ç¨‹åº
./hello           # è¿è¡Œ
```

**ä½¿ç”¨ Cargo æ„å»ºç¨‹åº**
```bash
cargo new helloworld      # åˆ›å»ºä¸€ä¸ªæ–°çš„åŒ…
cd helloworld/
cargo build               # æ„å»ºåŒ…
./target/debug/helloworld # ç›´æ¥è¿è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶

cargo run                 # ç¼–è¯‘å’Œè¿è¡Œ

cargo check               # æŸ¥çœ‹å¯¹ç›®å½•è¿›è¡Œäº†å“ªäº›æ›´æ”¹
cargo clean               # æ¸…ç†ç›®å½•
```

---

# ç³»ç»Ÿç›‘ç®¡
## BaoTa

**å®˜ç½‘**
- https://www.bt.cn/
- https://github.com/aaPanel/BaoTa

**å®‰è£…**
- **Centos**

  ```bash
  yum install -y wget && wget -O install.sh http://download.bt.cn/install/install_6.0.sh && sh install.sh
  ```

- **Ubuntu/Debian**

  ```bash
  wget -O install.sh http://download.bt.cn/install/install-ubuntu_6.0.sh && sudo bash install.sh
  ```

**ä½¿ç”¨**

- web: å®‰è£…å®Œåä¼šéšæœºç”Ÿæˆ8ä½çš„ç®¡ç†è·¯å¾„,è´¦å·å’Œå¯†ç ,è®¿é—®å³å¯
- shell: ä½¿ç”¨ `bt` å‘½ä»¤

---

## Jenkins

<p align="center">
    <img src="../../../assets/img/logo/Jenkins.png" width="27%">
</p>

**å®˜ç½‘**
- https://jenkins.io/

`æ³¨,Jenkins éœ€è¦ jdk ç¯å¢ƒ,è¯·å…ˆè¡Œå®‰è£…`

**rpm åŒ…æ–¹å¼å®‰è£…**

æ·»åŠ  Jenkins æº:
```bash
sudo wget -O /etc/yum.repos.d/jenkins.repo http://jenkins-ci.org/redhat/jenkins.repo
sudo rpm --import http://pkg.jenkins-ci.org/redhat/jenkins-ci.org.key
```

ä½¿ç”¨ yum å‘½ä»¤å®‰è£… Jenkins:
```bash
yum install jenkins
```

**ä½¿ç”¨ ppa/æºæ–¹å¼å®‰è£…**
```bash
wget -q -O - https://pkg.jenkins.io/debian/jenkins.io.key | sudo apt-key add -

sed -i "1ideb https://pkg.jenkins.io/debian binary/" /etc/apt/sources.list

sudo apt-get update
sudo apt-get install jenkins
```

å®‰è£…åé»˜è®¤æœåŠ¡æ˜¯å¯åŠ¨çš„,é»˜è®¤æ˜¯ 8080 ç«¯å£,åœ¨æµè§ˆå™¨è¾“å…¥ : http://127.0.0.1:8080/å³å¯æ‰“å¼€ä¸»é¡µ

æŸ¥çœ‹å¯†ç 
```
cat /var/lib/jenkins/secrets/initialAdminPassword
```

---

## JumpServer

<p align="center">
    <img src="../../../assets/img/logo/JumpServer.png" width="30%">
</p>

**å®˜ç½‘**
- http://www.jumpserver.org/

**å®‰è£…**

> ä»¥ä¸‹éƒ¨åˆ†å†…å®¹æ¥è‡ª <sup>[[å®˜æ–¹æ–‡æ¡£](https://docs.jumpserver.org/zh/master/install/docker_install/)]</sup> åœ¨æ­¤åªè®°å½•é‡ç‚¹

`æ³¨:é‰´äºå›½å†…ç¯å¢ƒ,ä¸‹é¢æ­¥éª¤è¿è¡Œä¸­è¿˜æ˜¯ä¼šå‡ºç° docker pull é•œåƒè¶…æ—¶çš„é—®é¢˜,ä½ æ‡‚çš„,ä¸è¦é—®æˆ‘æ€ä¹ˆè§£å†³`

```bash
curl -sSL https://github.com/jumpserver/jumpserver/releases/download/2.0.1/quick_start.sh | sh
```

---

## Loganalyzer

<p align="center">
    <img src="../../../assets/img/logo/Loganalyzer.png" width="50%">
</p>

> æ—¥å¿—æ”¶é›†ç³»ç»Ÿ

**å®‰è£…**

è¿™é‡Œä»¥ LAMP ç¯å¢ƒä¸ºä¾‹
```bash
yum install -y httpd mariadb mariadb-server php php-mysql mysql-devel
systemctl start mariadb
systemctl restart httpd
firewall-cmd --zone=public --add-service=http --permanent
firewall-cmd --reload
```
```vim
vim /etc/httpd/conf/httpd.conf

<IfModule dir_module>
    DirectoryIndex index.php index.html
</IfModule>
```
```bash
yum install -y rsyslog-mysql
cd /usr/share/doc/rsyslog-8.24.0/
mysql -uroot -p < mysql-createDB.sql

systemctl restart rsyslog

mysql -uroot -p
GRANT ALL ON Syslog.* TO 'Syslog'@'localhost' identified BY 'Syslog';
FLUSH PRIVILEGES;
```

> æ³¨æ„ : æ­¤å¤„åªæ˜¯ä¸ºäº†æ–¹ä¾¿æ¼”ç¤º,ç”Ÿäº§ç¯å¢ƒä¸‹è¯·ä¸è¦ä½¿ç”¨ç±»ä¼¼ Syslog è¿™ç±»å¼±å£ä»¤

```vim
vim /etc/rsyslog.conf

$ModLoad immark

$ModLoad imudp
$UDPServerRun 514

$ModLoad imtcp

$ModLoad ommysql
*.* :ommysql:localhost,Syslog,rsyslog,Syslog
```

`æ³¨:åŒæ ·,è¿™é‡Œæ•°æ®åº“è´¦å·é“¾æ¥çš„å¯†ç è‡ªå·±ä¹Ÿè®°å¾—æ”¹ä¸€ä¸‹`

```bash
wget -c http://download.adiscon.com/loganalyzer/loganalyzer-4.1.7.tar.gz
tar xf loganalyzer-4.1.7.tar.gz -C /tmp/
cd /tmp/loganalyzer-4.1.7/

# !!æ³¨: æˆ‘è¿™é‡Œæœ‰ä¸ªåˆ é™¤ /var/www/html/ ä¸‹æ–‡ä»¶çš„æ“ä½œ,çœ‹æ¸…æ¥šå†æ‰§è¡Œ!!
rm -rf /var/www/html/*
cp -a src/* /var/www/html/
cp -a contrib/* /var/www/html/
chmod +x /var/www/html/*.sh
cd /var/www/html
./configure.sh
```

```bash
echo 1 > /var/log/syslog
```

ç„¶åè®¿é—® 127.0.0.1 å³å¯çœ‹åˆ°åˆå§‹åŒ–å®‰è£…ç•Œé¢,åœ¨ step3 è®°å¾—é€‰æ‹© `Enable User Database`

- Database Host:localhost
- Database Port:3306
- Database Name:Syslog
- Table prefix:logcon_
- Database User:Syslog
- Database Password:Syslog  `æ³¨: å¯†ç è‡ªå·±è®°å¾—æ”¹`

---

## Supervisor

**å®˜ç½‘**
- http://supervisord.org/

**å®‰è£…**

å› ä¸º Supervisor æ˜¯ Python å¼€å‘çš„,å®‰è£…å‰å…ˆæ£€æŸ¥ä¸€ä¸‹ç³»ç»Ÿå¦å®‰è£…äº† Python2.4 ä»¥ä¸Šç‰ˆæœ¬.
```bash
pip install supervisor
```

å®‰è£…å®Œæˆå,æˆ‘ä»¬ä½¿ç”¨ echo_supervisord_conf å‘½ä»¤åˆ›å»ºä¸€ä¸ª Supervisor é…ç½®æ–‡ä»¶
```bash
echo_supervisord_conf > /etc/supervisord.conf
```

**é…ç½®**

æ¥ç€åœ¨ /etc/supervisord.conf æ–‡ä»¶æœ€ä¸‹æ–¹åŠ å…¥ç›®æ ‡ç¨‹åºçš„å¯åŠ¨é¡¹ç›®
```conf
vim /etc/supervisord.conf

; [program:xx]æ˜¯è¢«ç®¡ç†çš„è¿›ç¨‹é…ç½®å‚æ•°,xxæ˜¯è¿›ç¨‹çš„åç§°
[program:xx]
command=/opt/apache-tomcat-8.0.35/bin/catalina.sh run  ; ç¨‹åºå¯åŠ¨å‘½ä»¤
autostart=true       ; åœ¨ supervisord å¯åŠ¨çš„æ—¶å€™ä¹Ÿè‡ªåŠ¨å¯åŠ¨
startsecs=10         ; å¯åŠ¨10ç§’åæ²¡æœ‰å¼‚å¸¸é€€å‡º,å°±è¡¨ç¤ºè¿›ç¨‹æ­£å¸¸å¯åŠ¨äº†,é»˜è®¤ä¸º1ç§’
autorestart=true     ; ç¨‹åºé€€å‡ºåè‡ªåŠ¨é‡å¯,å¯é€‰å€¼:[unexpected,true,false],é»˜è®¤ä¸º unexpected,è¡¨ç¤ºè¿›ç¨‹æ„å¤–æ€æ­»åæ‰é‡å¯
startretries=3       ; å¯åŠ¨å¤±è´¥è‡ªåŠ¨é‡è¯•æ¬¡æ•°,é»˜è®¤æ˜¯3
user=tomcat          ; ç”¨å“ªä¸ªç”¨æˆ·å¯åŠ¨è¿›ç¨‹,é»˜è®¤æ˜¯root
priority=999         ; è¿›ç¨‹å¯åŠ¨ä¼˜å…ˆçº§,é»˜è®¤999,å€¼å°çš„ä¼˜å…ˆå¯åŠ¨
redirect_stderr=true ; æŠŠ stderr é‡å®šå‘åˆ° stdout,é»˜è®¤ false
stdout_logfile_maxbytes=20MB  ; stdout æ—¥å¿—æ–‡ä»¶å¤§å°,é»˜è®¤ 50MB s
tdout_logfile_backups = 20   ; stdout æ—¥å¿—æ–‡ä»¶å¤‡ä»½æ•°,é»˜è®¤æ˜¯10
; stdout æ—¥å¿—æ–‡ä»¶,éœ€è¦æ³¨æ„å½“æŒ‡å®šç›®å½•ä¸å­˜åœ¨æ—¶æ— æ³•æ­£å¸¸å¯åŠ¨,æ‰€ä»¥éœ€è¦æ‰‹åŠ¨åˆ›å»ºç›®å½• (supervisord ä¼šè‡ªåŠ¨åˆ›å»ºæ—¥å¿—æ–‡ä»¶)
stdout_logfile=/opt/apache-tomcat-8.0.35/logs/catalina.out
stopasgroup=false     ;é»˜è®¤ä¸º false,è¿›ç¨‹è¢«æ€æ­»æ—¶,æ˜¯å¦å‘è¿™ä¸ªè¿›ç¨‹ç»„å‘é€ stop ä¿¡å·,åŒ…æ‹¬å­è¿›ç¨‹
killasgroup=false     ;é»˜è®¤ä¸º false,å‘è¿›ç¨‹ç»„å‘é€ kill ä¿¡å·,åŒ…æ‹¬å­è¿›ç¨‹
```

æ³¨æ„ä¿®æ”¹ user = tomcat

æ¥ç€ç›´æ¥è¿è¡Œ Supervisor å³å¯è®©ç›®æ ‡ç¨‹åºä¿æŒåå°è¿è¡Œ,è¿è¡ŒæœåŠ¡æ—¶,éœ€è¦æŒ‡å®š supervisor é…ç½®æ–‡ä»¶
```bash
supervisord -c /etc/supervisord.conf
```

```bash
supervisorctl status
supervisorctl stop tomcat
supervisorctl start tomcat
supervisorctl restart tomcat
supervisorctl reread
supervisorctl update
```

**Source & Reference**
- [Supervisor å®‰è£…ä¸é…ç½® (Linux/Unix è¿›ç¨‹ç®¡ç†å·¥å…·) ](https://blog.csdn.net/xyang81/article/details/51555473)

---

## Webmin

<p align="center">
    <img src="../../../assets/img/logo/Webmin.png" width="35%">
</p>

**å®˜ç½‘**
- http://www.webmin.com/index.html

**å®‰è£…**

åœ¨å®˜ç½‘ä¸‹è½½ RPM åŒ…,ä¸Šä¼ è‡³æœåŠ¡å™¨,è¿™é‡Œä»¥ 1.930-1 ä¸ºä¾‹
```bash
yum install -y perl-Net-SSLeay
yum install -y perl-Encode-Detect
yum install -y perl-Data-Dumper
rpm -Uvh webmin-1.930-1.noarch.rpm

firewall-cmd --permanent --zone=public --add-port=10000/tcp
firewall-cmd --reload
```
å®‰è£…å®Œç›´æ¥å¯åŠ¨,è®¿é—® https://127.0.0.1:10000 æ³¨æ„,å¸¦ HTTPS

é»˜è®¤è´¦å· root,å¯†ç ä¸æœåŠ¡å™¨ä¸€è‡´

**ä¿®æ”¹å¯†ç **

```bash
/usr/libexec/webmin/changepass.pl /etc/webmin/ root 1234qwer
```

---

## Zabbix

<p align="center">
    <img src="../../../assets/img/logo/Zabbix.svg" width="25%">
</p>

> zabbix æ˜¯ä¸€æ¬¾æœåŠ¡å™¨ç›‘æ§è½¯ä»¶,å…¶ç”± serverã€agentã€web ç­‰æ¨¡å—ç»„æˆ,å…¶ä¸­ web æ¨¡å—ç”± PHP ç¼–å†™,ç”¨æ¥æ˜¾ç¤ºæ•°æ®åº“ä¸­çš„ç»“æœ.

**å®˜ç½‘**
- https://www.zabbix.com/

**å®‰è£…ä¾èµ–**
```bash
yum install mysql
yum install httpd
yum install php
yum install php-mysqlnd php-gd libjpeg* php-snmp php-ldap php-odbc php-pear php-xml php-xmlrpc php-mbstring php-bcmath php-mhash php-common php-ctype php-xml php-xmlreader php-xmlwriter php-session php-mbstring php-gettext php-ldap php-mysqli --skip-broken
yum install wget telnet net-tools python-paramiko gcc gcc-c++ dejavu-sans-fonts python-setuptools python-devel sendmail mailx net-snmp net-snmp-devel net-snmp-utils freetype-devel libpng-devel perl unbound libtasn1-devel p11-kit-devel OpenIPMI unixODBC
```

**è®¾ç½® mysql**
```vim
vim /etc/my.cnf

innodb_file_per_table = 1
innodb_status_file = 1
innodb_buffer_pool_size = 6G
innodb_flush_log_at_trx_commit = 2
innodb_log_buffer_size = 16M
innodb_log_file_size = 64M
innodb_support_xa = 0
default-storage-engine = innodb
bulk_insert_buffer_size = 8M
join_buffer_size = 16M
max_heap_table_size = 32M
tmp_table_size = 32M
max_tmp_tables = 48
read_buffer_size = 32M
read_rnd_buffer_size = 16M
key_buffer_size = 32M
thread_cache_size = 32
innodb_thread_concurrency = 8
innodb_flush_method = O_DIRECT
innodb_rollback_on_timeout = 1
query_cache_size = 16M
query_cache_limit = 16M
collation_server = utf8_bin
character_set_server = utf8
```
åŸåˆ™ä¸Š innodb_buffer_pool_size éœ€è¦è®¾ç½®ä¸ºä¸»æœºå†…å­˜çš„ 80%,å¦‚æœä¸»æœºå†…å­˜ä¸æ˜¯ 8GB,ä»¥ä¸Šå‚æ•°å¯ä¾æ®ç›¸åº”æ¯”ä¾‹è¿›è¡Œè°ƒæ•´,ä¾‹å¦‚ä¸»æœºå†…å­˜ä¸º 16GB,åˆ™ innodb_buffer_pool_size å»ºè®®è®¾ç½®ä¸º 12GB,innodb_log_buffer_size å»ºè®®è®¾ç½®ä¸º 32M,innodb_log_file_size å»ºè®®è®¾ç½®ä¸º 128M,ä»¥æ­¤ç±»æ¨.è¯·æ³¨æ„ innodb_buffer_pool_size çš„å€¼å¿…é¡»æ˜¯æ•´æ•°,ä¾‹å¦‚ä¸»æœºå†…å­˜æ˜¯4G,é‚£ä¹ˆ innodb_buffer_pool_size å¯ä»¥è®¾ç½®ä¸º 3G,è€Œä¸èƒ½è®¾ç½®ä¸º 3.2G
```bash
systemctl enable mysqld && systemctl start mysqld
grep 'temporary password' /var/log/mysqld.log   # è·å– MySQL çš„ root åˆå§‹å¯†ç 
mysql_secure_installation                       # åˆå§‹åŒ–,æ”¹ä¸‹å¯†ç 
systemctl restart mysqld
mysql -u root -p
  create database zabbix character set utf8;
  exit;
mysql_upgrade -u root -p
mysql -u root -p
  create user zabbix@'%' identified by '{mysql_zabbix_password}';
  grant all privileges on zabbix.* to zabbix@'%';
  flush privileges;
  exit;
```

**å®‰è£… zabbix**
```bash
rpm -ivh https://repo.zabbix.com/zabbix/4.2/rhel/7/x86_64/zabbix-release-4.2-1.el7.noarch.rpm
yum install -y zabbix-server-mysql zabbix-web-mysql zabbix-java-gateway zabbix-web
cd /usr/share/doc/zabbix-server-mysql-4.2.1
zcat create.sql.gz | mysql -uroot zabbix -p
```

- é…ç½® zabbix å‚æ•°
  ```vim
  vim /etc/zabbix/zabbix_server.conf

  DBPassword={mysql_zabbix_password}
  CacheSize=512M
  HistoryCacheSize=128M
  HistoryIndexCacheSize=128M
  TrendCacheSize=128M
  ValueCacheSize=256M
  Timeout=30
  ```
  å¦‚æœéœ€è¦ç›‘æ§ VMware è™šæ‹Ÿæœº,åˆ™è¿˜éœ€è¦è®¾ç½®ä»¥ä¸‹é€‰é¡¹å‚æ•°:
  ```vim
  StartVMwareCollectors=2
  VMwareCacheSize=256M
  VMwareTimeout=300
  ```

**é…ç½® Apache ä¸­çš„ PHP å‚æ•°**
```vim
vim /etc/httpd/conf.d/zabbix.conf

php_value max_execution_time 600
php_value memory_limit 256M
php_value post_max_size 32M
php_value upload_max_filesize 32M
php_value max_input_time 600
php_value always_populate_raw_post_data -1
date.timezone Asia/Shanghai
```

**é…ç½® PHP å‚æ•°**
```vim
vim /etc/php.ini

php_value post_max_size 32M
max_execution_time 300
max_input_time 300
date.timezone Asia/Shanghai
```

**é‡å¯&èµ·æœåŠ¡**
```bash
systemctl stop mysqld && reboot
systemctl start httpd && systemctl start zabbix-server
systemctl stop firewalld
setenforce 0    # å…³é—­ selinux
```
è®¿é—® `http://ipåœ°å€/zabbix/setup.php`

**Source & Reference**
- [CentOS 7å®‰è£…Zabbix 3.4](https://www.centos.bz/2017/11/centos-7%E5%AE%89%E8%A3%85zabbix-3-4/)

---

# è™šæ‹ŸåŒ–
## Docker

<p align="center">
    <img src="../../../assets/img/logo/Docker.png" width="30%">
</p>

**å®˜ç½‘**
- https://www.docker.com

**ç‰ˆæœ¬åŒºåˆ«**
æœ€æ—©çš„æ—¶å€™dockerå°±æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œä¸»è¦ç”±dockerå…¬å¸ç»´æŠ¤.

- 2017å¹´å¹´åˆï¼Œdocker å…¬å¸å°†åŸå…ˆçš„ docker é¡¹ç›®æ”¹åä¸º mobyï¼Œå¹¶åˆ›å»ºäº†docker-ce å’Œ docker-ee.
- docker-ce æ˜¯ç¤¾åŒºç‰ˆæœ¬ï¼Œé€‚ç”¨äºåˆšåˆšå¼€å§‹ docker å’Œå¼€å‘åŸºäº docker ç ”å‘çš„åº”ç”¨å¼€å‘è€…æˆ–è€…å°å‹å›¢é˜Ÿ.
- docker-ee æ˜¯ä¼ä¸šç‰ˆï¼Œé€‚ç”¨äºä¼ä¸šçº§å¼€å‘ï¼ŒåŒæ ·ä¹Ÿé€‚ç”¨äºå¼€å‘ã€åˆ†å‘å’Œè¿è¡Œå•†åŠ¡çº§åˆ«çš„åº”ç”¨çš„ IT å›¢é˜Ÿ.
- docker-io, docker-engin æ˜¯ä»¥å‰æ—©æœŸçš„ç‰ˆæœ¬.

**å®‰è£…**

- **centos ä¸‹å®‰è£…**
  ```bash
  yum install -y yum-utils device-mapper-persistent-data lvm2
  wget -O /etc/yum.repos.d/docker-ce.repo https://download.docker.com/linux/centos/docker-ce.repo
  sed -i 's+download.docker.com+mirrors.tuna.tsinghua.edu.cn/docker-ce+' /etc/yum.repos.d/docker-ce.repo
  yum makecache fast
  yum install -y docker
  sudo systemctl start docker
  ```

- **debian ä¸‹å®‰è£…**
  ```bash
  apt remove docker docker-engine docker.io
  sudo apt-get install -y \
    apt-transport-https \
    ca-certificates \
    curl \
    software-properties-common \
    gnupg
  curl -fsSL https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu/gpg | sudo apt-key add -
  echo 'deb https://download.docker.com/linux/debian stretch stable'> /etc/apt/sources.list.d/
  apt update
  apt install docker-ce
  docker version
  sudo systemctl start docker
  docker login  # è®²é“ç†,æŒ‰å®˜æ–¹æ–‡æ¡£è¯´æ³•å¹¶ä¸éœ€è¦è´¦æˆ·å¹¶ä¸”ç™»å½•,ä½†æœ‰æ—¶å€™è¿˜æ˜¯éœ€è¦ä½ ç™»é™†
  ```

**ä½¿ç”¨**

é»˜è®¤æƒ…å†µä¸‹,åªæœ‰ç®¡ç†å‘˜æƒé™èƒ½å¤Ÿè¿è¡Œ docker å‘½ä»¤.è€ƒè™‘åˆ°å®‰å…¨é—®é¢˜,ä½ ä¸ä¼šæƒ³ç”¨ root ç”¨æˆ·æˆ–ä½¿ç”¨ sudo æ¥è¿è¡Œ Docker çš„.è¦è§£å†³è¿™ä¸ªé—®é¢˜,ä½ éœ€è¦å°†è‡ªå·±çš„ç”¨æˆ·åŠ å…¥åˆ° docker ç»„ä¸­.
```bash
sudo usermod -a -G docker $USER
```

å®Œæˆæ“ä½œå,ç™»å‡ºç³»ç»Ÿç„¶åå†é‡æ–°ç™»å½•,åº”è¯¥å°±æå®šäº†.ä¸è¿‡è‹¥ä½ çš„å¹³å°æ˜¯ Fedora,åˆ™æ·»åŠ ç”¨æˆ·åˆ° docker ç»„æ—¶ä¼šå‘ç°è¿™ä¸ªç»„æ˜¯ä¸å­˜åœ¨çš„.é‚£è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿä½ éœ€è¦é¦–å…ˆåˆ›å»ºè¿™ä¸ªç»„.å‘½ä»¤å¦‚ä¸‹:
```bash
sudo groupadd docker && sudo gpasswd -a ${USER} docker && sudo systemctl restart docker
newgrp docker
```

å¯åŠ¨,æš‚åœä»¥åŠå¯ç”¨ Docker
```
sudo systemctl start docker
sudo systemctl enable docker
sudo systemctl stop docker
sudo systemctl restart docker
```

æ‹‰å–é•œåƒ
```bash
docker images                   # æ£€æŸ¥ä¸€ä¸‹ç³»ç»Ÿä¸­å·²ç»æœ‰äº†å“ªäº›é•œåƒ
docker pull nginx               # æ‹‰å–ä¸€ä¸ªé•œåƒ
docker search nginx             # æœç´¢ Docker Hub ä¸­çš„æ‰€æœ‰ Nginx é•œåƒ
docker pull jwilder/nginx-proxy # ä»éå®˜æ–¹æºæ‹‰å–é•œåƒ
```

å¸¸ç”¨å‘½ä»¤
```bash
docker run -it <docker_id> bash             # è¿è¡Œä¸€ä¸ªå®¹å™¨å®ä¾‹
docker stop <docker_name/docker_id>         # åœæ­¢å®¹å™¨
docker exec -it <docker_id> bash            # è·å–å®¹å™¨çš„shell
docker kill                                 # æ€æ­»å®¹å™¨
docker commit <docker_id> <docker_image_id> # æäº¤å¹¶ä¿å­˜å®¹å™¨çŠ¶æ€
docker rm <docker_name/docker_id>           # åˆ é™¤å®¹å™¨
docker ps                                   # æŸ¥çœ‹å½“å‰è¿è¡Œçš„ docker å®¹å™¨çš„è¿›ç¨‹ä¿¡æ¯
  docker ps -a                              # æŸ¥çœ‹å½“å‰å®¹å™¨
docker stats                                # ç»Ÿè®¡ä¿¡æ¯

docker search <keyword>                     # æœç´¢é•œåƒ
docker image ls                             # æŸ¥çœ‹å·²ä¸‹è½½çš„é•œåƒåˆ—è¡¨
docker image rm <docker_image_id>           # åˆ é™¤æœ¬åœ°çš„ docker é•œåƒ
docker rmi -f <docker_image_id>             # åˆ é™¤æœ¬åœ°çš„ docker é•œåƒ
```

**åŠ é€Ÿ**
- [Docker é•œåƒåŠ é€Ÿ](../../Plan/Misc-Plan.md#Docker)

**æ‰©å±•é¡¹ç›®**
- [instantbox](https://github.com/instantbox/instantbox) - è„šæœ¬å®ç°çš„ä¸€ä¸ª docker è™šæ‹ŸåŒ–å¹³å°,å¿«é€Ÿè·å¾—å¼€ç®±å³ç”¨çš„çƒ­ä¹ä¹çš„è™šæ‹ŸæœºğŸ˜

### Docker-Compose

<p align="center">
    <img src="../../../assets/img/logo/Compose.png" width="50%">
</p>

> Docker-Compose æ˜¯ä¸€ä¸ªéƒ¨ç½²å¤šä¸ªå®¹å™¨çš„ç®€å•ä½†æ˜¯éå¸¸å¿…è¦çš„å·¥å…·.

**é¡¹ç›®åœ°å€**
- https://github.com/docker/compose

**å®‰è£…**

ä¸‹è½½äºŒè¿›åˆ¶åŒ… https://github.com/docker/compose/releases

ç„¶åå°†æ–‡ä»¶ä¸Šä¼ åˆ° `/usr/local/bin/` æ–‡ä»¶å¤¹ä¸‹,ç„¶åå°†å…¶é‡å‘½åä¸º docker-compose,ä¿®æ”¹æ­¤æ–‡ä»¶çš„æƒé™,å¢åŠ å¯æ‰§è¡Œæƒé™

```bash
wget https://github.com/docker/compose/releases/download/1.25.5/docker-compose-Linux-x86_64
mv docker-compose-Linux-x86_64 /usr/local/bin/docker-compose
sudo chmod +x /usr/local/bin/docker-compose
```

```bash
docker-compose build
docker-compose up -d
docker-compose stop
```

```bash
docker-compose ps     # æŸ¥çœ‹å½“å‰çš„ä½¿ç”¨ docker-compose up -d å¼€å¯çš„å®¹å™¨è¿›ç¨‹ä¿¡æ¯
docker-compose up -d  # ä½¿ç”¨æœ¬åœ°çš„ docker-compose.yml å¼€å¯ç›¸å…³çš„å®¹å™¨
docker-compose down   # ç»ˆæ­¢å½“å‰çš„ä½¿ç”¨ docker-compose up -d å¼€å¯çš„å®¹å™¨
docker-compose exec <service> sh  # è¿›å…¥å®¹å™¨å†…
```

### Docker-Portainer

<p align="center">
    <img src="../../../assets/img/logo/Portainer.png" width="30%">
</p>

> Portainer æ˜¯ Docker ä¸€æ¬¾å¯è§†åŒ–ç®¡ç†ç”¨å…·ï¼Œéƒ¨ç½²ç®€å•ï¼Œæ¨èã€‚

**å®˜ç½‘**
- https://www.portainer.io/

**éƒ¨ç½²**
```bash
docker pull portainer/portainer # æ‹‰å–é•œåƒ
docker volume create portainer_data
docker run -d -p 9000:9000 --name portainer --restart always -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data portainer/portainer   # éƒ¨ç½²
```
è®¿é—® <ip>:9000 è¿›å…¥åˆ°è®¾ç½®å¯†ç ç•Œé¢.

---

## QEMU

<p align="center">
    <img src="../../../assets/img/logo/QEMU.png" width="25%">
</p>

> QEMU æ˜¯ä¸€æ¬¾å¼€æºçš„æ¨¡æ‹Ÿå™¨åŠè™šæ‹Ÿæœºç›‘ç®¡å™¨ã€‚QEMU ä¸»è¦æä¾›ä¸¤ç§åŠŸèƒ½ç»™ç”¨æˆ·ä½¿ç”¨ã€‚ä¸€æ˜¯ä½œä¸ºç”¨æˆ·æ€æ¨¡æ‹Ÿå™¨ï¼Œåˆ©ç”¨åŠ¨æ€ä»£ç ç¿»è¯‘æœºåˆ¶æ¥æ‰§è¡Œä¸åŒäºä¸»æœºæ¶æ„çš„ä»£ç ã€‚äºŒæ˜¯ä½œä¸ºè™šæ‹Ÿæœºç›‘ç®¡å™¨ï¼Œæ¨¡æ‹Ÿå…¨ç³»ç»Ÿï¼Œåˆ©ç”¨å…¶ä»–VMM(Xen, KVM, etc)æ¥ä½¿ç”¨ç¡¬ä»¶æä¾›çš„è™šæ‹ŸåŒ–æ”¯æŒï¼Œåˆ›å»ºæ¥è¿‘äºä¸»æœºæ€§èƒ½çš„è™šæ‹Ÿæœºã€‚

**å®˜ç½‘**
- https://www.qemu.org/

**é¡¹ç›®åœ°å€**
- https://github.com/qemu/QEMU

**å®‰è£…**
- Centosä¸‹
  ```bash
  yum install -y qemu
  ```

- Ubuntuä¸‹
  ```bash
  apt-get install -y qemu
  ```

---

# åˆ†å¸ƒå¼
## ZooKeeper

<p align="center">
    <img src="../../../assets/img/logo/ZooKeeper.png" width="35%">
    <p align="center">è¿™ä¸ªLogoæ˜¯ä»€ä¹ˆé¬¼å•ŠğŸ¤£ğŸ¤£ğŸ¤£,ç¬‘æ­»æˆ‘äº†
</p>

**å®˜ç½‘**
- https://zookeeper.apache.org/

**å®‰è£…**

ä¾èµ– jdk,å®‰è£…è¿‡ç¨‹è§ [JDK](#jdk)

zookeeper æ”¯æŒä¸¤ç§è¿è¡Œæ¨¡å¼:ç‹¬ç«‹æ¨¡å¼(standalone)å’Œå¤åˆ¶æ¨¡å¼(replicated).

çœŸæ­£ç”¨äºç”Ÿäº§ç¯å¢ƒçš„ Zookeeper è‚¯å®šéƒ½æ˜¯ä½¿ç”¨å¤åˆ¶æ¨¡å¼çš„,è¿™æ ·åšå¯ä»¥é¿å…å•ç‚¹é—®é¢˜.æƒ³è¦ä½¿ç”¨å¤åˆ¶æ¨¡å¼,ä½†ç”±äºæ²¡æœ‰å¯Œä½™çš„æœºå™¨èƒ½å¤Ÿä½¿ç”¨,æ‰€ä»¥å¯ä»¥åœ¨å•å°æœºå™¨ä¸Šé€šè¿‡é…ç½®æ¥ä½¿ç”¨å¤åˆ¶æ¨¡å¼,ä»è€Œæ¨¡æ‹ŸçœŸå®çš„é›†ç¾¤ç¯å¢ƒ.

ç”±äº Zookeeper é›†ç¾¤æ˜¯é€šè¿‡å¤šæ•°é€‰ä¸¾çš„æ–¹å¼äº§ç”Ÿ leader çš„,å› æ­¤,é›†ç¾¤éœ€è¦å¥‡æ•°ä¸ª Zookeeper å®ä¾‹ç»„æˆ,ä¹Ÿå°±æ˜¯è¯´è‡³å°‘éœ€è¦3å°(1å°ä¸èƒ½ç®—"ç¾¤").

è¿™é‡Œé…ç½®çš„ä¸º `ç‹¬ç«‹æ¨¡å¼`

```bash
wget https://mirrors.tuna.tsinghua.edu.cn/apache/zookeeper/zookeeper-3.4.14/zookeeper-3.4.14.tar.gz
mkdir /usr/local/zookeeper
tar -zxvf zookeeper-3.4.14.tar.gz -C /usr/local/zookeeper/

cd /usr/local/zookeeper/zookeeper-3.4.14/conf/
cp zoo_sample.cfg zoo.cfg
```

åˆ›å»ºæ•°æ®å­˜å‚¨ç›®å½•ä¸æ—¥å¿—ç›®å½•
```bash
mkdir /usr/local/zookeeper/zookeeper-3.4.14/dataDir
mkdir /usr/local/zookeeper/zookeeper-3.4.14/dataLogDir
```

ä¿®æ”¹æ•°æ®å­˜å‚¨å’Œæ—¥å¿—ç›®å½•
```vim
vim /usr/local/zookeeper/zookeeper-3.4.14/conf/zoo.cfg

dataDir=/usr/local/zookeeper/zookeeper-3.4.14/dataDir
dataLogDir=/usr/local/zookeeper/zookeeper-3.4.14/dataLogDir
```
```bash
# å¯åŠ¨
/usr/local/zookeeper/zookeeper-3.4.14/bin/zkServer.sh start

# è¿æ¥
/usr/local/zookeeper/zookeeper-3.4.14/bin/zkCli.sh
```

---

# å®‰å…¨æœåŠ¡
## ClamAV

<p align="center">
    <img src="../../../assets/img/logo/ClamAV.webp" width="25%">
</p>

> ä¸€ä¸ªå¼€æºé˜²ç—…æ¯’å¼•æ“,ç”¨äºæ£€æµ‹æœ¨é©¬,ç—…æ¯’,æ¶æ„è½¯ä»¶å’Œå…¶ä»–æ¶æ„å¨èƒ.

**å®˜ç½‘**
- https://www.clamav.net

**ç¼–è¯‘å®‰è£…**

æ¨èç¼–è¯‘å®‰è£…,æ—¶é—´é•¿ç‚¹,èµ·ç æ­¥éª¤ä¸ç¹ç

å®‰è£…
```bash
yum -y install gcc-c++ pcre-devel zlib-devel openssl-devel llvm-devel libxml2 libxml2-devel libcurl-devel libcurl

wget https://www.clamav.net/downloads/production/clamav-0.102.2.tar.gz
tar -zxvf clamav-0.102.2.tar.gz
cd clamav-0.102.2
./configure --prefix=/opt/clamav --disable-clamonacc    # å¿½ç•¥libcurlåº“çš„æ›´æ–°é—®é¢˜
make && make install
```
```bash
# æ·»åŠ ç”¨æˆ·ç»„clamavå’Œç»„æˆå‘˜clamav
groupadd clamav
useradd -g clamav -s /bin/false clamav

# åˆ›å»ºç›®å½•
mkdir /opt/clamav/logs
mkdir /opt/clamav/updata

# åˆ›å»ºæ–‡ä»¶
touch /opt/clamav/logs/freshclam.log
touch /opt/clamav/logs/clamd.log

# åˆå§‹åŒ–é…ç½®æ–‡ä»¶
cp /opt/clamav/etc/clamd.conf.sample /opt/clamav/etc/clamd.conf
cp /opt/clamav/etc/freshclam.conf.sample /opt/clamav/etc/freshclam.conf
```

ç¼–è¾‘é…ç½®æ–‡ä»¶
```vim
vim /opt/clamav/etc/clamd.conf

# Example æ³¨é‡Šæ‰è¿™ä¸€è¡Œ
å¢åŠ ä»¥ä¸‹å†…å®¹
LogFile /opt/clamav/logs/clamd.log
PidFile /opt/clamav/updata/clamd.pid
DatabaseDirectory /opt/clamav/updata
```
```vim
vim /opt/clamav/etc/freshclam.conf

# Example æ³¨é‡Šæ‰è¿™ä¸€è¡Œ
```

å‡çº§ç—…æ¯’åº“
```bash
mkdir -p /opt/clamav/share/clamav
chown clamav:clamav /opt/clamav/share/clamav
/opt/clamav/bin/freshclam
```

ä½¿ç”¨
```bash
/opt/clamav/bin/clamscan -h                 # æŸ¥çœ‹ç›¸åº”çš„å¸®åŠ©ä¿¡æ¯
/opt/clamav/bin/clamscan -r /               # æ‰«æè®¡ç®—æœºä¸Šçš„æ‰€æœ‰æ–‡ä»¶å¹¶ä¸”æ˜¾ç¤ºæ‰€æœ‰çš„æ–‡ä»¶çš„æ‰«æç»“æœ
/opt/clamav/bin/clamscan -r --bell -i /.    # æ‰«æè®¡ç®—æœºä¸Šçš„æ‰€æœ‰æ–‡ä»¶å¹¶ä¸”æ˜¾ç¤ºæœ‰é—®é¢˜çš„æ–‡ä»¶çš„æ‰«æç»“æœ
/opt/clamav/bin/clamscan -r /home           # æ‰«ææ‰€æœ‰ç”¨æˆ·çš„ä¸»ç›®å½•
```

**yum å®‰è£…**

ä»¥ä¸‹éƒ¨åˆ†å†…å®¹æ¥è‡ª <sup>[[Centos7å®‰è£…å’Œä½¿ç”¨ClamAVæ€æ¯’è½¯ä»¶](https://blog.51cto.com/11199460/2083697)]</sup> åœ¨æ­¤ä»…ä½œæ’ç‰ˆè°ƒæ•´

```bash
yum install -y epel-release
yum install -y clamav-server clamav-data clamav-update clamav-filesystem clamav clamav-scanner-systemd clamav-devel clamav-lib clamav-server-systemd

# åœ¨ä¸¤ä¸ªé…ç½®æ–‡ä»¶ /etc/freshclam.conf å’Œ /etc/clamd.d/scan.conf ä¸­ç§»é™¤"Example"å­—ç¬¦
cp /etc/freshclam.conf /etc/freshclam.conf.bak
sed -i -e "s/^Example/#Example/" /etc/freshclam.conf

cp /etc/clamd.d/scan.conf /etc/clamd.d/scan.conf.bak
sed -i -e "s/^Example/#Example/" /etc/clamd.d/scan.conf
```

å…³é—­è‡ªåŠ¨æ›´æ–°
freshclam å‘½ä»¤é€šè¿‡æ–‡ä»¶ /etc/cron.d/clamav-update æ¥è‡ªåŠ¨è¿è¡Œ

ä½†é»˜è®¤æƒ…å†µä¸‹æ˜¯ç¦æ­¢äº†è‡ªåŠ¨æ›´æ–°åŠŸèƒ½,éœ€è¦ç§»é™¤æ–‡ä»¶ /etc/sysconfig/freshclam æœ€åä¸€è¡Œçš„é…ç½®æ‰èƒ½å¯ç”¨
```vim
vim /etc/sysconfig/freshclam

# FRESHCLAM_DELAY=
```

å®šä¹‰æœåŠ¡å™¨ç±»å‹ (æœ¬åœ°æˆ–è€… TCP) ,åœ¨è¿™é‡Œå®šä¹‰ä¸ºä½¿ç”¨æœ¬åœ° socket,å°†æ–‡ä»¶ /etc/clam.d/scan.conf ä¸­çš„è¿™ä¸€è¡Œå‰é¢çš„æ³¨é‡Šç¬¦å·å»æ‰:
```vim
vim /etc/clamd.d/scan.conf

LocalSocket /var/run/clamd.scan/clamd.sock
```

ä¸‹è½½ç—…æ¯’åº“ https://www.clamav.net/downloads å°† main.cvd\daily.cvd\bytecode.cvd ä¸‰ä¸ªæ–‡ä»¶ä¸‹è½½åä¸Šä¼ åˆ° /var/lib/clamav ç›®å½•ä¸‹
```bash
wget http://database.clamav.net/main.cvd
wget http://database.clamav.net/daily.cvd
wget http://database.clamav.net/bytecode.cvd

mv main.cvd /var/lib/clamav -f
mv daily.cvd /var/lib/clamav -f
mv bytecode.cvd /var/lib/clamav -f
```
```vim
vim /etc/freshclam.conf

DatabaseDirectory /var/lib/clamav
```
```bash
systemctl enable clamd@scan.service
ln -s '/usr/lib/systemd/system/clamd@scan.service' '/etc/systemd/system/multi-user.target.wants/clamd@scan.service'
```

æ›´æ–°ç—…æ¯’åº“
```bash
vim /usr/lib/systemd/system/clam-freshclam.service

# Run the freshclam as daemon
[Unit]
Description = freshclam scanner
After = network.target

[Service]
Type = forking
ExecStart = /usr/bin/freshclam -d -c 4
Restart = on-failure
PrivateTmp = true

[Install]
WantedBy=multi-user.target
```
```bash
systemctl start clam-freshclam.service
systemctl status clam-freshclam.service
freshclam
systemctl enable clam-freshclam.service
cp /usr/share/clamav/template/clamd.conf /etc/clamd.conf
```
```vim
vim /etc/clamd.conf

TCPSocket 3310
TCPAddr 127.0.0.1
```
```bash
/usr/sbin/clamd restart
clamdscan -V

systemctl start clamd@scan.service
systemctl status clamd@scan.service
```

æŸ¥æ€ç—…æ¯’
```bash
clamscan -r /home       # æ‰«ææ‰€æœ‰ç”¨æˆ·çš„ä¸»ç›®å½•å°±ä½¿ç”¨
clamscan -r --bell -i / # æ‰«ææ‰€æœ‰æ–‡ä»¶å¹¶ä¸”æ˜¾ç¤ºæœ‰é—®é¢˜çš„æ–‡ä»¶çš„æ‰«æç»“æœ
clamscan -r --remove    # æŸ¥æ€å½“å‰ç›®å½•å¹¶åˆ é™¤æ„ŸæŸ“çš„æ–‡ä»¶
```

---

## Fail2Ban

<p align="center">
    <img src="../../../assets/img/logo/Fail2Ban.jpg" width="25%">
</p>

> ç¦æ­¢å¯¼è‡´å¤šæ¬¡èº«ä»½éªŒè¯é”™è¯¯çš„ä¸»æœº

**é¡¹ç›®åœ°å€**
- https://github.com/fail2ban/fail2ban

ä»¥ä¸‹éƒ¨åˆ†å†…å®¹æ¥è‡ª <sup>[[å¦‚ä½•ä½¿ç”¨ fail2ban é˜²å¾¡ SSH æœåŠ¡å™¨çš„æš´åŠ›ç ´è§£æ”»å‡»](https://linux.cn/article-5067-1.html)]</sup> åœ¨æ­¤ä»…ä½œæ’ç‰ˆè°ƒæ•´

**å®‰è£…**

RHEL: `yum install fail2ban`

Debian: `apt install fail2ban`

**ç¼–è¾‘é…ç½®æ–‡ä»¶**
```vim
vim /etc/fail2ban/jail.conf

[DEFAULT]
# ä»¥ç©ºæ ¼åˆ†éš”çš„åˆ—è¡¨,å¯ä»¥æ˜¯ IP åœ°å€ã€CIDR å‰ç¼€æˆ–è€… DNS ä¸»æœºå
# ç”¨äºæŒ‡å®šå“ªäº›åœ°å€å¯ä»¥å¿½ç•¥ fail2ban é˜²å¾¡
ignoreip = 127.0.0.1 172.31.0.0/24 10.10.0.0/24 192.168.0.0/24

# å®¢æˆ·ç«¯ä¸»æœºè¢«ç¦æ­¢çš„æ—¶é•¿ (ç§’) ,-1ä»£è¡¨æ°¸è¿œ
bantime = 10m

# å®¢æˆ·ç«¯ä¸»æœºè¢«ç¦æ­¢å‰å…è®¸å¤±è´¥çš„æ¬¡æ•°
maxretry = 5

# é—´éš”æ—¶é—´ (ç§’) ,é—´éš”æ—¶é—´å†…è¶…è¿‡æœ€å¤§å°è¯•æ¬¡æ•°å³è¢«å°é”
findtime = 10m

mta = sendmail

[ssh-iptables]
enabled = true
filter = sshd
action = iptables[name=SSH, port=ssh, protocol=tcp]
sendmail-whois[name=SSH, dest=your@email.com, sender=fail2ban@email.com]
# Debian ç³»çš„å‘è¡Œç‰ˆ
logpath = /var/log/auth.log
# Red Hat ç³»çš„å‘è¡Œç‰ˆ
logpath = /var/log/secure
# ssh æœåŠ¡çš„æœ€å¤§å°è¯•æ¬¡æ•°
maxretry = 3
```

æ ¹æ®ä¸Šè¿°é…ç½®,fail2ban ä¼šè‡ªåŠ¨ç¦æ­¢åœ¨æœ€è¿‘ 10 åˆ†é’Ÿå†…æœ‰è¶…è¿‡ 3 æ¬¡è®¿é—®å°è¯•å¤±è´¥çš„ä»»æ„ IP åœ°å€.ä¸€æ—¦è¢«ç¦,è¿™ä¸ª IP åœ°å€å°†ä¼šåœ¨ 24 å°æ—¶å†…ä¸€ç›´è¢«ç¦æ­¢è®¿é—® SSH æœåŠ¡.è¿™ä¸ªäº‹ä»¶ä¹Ÿä¼šé€šè¿‡ sendemail å‘é€é‚®ä»¶é€šçŸ¥.

**æµ‹è¯•**
```bash
service fail2ban restart

# ä¸ºäº†éªŒè¯ fail2ban æˆåŠŸè¿è¡Œ,ä½¿ç”¨å‚æ•°'ping'æ¥è¿è¡Œ fail2ban-client å‘½ä»¤. å¦‚æœ fail2ban æœåŠ¡æ­£å¸¸è¿è¡Œ,ä½ å¯ä»¥çœ‹åˆ°"pong (å˜­) "ä½œä¸ºå“åº”.
fail2ban-client ping
```

ä¸ºäº†æµ‹è¯• fail2ban æ˜¯å¦èƒ½æ­£å¸¸å·¥ä½œ,å°è¯•é€šè¿‡ä½¿ç”¨é”™è¯¯çš„å¯†ç æ¥ç”¨ SSH è¿æ¥åˆ°æœåŠ¡å™¨æ¨¡æ‹Ÿä¸€ä¸ªæš´åŠ›ç ´è§£æ”»å‡».ä¸æ­¤åŒæ—¶,ç›‘æ§ `/var/log/fail2ban.log` ,è¯¥æ–‡ä»¶è®°å½•åœ¨ fail2ban ä¸­å‘ç”Ÿçš„ä»»ä½•æ•æ„Ÿäº‹ä»¶.

```bash
tail -f /var/log/fail2ban.log
2019-07-24 23:33:34,369 fail2ban.jail           [14760]: INFO    Initiated 'pyinotify' backend
2019-07-24 23:33:34,370 fail2ban.filter         [14760]: INFO      maxLines: 1
2019-07-24 23:33:34,372 fail2ban.server         [14760]: INFO    Jail ssh-iptables is not a JournalFilter instance
2019-07-24 23:33:34,373 fail2ban.filter         [14760]: INFO    Added logfile: '/var/log/auth.log' (pos = 0, hash = de62b1aacfb0f9a9082c515fe3cdb77214101d93)
2019-07-24 23:33:34,377 fail2ban.filter         [14760]: INFO      encoding: UTF-8
2019-07-24 23:33:34,378 fail2ban.filter         [14760]: INFO      maxRetry: 3
2019-07-24 23:33:34,378 fail2ban.filter         [14760]: INFO      findtime: 600
2019-07-24 23:33:34,378 fail2ban.actions        [14760]: INFO      banTime: 600
2019-07-24 23:33:34,381 fail2ban.jail           [14760]: INFO    Jail 'sshd' started
2019-07-24 23:33:34,382 fail2ban.jail           [14760]: INFO    Jail 'ssh-iptables' started
2019-07-24 23:35:58,780 fail2ban.filter         [14760]: INFO    [ssh-iptables] Found 192.168.72.130 - 2019-07-24 23:35:58
2019-07-24 23:36:00,397 fail2ban.filter         [14760]: INFO    [ssh-iptables] Found 192.168.72.130 - 2019-07-24 23:36:00
2019-07-24 23:36:03,811 fail2ban.filter         [14760]: INFO    [sshd] Found 192.168.72.130 - 2019-07-24 23:35:58
2019-07-24 23:36:03,812 fail2ban.filter         [14760]: INFO    [sshd] Found 192.168.72.130 - 2019-07-24 23:36:00
2019-07-24 23:36:04,266 fail2ban.filter         [14760]: INFO    [sshd] Found 192.168.72.130 - 2019-07-24 23:36:04
2019-07-24 23:36:04,310 fail2ban.filter         [14760]: INFO    [ssh-iptables] Found 192.168.72.130 - 2019-07-24 23:36:04
2019-07-24 23:36:04,778 fail2ban.actions        [14760]: NOTICE  [ssh-iptables] Ban 192.168.72.130
```

æ ¹æ®ä¸Šè¿°çš„æ—¥å¿—æ–‡ä»¶,Fail2ban é€šè¿‡æ£€æµ‹ IP åœ°å€çš„å¤šæ¬¡å¤±è´¥ç™»å½•å°è¯•,ç¦æ­¢äº†ä¸€ä¸ª IP åœ°å€ 192.168.72.130

**è§£ç¦ IP**

ç”±äº fail2ban çš„"ssh-iptables"ç›‘ç‹±ä½¿ç”¨ iptables æ¥é˜»å¡é—®é¢˜ IP åœ°å€,ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æ¥æ£€æµ‹å½“å‰ iptables æ¥éªŒè¯ç¦æ­¢è§„åˆ™.
```bash
iptables --list -n
iptables -D fail2ban-SSH -s 192.168.72.130 -j DROP
```
å½“ç„¶ä½ å¯ä»¥ä½¿ç”¨ä¸Šè¿°çš„ iptables å‘½ä»¤æ‰‹åŠ¨åœ°æ£€éªŒå’Œç®¡ç† fail2ban çš„ IP é˜»å¡åˆ—è¡¨,ä½†å®é™…ä¸Šæœ‰ä¸€ä¸ªé€‚å½“çš„æ–¹æ³•å°±æ˜¯ä½¿ç”¨ fail2ban-client å‘½ä»¤è¡Œå·¥å…·.è¿™ä¸ªå‘½ä»¤ä¸ä»…å…è®¸ä½ å¯¹"ssh-iptables"ç›‘ç‹±è¿›è¡Œç®¡ç†,åŒæ—¶ä¹Ÿæ˜¯ä¸€ä¸ªæ ‡å‡†çš„å‘½ä»¤è¡Œæ¥å£,å¯ä»¥ç®¡ç†å…¶ä»–ç±»å‹çš„ fail2ban ç›‘ç‹±.
```bash
fail2ban-client status                                  # æ£€éªŒ fail2ban çŠ¶æ€

fail2ban-client status ssh-iptables                     # æ£€éªŒä¸€ä¸ªç‰¹å®šç›‘ç‹±çš„çŠ¶æ€

fail2ban-client set ssh-iptables unbanip 192.168.72.130 # è§£é”ç‰¹å®šçš„ IP åœ°å€
```
æ³¨æ„,å¦‚æœä½ åœæ­¢äº† Fail2ban æœåŠ¡,é‚£ä¹ˆæ‰€æœ‰çš„ IP åœ°å€éƒ½ä¼šè¢«è§£é”.å½“ä½ é‡å¯ Fail2ban,å®ƒä¼šä» `/etc/log/secure`(æˆ– `/var/log/auth.log`)ä¸­æ‰¾åˆ°å¼‚å¸¸çš„ IP åœ°å€åˆ—è¡¨,å¦‚æœè¿™äº›å¼‚å¸¸åœ°å€çš„å‘ç”Ÿæ—¶é—´ä»ç„¶åœ¨ç¦æ­¢æ—¶é—´å†…,é‚£ä¹ˆ Fail2ban ä¼šé‡æ–°å°†è¿™äº› IP åœ°å€ç¦æ­¢.

---

## OpenLDAP

<p align="center">
    <img src="../../../assets/img/logo/OpenLDAP.png" width="25%">
</p>

> OpenLDAP æ˜¯è½»å‹ç›®å½•è®¿é—®åè®®ï¼ˆLightweight Directory Access Protocolï¼ŒLDAPï¼‰çš„è‡ªç”±å’Œå¼€æºçš„å®ç°ï¼Œåœ¨å…¶ OpenLDAP è®¸å¯è¯ä¸‹å‘è¡Œï¼Œå¹¶å·²ç»è¢«åŒ…å«åœ¨ä¼—å¤šæµè¡Œçš„ Linux å‘è¡Œç‰ˆä¸­ã€‚

ä»¥ä¸‹éƒ¨åˆ†å†…å®¹æ¥è‡ª <sup>[[Centos7 æ­å»ºopenldapå®Œæ•´è¯¦ç»†æ•™ç¨‹](https://blog.csdn.net/weixin_41004350/article/details/89521170)]</sup> ä»…ä½œæ’ç‰ˆå¤„ç†å’Œéƒ¨åˆ†å†…å®¹å¤„ç†

**å®‰è£…**
```bash
yum install -y openldap openldap-clients openldap-servers

# å¤åˆ¶ä¸€ä¸ªé»˜è®¤é…ç½®åˆ°æŒ‡å®šç›®å½•ä¸‹,å¹¶æˆæƒï¼Œè¿™ä¸€æ­¥ä¸€å®šè¦åšï¼Œç„¶åå†å¯åŠ¨æœåŠ¡ï¼Œä¸ç„¶ç”Ÿäº§å¯†ç æ—¶ä¼šæŠ¥é”™
cp /usr/share/openldap-servers/DB_CONFIG.example /var/lib/ldap/DB_CONFIG

# æˆæƒç»™ ldap ç”¨æˆ·,æ­¤ç”¨æˆ· yum å®‰è£…æ—¶ä¾¿ä¼šè‡ªåŠ¨åˆ›å»º
chown -R ldap. /var/lib/ldap/DB_CONFIG
```

```bash
systemctl start slapd   # å¯åŠ¨æœåŠ¡ï¼Œå…ˆå¯åŠ¨æœåŠ¡ï¼Œé…ç½®åé¢å†è¿›è¡Œä¿®æ”¹
systemctl enable slapd

systemctl status slapd  # æŸ¥çœ‹çŠ¶æ€ï¼Œæ­£å¸¸å¯åŠ¨åˆ™ok
```

**ä¿®æ”¹é…ç½®**

openldap2.4.23 ç‰ˆæœ¬å¼€å§‹ï¼Œæ‰€æœ‰é…ç½®éƒ½ä¿å­˜åœ¨ `/etc/openldap/slapd.d` ç›®å½•ä¸‹çš„ cn=config æ–‡ä»¶å¤¹å†…ï¼Œä¸å†ä½¿ç”¨ slapd.conf ä½œä¸ºé…ç½®æ–‡ä»¶ã€‚é…ç½®æ–‡ä»¶çš„åç¼€ä¸º ldifï¼Œä¸”æ¯ä¸ªé…ç½®æ–‡ä»¶éƒ½æ˜¯é€šè¿‡å‘½ä»¤è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œä»»æ„æ‰“å¼€ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œåœ¨å¼€å¤´éƒ½ä¼šæœ‰ä¸€è¡Œæ³¨é‡Šï¼Œè¯´æ˜æ­¤ä¸ºè‡ªåŠ¨ç”Ÿæˆçš„æ–‡ä»¶ï¼Œè¯·å‹¿ç¼–è¾‘ï¼Œä½¿ç”¨ ldapmodify å‘½ä»¤è¿›è¡Œä¿®æ”¹ `# AUTO-GENERATED FILE - DO NOT EDIT!! Use ldapmodify.`

å®‰è£… openldap åï¼Œä¼šæœ‰ä¸‰ä¸ªå‘½ä»¤ç”¨äºä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œåˆ†åˆ«ä¸º ldapadd, ldapmodify, ldapdeleteï¼Œé¡¾åæ€ä¹‰å°±æ˜¯æ·»åŠ ï¼Œä¿®æ”¹å’Œåˆ é™¤ã€‚è€Œéœ€è¦ä¿®æ”¹æˆ–å¢åŠ é…ç½®æ—¶ï¼Œåˆ™éœ€è¦å…ˆå†™ä¸€ä¸ª ldif åç¼€çš„é…ç½®æ–‡ä»¶ï¼Œç„¶åé€šè¿‡å‘½ä»¤å°†å†™çš„é…ç½®æ›´æ–°åˆ° `slapd.d` ç›®å½•ä¸‹çš„é…ç½®æ–‡ä»¶ä¸­å»

ç”Ÿæˆç®¡ç†å‘˜å¯†ç 
```bash
slappasswd -s 123456
{SSHA}qG8fxSKCrgt0KiN8cwQMzvymgQLJeh/k
```

æ–°å¢ä¿®æ”¹å¯†ç æ–‡ä»¶,ldif ä¸ºåç¼€ï¼Œæ–‡ä»¶åéšæ„ï¼Œä¸è¦åœ¨ /etc/openldap/slapd.d/ ç›®å½•ä¸‹åˆ›å»ºç±»ä¼¼æ–‡ä»¶,ç”Ÿæˆçš„æ–‡ä»¶ä¸ºéœ€è¦é€šè¿‡å‘½ä»¤å»åŠ¨æ€ä¿®æ”¹ ldap ç°æœ‰é…ç½®ï¼Œå¦‚ä¸‹
```bash
cd ~
vim changepwd.ldif

dn: olcDatabase={0}config,cn=config
changetype: modify
add: olcRootPW
olcRootPW: {SSHA}qG8fxSKCrgt0KiN8cwQMzvymgQLJeh/k
```

- ç¬¬ä¸€è¡Œæ‰§è¡Œé…ç½®æ–‡ä»¶ï¼Œè¿™é‡Œå°±è¡¨ç¤ºæŒ‡å®šä¸º cn=config/olcDatabase={0}config æ–‡ä»¶ã€‚ä½ åˆ° `/etc/openldap/slapd.d/` ç›®å½•ä¸‹å°±èƒ½æ‰¾åˆ°æ­¤æ–‡ä»¶
- ç¬¬äºŒè¡Œ changetype æŒ‡å®šç±»å‹ä¸ºä¿®æ”¹
- ç¬¬ä¸‰è¡Œ add è¡¨ç¤ºæ·»åŠ  olcRootPW é…ç½®é¡¹
- ç¬¬å››è¡ŒæŒ‡å®š olcRootPW é…ç½®é¡¹çš„å€¼

åœ¨æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤å‰ï¼Œä½ å¯ä»¥å…ˆæŸ¥çœ‹åŸæœ¬çš„ olcDatabase={0}config æ–‡ä»¶ï¼Œé‡Œé¢æ˜¯æ²¡æœ‰ olcRootPW è¿™ä¸ªé¡¹çš„ï¼Œæ‰§è¡Œå‘½ä»¤åï¼Œä½ å†çœ‹å°±ä¼šæ–°å¢äº† olcRootPW é¡¹ï¼Œè€Œä¸”å†…å®¹æ˜¯æˆ‘ä»¬æ–‡ä»¶ä¸­æŒ‡å®šçš„å€¼åŠ å¯†åçš„å­—ç¬¦ä¸²

æ‰§è¡Œå‘½ä»¤ï¼Œä¿®æ”¹ ldap é…ç½®ï¼Œé€šè¿‡ -f æ‰§è¡Œæ–‡ä»¶
```bash
ldapadd -Y EXTERNAL -H ldapi:/// -f changepwd.ldif
```

æ‰§è¡Œä¿®æ”¹å‘½ä»¤åï¼Œæœ‰ç±»ä¼¼å¦‚ä¸‹è¾“å‡ºåˆ™ä¸ºæ­£å¸¸
```
SASL/EXTERNAL authentication started
SASL username: gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth
SASL SSF: 0
modifying entry "olcDatabase={0}config,cn=config"
```

æŸ¥çœ‹ olcDatabase={0}config å†…å®¹,åº”è¯¥ä¼šæ–°å¢äº†ä¸€ä¸ª olcRootPW é¡¹
```bash
cat /etc/openldap/slapd.d/cn\=config/olcDatabase\=\{0\}config.ldif
```

ä¸Šé¢å°±æ˜¯ä¸€ä¸ªå®Œæ•´çš„ä¿®æ”¹é…ç½®çš„è¿‡ç¨‹ï¼Œåˆ‡è®°ä¸èƒ½ç›´æ¥ä¿®æ”¹ `/etc/openldap/slapd.d/` ç›®å½•ä¸‹çš„é…ç½®ã€‚

æˆ‘ä»¬éœ€è¦å‘ LDAP ä¸­å¯¼å…¥ä¸€äº›åŸºæœ¬çš„ Schemaã€‚è¿™äº› Schema æ–‡ä»¶ä½äº `/etc/openldap/schema/` ç›®å½•ä¸­ï¼Œschema æ§åˆ¶ç€æ¡ç›®æ‹¥æœ‰å“ªäº›å¯¹è±¡ç±»å’Œå±æ€§ï¼Œå¯ä»¥è‡ªè¡Œé€‰æ‹©éœ€è¦çš„è¿›è¡Œå¯¼å…¥ï¼Œ

ä¾æ¬¡æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œå¯¼å…¥åŸºç¡€çš„ä¸€äº›é…ç½®,æˆ‘è¿™é‡Œå°†æ‰€æœ‰çš„éƒ½å¯¼å…¥ä¸€ä¸‹ï¼Œå…¶ä¸­ core.ldif æ˜¯é»˜è®¤å·²ç»åŠ è½½äº†çš„ï¼Œä¸ç”¨å¯¼å…¥
```bash
ldapadd -Y EXTERNAL -H ldapi:/// -f /etc/openldap/schema/cosine.ldif
ldapadd -Y EXTERNAL -H ldapi:/// -f /etc/openldap/schema/nis.ldif
ldapadd -Y EXTERNAL -H ldapi:/// -f /etc/openldap/schema/inetorgperson.ldif
ldapadd -Y EXTERNAL -H ldapi:/// -f /etc/openldap/schema/collective.ldif
ldapadd -Y EXTERNAL -H ldapi:/// -f /etc/openldap/schema/corba.ldif
ldapadd -Y EXTERNAL -H ldapi:/// -f /etc/openldap/schema/duaconf.ldif
ldapadd -Y EXTERNAL -H ldapi:/// -f /etc/openldap/schema/dyngroup.ldif
ldapadd -Y EXTERNAL -H ldapi:/// -f /etc/openldap/schema/java.ldif
ldapadd -Y EXTERNAL -H ldapi:/// -f /etc/openldap/schema/misc.ldif
ldapadd -Y EXTERNAL -H ldapi:/// -f /etc/openldap/schema/openldap.ldif
ldapadd -Y EXTERNAL -H ldapi:/// -f /etc/openldap/schema/pmi.ldif
ldapadd -Y EXTERNAL -H ldapi:/// -f /etc/openldap/schema/ppolicy.ldif
```

ä¿®æ”¹åŸŸåï¼Œæ–°å¢ changedomain.ldif, è¿™é‡Œæˆ‘è‡ªå®šä¹‰çš„åŸŸåä¸º fox.comï¼Œç®¡ç†å‘˜ç”¨æˆ·è´¦å·ä¸º adminã€‚

å¦‚æœè¦ä¿®æ”¹ï¼Œåˆ™ä¿®æ”¹æ–‡ä»¶ä¸­ç›¸åº”çš„ dc=fox,dc=com ä¸ºè‡ªå·±çš„åŸŸå
```bash
vim changedomain.ldif

dn: olcDatabase={1}monitor,cn=config
changetype: modify
replace: olcAccess
olcAccess: {0}to * by dn.base="gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth" read by dn.base="cn=admin,dc=fox,dc=com" read by * none

dn: olcDatabase={2}hdb,cn=config
changetype: modify
replace: olcSuffix
olcSuffix: dc=fox,dc=com

dn: olcDatabase={2}hdb,cn=config
changetype: modify
replace: olcRootDN
olcRootDN: cn=admin,dc=fox,dc=com

dn: olcDatabase={2}hdb,cn=config
changetype: modify
replace: olcRootPW
olcRootPW: {SSHA}qG8fxSKCrgt0KiN8cwQMzvymgQLJeh/k

dn: olcDatabase={2}hdb,cn=config
changetype: modify
add: olcAccess
olcAccess: {0}to attrs=userPassword,shadowLastChange by dn="cn=admin,dc=fox,dc=com" write by anonymous auth by self write by * none
olcAccess: {1}to dn.base="" by * read
olcAccess: {2}to * by dn="cn=admin,dc=fox,dc=com" write by * read
```

æ‰§è¡Œå‘½ä»¤ï¼Œä¿®æ”¹é…ç½®
```bash
ldapmodify -Y EXTERNAL -H ldapi:/// -f changedomain.ldif
```

ç„¶åï¼Œå¯ç”¨ memberof åŠŸèƒ½,æ–°å¢ add-memberof.ldif, å¼€å¯ memberof æ”¯æŒå¹¶æ–°å¢ç”¨æˆ·æ”¯æŒ memberof é…ç½®
```bash
vim add-memberof.ldif

dn: cn=module{0},cn=config
cn: modulle{0}
objectClass: olcModuleList
objectclass: top
olcModuleload: memberof.la
olcModulePath: /usr/lib64/openldap

dn: olcOverlay={0}memberof,olcDatabase={2}hdb,cn=config
objectClass: olcConfig
objectClass: olcMemberOf
objectClass: olcOverlayConfig
objectClass: top
olcOverlay: memberof
olcMemberOfDangling: ignore
olcMemberOfRefInt: TRUE
olcMemberOfGroupOC: groupOfUniqueNames
olcMemberOfMemberAD: uniqueMember
olcMemberOfMemberOfAD: memberOf
```

æ–°å¢ refint1.ldif æ–‡ä»¶
```bash
vim refint1.ldif

dn: cn=module{0},cn=config
add: olcmoduleload
olcmoduleload: refint
```

æ–°å¢refint2.ldifæ–‡ä»¶
```bash
vim refint2.ldif

dn: olcOverlay=refint,olcDatabase={2}hdb,cn=config
objectClass: olcConfig
objectClass: olcOverlayConfig
objectClass: olcRefintConfig
objectClass: top
olcOverlay: refint
olcRefintAttribute: memberof uniqueMember  manager owner
```

ä¾æ¬¡æ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼ŒåŠ è½½é…ç½®ï¼Œé¡ºåºä¸èƒ½é”™
```bash
ldapadd -Q -Y EXTERNAL -H ldapi:/// -f add-memberof.ldif
ldapmodify -Q -Y EXTERNAL -H ldapi:/// -f refint1.ldif
ldapadd -Q -Y EXTERNAL -H ldapi:/// -f refint2.ldif
```

åˆ°æ­¤ï¼Œé…ç½®ä¿®æ”¹å®Œäº†ï¼Œåœ¨ä¸Šè¿°åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ªå«åš fox company çš„ç»„ç»‡ï¼Œå¹¶åœ¨å…¶ä¸‹åˆ›å»ºä¸€ä¸ª admin çš„ç»„ç»‡è§’è‰²ï¼ˆè¯¥ç»„ç»‡è§’è‰²å†…çš„ç”¨æˆ·å…·æœ‰ç®¡ç†æ•´ä¸ª LDAP çš„æƒé™ï¼‰å’Œ People å’Œ Group ä¸¤ä¸ªç»„ç»‡å•å…ƒ,æ–°å¢é…ç½®æ–‡ä»¶
```bash
vim base.ldif

dn: dc=fox,dc=com
objectClass: top
objectClass: dcObject
objectClass: organization
o: Fox Company
dc: fox

dn: cn=admin,dc=fox,dc=com
objectClass: organizationalRole
cn: admin

dn: ou=People,dc=fox,dc=com
objectClass: organizationalUnit
ou: People

dn: ou=Group,dc=fox,dc=com
objectClass: organizationalRole
cn: Group
```

æ‰§è¡Œå‘½ä»¤ï¼Œæ·»åŠ é…ç½®, è¿™é‡Œè¦æ³¨æ„ä¿®æ”¹åŸŸåä¸ºè‡ªå·±é…ç½®çš„åŸŸåï¼Œç„¶åéœ€è¦è¾“å…¥ä¸Šé¢æˆ‘ä»¬ç”Ÿæˆçš„å¯†ç 
```bash
ldapadd -x -D cn=admin,dc=fox,dc=com -W -f base.ldif

# è¿™é‡Œæ˜¯ 123456
```

é€šè¿‡ä»¥ä¸Šçš„æ‰€æœ‰æ­¥éª¤ï¼Œæˆ‘ä»¬å°±è®¾ç½®å¥½äº†ä¸€ä¸ª LDAP ç›®å½•æ ‘ï¼šå…¶ä¸­åŸºå‡† dc=fox,dc=com æ˜¯è¯¥æ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œå…¶ä¸‹æœ‰ä¸€ä¸ªç®¡ç†åŸŸ cn=admin,dc=fox,dc=com å’Œä¸¤ä¸ªç»„ç»‡å•å…ƒ ou=People,dc=fox,dc=com åŠ ou=Group,dc=fox,dc=comã€‚

**æµ‹è¯•è¿æ¥**

è¿™é‡Œå…ˆå…³ä¸€ä¸‹é˜²ç«å¢™
```
service firewalld stop
```

è¿æ¥å·¥å…·ä½¿ç”¨ LdapAdmin

![](../../../assets/img/è¿ç»´/Linux/Power/2.png)

### PhpLdapAdmin

<p align="center">
    <img src="../../../assets/img/logo/PhpLdapAdmin.png" width="25%">
</p>

ä»¥ä¸‹éƒ¨åˆ†å†…å®¹æ¥è‡ª <sup>[[LDAPå®‰è£…å’ŒåŸºæœ¬ç®¡ç†æ‰‹è®°](https://neversec.top/20180329/LDAPå®‰è£…å’ŒåŸºæœ¬ç®¡ç†æ‰‹è®°.html)]</sup> ä»…ä½œæ’ç‰ˆå¤„ç†å’Œéƒ¨åˆ†å†…å®¹å¤„ç†

```bash
yum -y install epel-release
yum -y install httpd
yum -y install phpldapadmin
```
```vim
vim /etc/httpd/conf.d/phpldapadmin.conf

Alias /phpldapadmin /usr/share/phpldapadmin/htdocs
Alias /ldapadmin /usr/share/phpldapadmin/htdocs

<Directory /usr/share/phpldapadmin/htdocs>
  <IfModule mod_authz_core.c>
    # Apache 2.4
    Require all granted
    Allow from all
  </IfModule>
  <IfModule !mod_authz_core.c>
    # Apache 2.2
    Order Deny,Allow
    Allow from all
  </IfModule>
</Directory>
```
```vim
vim /etc/phpldapadmin/config.php
# å»æ‰æ³¨é‡Š å¹¶æ³¨é‡ŠåŸæ¥çš„é…ç½®
$servers->setValue('login','attr','dn');
//$servers->setValue('login','attr','uid');
```
```bash
#é‡å¯æœåŠ¡
systemctl restart httpd
```

è®¿é—® `http://ip/ldapadmin`ï¼Œç‚¹å‡»ç™»é™†ã€‚CN å¡«å†™åŸŸä¿¡æ¯`cn=admin,dc=fox,dc=com`ï¼Œå¯†ç å¡«å†™è‡ªå·±è®¾ç½®çš„å¯†ç ã€‚

---

## Snort

Snort æ­å»ºä¸ä½¿ç”¨å†…å®¹è®¿é—® [å®‰é˜²è®¾æ–½æ­å»ºä½¿ç”¨](../../å®‰å…¨/å®éªŒ/BlueTeam/å®‰é˜²è®¾æ–½æ­å»ºä½¿ç”¨.md#snort) Snort éƒ¨åˆ†

---

## Suricata

Suricata æ­å»ºä¸ä½¿ç”¨å†…å®¹è®¿é—® [å®‰é˜²è®¾æ–½æ­å»ºä½¿ç”¨](../../å®‰å…¨/å®éªŒ/BlueTeam/å®‰é˜²è®¾æ–½æ­å»ºä½¿ç”¨.md#suricata) Suricata éƒ¨åˆ†

---

# å„ç§ä¾èµ–

**libboost-program-options1.58.0**
```bash
echo "deb http://cz.archive.ubuntu.com/ubuntu xenial main" >> /etc/apt/sources.list
apt update && apt install -y libboost-program-options1.58.0
```

**libsodium18**
```bash
wget https://download.opensuse.org/repositories/home:/nsec/xUbuntu_16.04/amd64/libsodium18_1.0.11-1_amd64.deb
dpkg -i libsodium18_1.0.11-1_amd64.deb
```

**ERROR: pkg-config binary 'pkg-config' not found**
```bash
apt-get install pkg-config
```

---

## LuaJIT

> LuaJIT æ˜¯é‡‡ç”¨ C è¯­è¨€å†™çš„ Lua ä»£ç çš„è§£é‡Šå™¨ï¼ŒLuaJIT è¯•å›¾ä¿ç•™ Lua çš„ç²¾é«“--è½»é‡çº§,é«˜æ•ˆå’Œå¯æ‰©å±•ã€‚

**å®˜ç½‘åœ°å€**
- https://luajit.org/

**å®‰è£…**
```bash
wget https://luajit.org/download/LuaJIT-2.0.5.tar.gz
tar -zxf LuaJIT-2.0.5.tar.gz
cd LuaJIT-2.0.5/
sudo make && make install
```
