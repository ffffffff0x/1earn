# Secure-LinuxğŸ‘¨ğŸ»â€ğŸ’»
`linuxå®‰å…¨åŠ å›º+åº”æ€¥å“åº”çš„tips`
[TOC]

## shell
### ä¼šè¯
```bash
who  #æŸ¥çœ‹å½“å‰ç™»å½•ç”¨æˆ·
w    #æŸ¥çœ‹ç™»å½•ç”¨æˆ·è¡Œä¸º
last #æŸ¥çœ‹ç™»é™†ç”¨æˆ·å†å²
pkill -u linfengfeiye #ç›´æ¥å‰”é™¤ç”¨æˆ·

ps -ef| grep pts/0  #å¾—åˆ°ç”¨æˆ·ç™»å½•ç›¸åº”çš„è¿›ç¨‹å·pidåæ‰§è¡Œ
kill -9 pid #å®‰å…¨å‰”é™¤ç”¨æˆ·
```

## ç³»ç»Ÿç®¡ç†
### è¿›ç¨‹
```bash
ulimit -u 20 #ä¸´æ—¶æ€§å…è®¸ç”¨æˆ·æœ€å¤šåˆ›å»º 20 ä¸ªè¿›ç¨‹,é¢„é˜²ç±»ä¼¼forkç‚¸å¼¹
vim /etc/security/limits.conf
    user1 - nproc 20       #é€€å‡ºåé‡æ–°ç™»å½•ï¼Œå°±ä¼šå‘ç°æœ€å¤§è¿›ç¨‹æ•°å·²ç»æ›´æ”¹ä¸º 20 äº†
```

---

## net
### ç«¯å£ğŸ•µğŸ»â€
```bash
lsof -i:22  #æŸ¥22ç«¯å£

ss -tnlp
ss -tnlp | grep ssh
ss -tnlp | grep ":22"

etstat -tnlp
netstat -tnlp | grep ssh

nmap -sV -p 22 localhost
```

### FirewallğŸ‘®ğŸ»â€
```bash
firewall-cmd --permanent --zone=public --remove-service=ssh
firewall-cmd --permanent --zone=public --add-service=http
firewall-cmd --permanent --zone=internal --add-source=1.1.1.1
firewall-cmd --reload
firewall-cmd --list-services  #æŸ¥çœ‹é˜²ç«å¢™è®¾ç½®
```

åœ¨ä¸Šé¢çš„é…ç½®ä¸­ï¼Œå¦‚æœæœ‰äººå°è¯•ä» 1.1.1.1 å» sshï¼Œè¿™ä¸ªè¯·æ±‚å°†ä¼šæˆåŠŸï¼Œå› ä¸ºè¿™ä¸ªæºåŒºåŸŸï¼ˆinternalï¼‰è¢«é¦–å…ˆåº”ç”¨ï¼Œå¹¶ä¸”å®ƒå…è®¸ ssh è®¿é—®ã€‚

å¦‚æœæœ‰äººå°è¯•ä»å…¶å®ƒçš„åœ°å€ï¼Œå¦‚ 2.2.2.2ï¼Œå»è®¿é—® sshï¼Œå®ƒä¸æ˜¯è¿™ä¸ªæºåŒºåŸŸçš„ï¼Œå› ä¸ºå’Œè¿™ä¸ªæºåŒºåŸŸä¸åŒ¹é…ã€‚å› æ­¤ï¼Œè¿™ä¸ªè¯·æ±‚è¢«ç›´æ¥è½¬åˆ°æ¥å£åŒºåŸŸï¼ˆpublicï¼‰ï¼Œå®ƒæ²¡æœ‰æ˜¾å¼å¤„ç† sshï¼Œå› ä¸ºï¼Œpublic çš„ç›®æ ‡æ˜¯ defaultï¼Œè¿™ä¸ªè¯·æ±‚è¢«ä¼ é€’åˆ°é»˜è®¤åŠ¨ä½œï¼Œå®ƒå°†è¢«æ‹’ç»ã€‚

å¦‚æœ 1.1.1.1 å°è¯•è¿›è¡Œ http è®¿é—®ä¼šæ€æ ·ï¼ŸæºåŒºåŸŸï¼ˆinternalï¼‰ä¸å…è®¸å®ƒï¼Œä½†æ˜¯ï¼Œç›®æ ‡æ˜¯ defaultï¼Œå› æ­¤ï¼Œè¯·æ±‚å°†ä¼ é€’åˆ°æ¥å£åŒºåŸŸï¼ˆpublicï¼‰ï¼Œå®ƒè¢«å…è®¸è®¿é—®ã€‚

ç°åœ¨ï¼Œè®©æˆ‘ä»¬å‡è®¾æœ‰äººä» 3.3.3.3 æ‹–ä½ çš„ç½‘ç«™ã€‚è¦é™åˆ¶ä»é‚£ä¸ª IP çš„è®¿é—®ï¼Œç®€å•åœ°å¢åŠ å®ƒåˆ°é¢„å®šä¹‰çš„ drop åŒºåŸŸï¼Œæ­£å¦‚å…¶åï¼Œå®ƒå°†ä¸¢å¼ƒæ‰€æœ‰çš„è¿æ¥ï¼š
```bash
firewall-cmd --permanent --zone=drop --add-source=3.3.3.3
firewall-cmd --reload
```
ä¸‹ä¸€æ¬¡ 3.3.3.3 å°è¯•å»è®¿é—®ä½ çš„ç½‘ç«™ï¼Œfirewalld å°†è½¬å‘è¯·æ±‚åˆ°æºåŒºåŸŸï¼ˆdropï¼‰ã€‚å› ä¸ºç›®æ ‡æ˜¯ DROPï¼Œè¯·æ±‚å°†è¢«æ‹’ç»ï¼Œå¹¶ä¸”å®ƒä¸ä¼šè¢«è½¬å‘åˆ°æ¥å£åŒºåŸŸï¼ˆpublicï¼‰ã€‚


